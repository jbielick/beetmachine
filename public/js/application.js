!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var paper=new function(undefined){var Base=new function(){function inject(dest,src,enumerable,beans,preserve){function field(name,val){val=val||(val=describe(src,name))&&(val.get?val:val.value),"string"==typeof val&&"#"===val[0]&&(val=dest[val.substring(1)]||val);var bean,isFunc="function"==typeof val,res=val,prev=preserve||isFunc?val&&val.get?name in dest:dest[name]:null;preserve&&prev||(isFunc&&prev&&(val.base=prev),isFunc&&beans!==!1&&(bean=name.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(beansNames[bean[3].toLowerCase()+bean[4]]=bean[2]),res&&!isFunc&&res.get&&"function"==typeof res.get&&Base.isPlainObject(res)||(res={value:res,writable:!0}),(describe(dest,name)||{configurable:!0}).configurable&&(res.configurable=!0,res.enumerable=enumerable),define(dest,name,res))}var beansNames={};if(src){for(var name in src)src.hasOwnProperty(name)&&!hidden.test(name)&&field(name);for(var name in beansNames){var part=beansNames[name],set=dest["set"+part],get=dest["get"+part]||set&&dest["is"+part];!get||beans!==!0&&0!==get.length||field(name,{get:get,set:set})}}return dest}function each(obj,iter,bind){return obj&&("length"in obj&&!obj.getLength&&"number"==typeof obj.length?forEach:forIn).call(obj,iter,bind=bind||obj),bind}function set(obj,props){for(var i in props)props.hasOwnProperty(i)&&(obj[i]=props[i]);return obj}var hidden=/^(statics|enumerable|beans|preserve)$/,forEach=[].forEach||function(iter,bind){for(var i=0,l=this.length;l>i;i++)iter.call(bind,this[i],i,this)},forIn=function(iter,bind){for(var i in this)this.hasOwnProperty(i)&&iter.call(bind,this[i],i,this)},create=Object.create||function(proto){return{__proto__:proto}},describe=Object.getOwnPropertyDescriptor||function(obj,name){var get=obj.__lookupGetter__&&obj.__lookupGetter__(name);return get?{get:get,set:obj.__lookupSetter__(name),enumerable:!0,configurable:!0}:obj.hasOwnProperty(name)?{value:obj[name],enumerable:!0,configurable:!0,writable:!0}:null},_define=Object.defineProperty||function(obj,name,desc){return(desc.get||desc.set)&&obj.__defineGetter__?(desc.get&&obj.__defineGetter__(name,desc.get),desc.set&&obj.__defineSetter__(name,desc.set)):obj[name]=desc.value,obj},define=function(obj,name,desc){return delete obj[name],_define(obj,name,desc)};return inject(function(){for(var i=0,l=arguments.length;l>i;i++)set(this,arguments[i])},{inject:function(src){if(src){var statics=src.statics===!0?src:src.statics,beans=src.beans,preserve=src.preserve;statics!==src&&inject(this.prototype,src,src.enumerable,beans,preserve),inject(this,statics,!0,beans,preserve)}for(var i=1,l=arguments.length;l>i;i++)this.inject(arguments[i]);return this},extend:function(){for(var ctor,base=this,i=0,l=arguments.length;l>i&&!(ctor=arguments[i].initialize);i++);return ctor=ctor||function(){base.apply(this,arguments)},ctor.prototype=create(this.prototype),ctor.base=base,define(ctor.prototype,"constructor",{value:ctor,writable:!0,configurable:!0}),inject(ctor,this,!0),arguments.length?this.inject.apply(ctor,arguments):ctor}},!0).inject({inject:function(){for(var i=0,l=arguments.length;l>i;i++){var src=arguments[i];src&&inject(this,src,src.enumerable,src.beans,src.preserve)}return this},extend:function(){var res=create(this);return res.inject.apply(res,arguments)},each:function(iter,bind){return each(this,iter,bind)},clone:function(){return new this.constructor(this)},statics:{each:each,create:create,define:define,describe:describe,set:set,clone:function(obj){return set(new obj.constructor,obj)},isPlainObject:function(obj){var ctor=null!=obj&&obj.constructor;return ctor&&(ctor===Object||ctor===Base||"Object"===ctor.name)},pick:function(){for(var i=0,l=arguments.length;l>i;i++)if(arguments[i]!==undefined)return arguments[i]}}})};"undefined"!=typeof module&&(module.exports=Base),Array.isArray||(Array.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)}),document.head||(document.head=document.getElementsByTagName("head")[0]),Base.inject({toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+Base.each(this,function(value,key){if(!/^_/.test(key)){var type=typeof value;this.push(key+": "+("number"===type?Formatter.instance.number(value):"string"===type?"'"+value+"'":value))}},[]).join(", ")+" }"},exportJSON:function(options){return Base.exportJSON(this,options)},toJSON:function(){return Base.serialize(this)},_set:function(props,exclude){if(props&&Base.isPlainObject(props)){var orig=props._filtering||props;for(var key in orig)if(key in this&&orig.hasOwnProperty(key)&&(!exclude||!exclude[key])){var value=props[key];value!==undefined&&(this[key]=value)}return!0}},statics:{exports:{enumerable:!0},extend:function extend(){var res=extend.base.apply(this,arguments),name=res.prototype._class;return name&&!Base.exports[name]&&(Base.exports[name]=res),res},equals:function(obj1,obj2){function checkKeys(o1,o2){for(var i in o1)if(o1.hasOwnProperty(i)&&!o2.hasOwnProperty(i))return!1;return!0}if(obj1===obj2)return!0;if(obj1&&obj1.equals)return obj1.equals(obj2);if(obj2&&obj2.equals)return obj2.equals(obj1);if(Array.isArray(obj1)&&Array.isArray(obj2)){if(obj1.length!==obj2.length)return!1;for(var i=0,l=obj1.length;l>i;i++)if(!Base.equals(obj1[i],obj2[i]))return!1;return!0}if(obj1&&"object"==typeof obj1&&obj2&&"object"==typeof obj2){if(!checkKeys(obj1,obj2)||!checkKeys(obj2,obj1))return!1;for(var i in obj1)if(obj1.hasOwnProperty(i)&&!Base.equals(obj1[i],obj2[i]))return!1;return!0}return!1},read:function(list,start,options,length){if(this===Base){var value=this.peek(list,start);return list.__index++,value}var proto=this.prototype,readIndex=proto._readIndex,index=start||readIndex&&list.__index||0;length||(length=list.length-index);var obj=list[index];return obj instanceof this||options&&options.readNull&&null==obj&&1>=length?(readIndex&&(list.__index=index+1),obj&&options&&options.clone?obj.clone():obj):(obj=Base.create(this.prototype),readIndex&&(obj.__read=!0),obj=obj.initialize.apply(obj,index>0||length<list.length?Array.prototype.slice.call(list,index,index+length):list)||obj,readIndex&&(list.__index=index+obj.__read,obj.__read=undefined),obj)},peek:function(list,start){return list[list.__index=start||list.__index||0]},remain:function(list){return list.length-(list.__index||0)},readAll:function(list,start,options){for(var entry,res=[],i=start||0,l=list.length;l>i;i++)res.push(Array.isArray(entry=list[i])?this.read(entry,0,options):this.read(list,i,options,1));return res},readNamed:function(list,name,start,options,length){var value=this.getNamed(list,name),hasObject=value!==undefined;if(hasObject){var filtered=list._filtered;filtered||(filtered=list._filtered=Base.create(list[0]),filtered._filtering=list[0]),filtered[name]=undefined}return this.read(hasObject?[value]:list,start,options,length)},getNamed:function(list,name){var arg=list[0];return list._hasObject===undefined&&(list._hasObject=1===list.length&&Base.isPlainObject(arg)),list._hasObject?name?arg[name]:list._filtered||arg:void 0},hasNamed:function(list,name){return!!this.getNamed(list,name)},isPlainValue:function(obj){return this.isPlainObject(obj)||Array.isArray(obj)},serialize:function(obj,options,compact,dictionary){options=options||{};var res,root=!dictionary;if(root&&(options.formatter=new Formatter(options.precision),dictionary={length:0,definitions:{},references:{},add:function(item,create){var id="#"+item._id,ref=this.references[id];if(!ref){this.length++;var res=create.call(item),name=item._class;name&&res[0]!==name&&res.unshift(name),this.definitions[id]=res,ref=this.references[id]=[id]}return ref}}),obj&&obj._serialize){res=obj._serialize(options,dictionary);var name=obj._class;!name||compact||res._compact||res[0]===name||res.unshift(name)}else if(Array.isArray(obj)){res=[];for(var i=0,l=obj.length;l>i;i++)res[i]=Base.serialize(obj[i],options,compact,dictionary);compact&&(res._compact=!0)}else if(Base.isPlainObject(obj)){res={};for(var i in obj)obj.hasOwnProperty(i)&&(res[i]=Base.serialize(obj[i],options,compact,dictionary))}else res="number"==typeof obj?options.formatter.number(obj,options.precision):obj;return root&&dictionary.length>0?[["dictionary",dictionary.definitions],res]:res},deserialize:function(json,create,_data){var res=json,isRoot=!_data;if(_data=_data||{},Array.isArray(json)){var type=json[0],isDictionary="dictionary"===type;if(!isDictionary){if(_data.dictionary&&1==json.length&&/^#/.test(type))return _data.dictionary[type];type=Base.exports[type]}res=[];for(var i=type?1:0,l=json.length;l>i;i++)res.push(Base.deserialize(json[i],create,_data));if(isDictionary)_data.dictionary=res[0];else if(type){var args=res;create?res=create(type,args,isRoot):(res=Base.create(type.prototype),type.apply(res,args))}}else if(Base.isPlainObject(json)){res={};for(var key in json)res[key]=Base.deserialize(json[key],create,_data)}return res},exportJSON:function(obj,options){var json=Base.serialize(obj,options);return options&&options.asString===!1?json:JSON.stringify(json)},importJSON:function(json,target){return Base.deserialize("string"==typeof json?JSON.parse(json):json,function(type,args,isRoot){var obj=target&&target.constructor===type?target:Base.create(type.prototype),isTarget=obj===target;if(!isRoot&&1===args.length&&obj instanceof Item&&(!(obj instanceof Layer)||isTarget)){var arg=args[0];Base.isPlainObject(arg)&&(arg.insert=!1)}return type.apply(obj,args),isTarget&&(target=null),obj})},splice:function(list,items,index,remove){var amount=items&&items.length,append=index===undefined;index=append?list.length:index,index>list.length&&(index=list.length);for(var i=0;amount>i;i++)items[i]._index=index+i;if(append)return list.push.apply(list,items),[];var args=[index,remove];items&&args.push.apply(args,items);for(var removed=list.splice.apply(list,args),i=0,l=removed.length;l>i;i++)removed[i]._index=undefined;for(var i=index+amount,l=list.length;l>i;i++)list[i]._index=i;return removed},capitalize:function(str){return str.replace(/\b[a-z]/g,function(match){return match.toUpperCase()})},camelize:function(str){return str.replace(/-(.)/g,function(all,chr){return chr.toUpperCase()})},hyphenate:function(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Callback={attach:function(type,func){if("string"!=typeof type)return void Base.each(type,function(value,key){this.attach(key,value)},this);var entry=this._eventTypes[type];if(entry){var handlers=this._handlers=this._handlers||{};handlers=handlers[type]=handlers[type]||[],-1==handlers.indexOf(func)&&(handlers.push(func),entry.install&&1==handlers.length&&entry.install.call(this,type))}},detach:function(type,func){if("string"!=typeof type)return void Base.each(type,function(value,key){this.detach(key,value)},this);var index,entry=this._eventTypes[type],handlers=this._handlers&&this._handlers[type];entry&&handlers&&(!func||-1!=(index=handlers.indexOf(func))&&1==handlers.length?(entry.uninstall&&entry.uninstall.call(this,type),delete this._handlers[type]):-1!=index&&handlers.splice(index,1))},once:function(type,func){this.attach(type,function(){func.apply(this,arguments),this.detach(type,func)})},fire:function(type,event){var handlers=this._handlers&&this._handlers[type];if(!handlers)return!1;for(var args=[].slice.call(arguments,1),that=this,i=0,l=handlers.length;l>i;i++)if(handlers[i].apply(that,args)===!1&&event&&event.stop){event.stop();break}return!0},responds:function(type){return!(!this._handlers||!this._handlers[type])},on:"#attach",off:"#detach",trigger:"#fire",_installEvents:function(install){var handlers=this._handlers,key=install?"install":"uninstall";for(var type in handlers)if(handlers[type].length>0){var entry=this._eventTypes[type],func=entry[key];func&&func.call(this,type)}},statics:{inject:function inject(){for(var i=0,l=arguments.length;l>i;i++){var src=arguments[i],events=src._events;if(events){var types={};Base.each(events,function(entry,key){var isString="string"==typeof entry,name=isString?entry:key,part=Base.capitalize(name),type=name.substring(2).toLowerCase();types[type]=isString?{}:entry,name="_"+name,src["get"+part]=function(){return this[name]},src["set"+part]=function(func){var prev=this[name];prev&&this.detach(type,prev),func&&this.attach(type,func),this[name]=func}}),src._eventTypes=types}inject.base.call(this,src)}return this}}},PaperScope=Base.extend({_class:"PaperScope",initialize:function PaperScope(script){if(paper=this,this.settings={applyMatrix:!0,handleSize:4,hitTolerance:0},this.project=null,this.projects=[],this.tools=[],this.palettes=[],this._id=script&&(script.getAttribute("id")||script.src)||"paperscope-"+PaperScope._id++,script&&script.setAttribute("id",this._id),PaperScope._scopes[this._id]=this,!this.support){var ctx=CanvasProvider.getContext(1,1);PaperScope.prototype.support={nativeDash:"setLineDash"in ctx||"mozDash"in ctx,nativeBlendModes:BlendMode.nativeModes},CanvasProvider.release(ctx)}},version:"0.9.18",getView:function(){return this.project&&this.project.getView()},getPaper:function(){return this},execute:function(code){paper.PaperScript.execute(code,this),View.updateFocus()},install:function(scope){var that=this;Base.each(["project","view","tool"],function(key){Base.define(scope,key,{configurable:!0,get:function(){return that[key]}})});for(var key in this)!/^_/.test(key)&&this[key]&&(scope[key]=this[key])},setup:function(canvas){return paper=this,this.project=new Project(canvas),this},activate:function(){paper=this},clear:function(){for(var i=this.projects.length-1;i>=0;i--)this.projects[i].remove();for(var i=this.tools.length-1;i>=0;i--)this.tools[i].remove();for(var i=this.palettes.length-1;i>=0;i--)this.palettes[i].remove()},remove:function(){this.clear(),delete PaperScope._scopes[this._id]},statics:new function(){function handleAttribute(name){return name+="Attribute",function(el,attr){return el[name](attr)||el[name]("data-paper-"+attr)}}return{_scopes:{},_id:0,get:function(id){return id&&id.getAttribute&&(id=id.getAttribute("id")),this._scopes[id]||null},getAttribute:handleAttribute("get"),hasAttribute:handleAttribute("has")}}}),PaperScopeItem=Base.extend(Callback,{initialize:function(activate){this._scope=paper,this._index=this._scope[this._list].push(this)-1,(activate||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var prev=this._scope[this._reference];return prev&&prev!==this&&prev.fire("deactivate"),this._scope[this._reference]=this,this.fire("activate",prev),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null==this._index?!1:(Base.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)}}),Formatter=Base.extend({initialize:function(precision){this.precision=precision||5,this.multiplier=Math.pow(10,this.precision)},number:function(val){return Math.round(val*this.multiplier)/this.multiplier},point:function(val,separator){return this.number(val.x)+(separator||",")+this.number(val.y)},size:function(val,separator){return this.number(val.width)+(separator||",")+this.number(val.height)},rectangle:function(val,separator){return this.point(val,separator)+(separator||",")+this.size(val,separator)}});Formatter.instance=new Formatter;var Numerical=new function(){function setupRoots(roots,min,max){var unbound=min===undefined,minE=min-EPSILON,maxE=max+EPSILON,count=0;return function(root){return(unbound||root>minE&&maxE>root)&&(roots[count++]=min>root?min:root>max?max:root),count}}var abscissas=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],abs=Math.abs,sqrt=Math.sqrt,pow=Math.pow,cos=Math.cos,PI=Math.PI,TOLERANCE=1e-5,EPSILON=1e-11;return{TOLERANCE:TOLERANCE,EPSILON:EPSILON,KAPPA:4*(sqrt(2)-1)/3,isZero:function(val){return abs(val)<=EPSILON},integrate:function(f,a,b,n){for(var x=abscissas[n-2],w=weights[n-2],A=.5*(b-a),B=A+a,i=0,m=n+1>>1,sum=1&n?w[i++]*f(B):0;m>i;){var Ax=A*x[i];sum+=w[i++]*(f(B+Ax)+f(B-Ax))}return A*sum},findRoot:function(f,df,x,a,b,n,tolerance){for(var i=0;n>i;i++){var fx=f(x),dx=fx/df(x),nx=x-dx;if(abs(dx)<tolerance)return nx;fx>0?(b=x,x=a>=nx?.5*(a+b):nx):(a=x,x=nx>=b?.5*(a+b):nx)}return x},solveQuadratic:function(a,b,c,roots,min,max){var add=setupRoots(roots,min,max);if(abs(a)<EPSILON)return abs(b)>=EPSILON?add(-c/b):abs(c)<EPSILON?-1:0;var p=b/(2*a),q=c/a,p2=p*p;if(q-EPSILON>p2)return 0;var s=p2>q?sqrt(p2-q):0,count=add(s-p);return s>0&&(count=add(-s-p)),count},solveCubic:function(a,b,c,d,roots,min,max){if(abs(a)<EPSILON)return Numerical.solveQuadratic(b,c,d,roots,min,max);b/=a,c/=a,d/=a;var add=setupRoots(roots,min,max),bb=b*b,p=(bb-3*c)/9,q=(2*bb*b-9*b*c+27*d)/54,ppp=p*p*p,D=q*q-ppp;if(b/=3,abs(D)<EPSILON){if(abs(q)<EPSILON)return add(-b);var sqp=sqrt(p),snq=q>0?1:-1;return add(2*-snq*sqp-b),add(snq*sqp-b)}if(0>D){var sqp=sqrt(p),phi=Math.acos(q/(sqp*sqp*sqp))/3,t=-2*sqp,o=2*PI/3;return add(t*cos(phi)-b),add(t*cos(phi+o)-b),add(t*cos(phi-o)-b)}var A=(q>0?-1:1)*pow(abs(q)+sqrt(D),1/3);return add(A+p/A-b)}}},Point=Base.extend({_class:"Point",_readIndex:!0,initialize:function(arg0,arg1){var type=typeof arg0;if("number"===type){var hasY="number"==typeof arg1;this.x=arg0,this.y=hasY?arg1:arg0,this.__read&&(this.__read=hasY?2:1)}else"undefined"===type||null===arg0?(this.x=this.y=0,this.__read&&(this.__read=null===arg0?1:0)):(Array.isArray(arg0)?(this.x=arg0[0],this.y=arg0.length>1?arg0[1]:arg0[0]):null!=arg0.x?(this.x=arg0.x,this.y=arg0.y):null!=arg0.width?(this.x=arg0.width,this.y=arg0.height):null!=arg0.angle?(this.x=arg0.length,this.y=0,this.setAngle(arg0.angle)):(this.x=this.y=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(x,y){return this.x=x,this.y=y,this},equals:function(point){return this===point||point&&(this.x===point.x&&this.y===point.y||Array.isArray(point)&&this.x===point[0]&&this.y===point[1])||!1},clone:function(){return new Point(this.x,this.y)},toString:function(){var f=Formatter.instance;return"{ x: "+f.number(this.x)+", y: "+f.number(this.y)+" }"},_serialize:function(options){var f=options.formatter;return[f.number(this.x),f.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(length){if(this.isZero()){var angle=this._angle||0;this.set(Math.cos(angle)*length,Math.sin(angle)*length)}else{var scale=length/this.getLength();Numerical.isZero(scale)&&this.getAngle(),this.set(this.x*scale,this.y*scale)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(angle){this.setAngleInRadians.call(this,angle*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var point=Point.read(arguments),div=this.getLength()*point.getLength();return Numerical.isZero(div)?0/0:Math.acos(this.dot(point)/div)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(angle){if(this._angle=angle,!this.isZero()){var length=this.getLength();this.set(Math.cos(angle)*length,Math.sin(angle)*length)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var point=Point.read(arguments);return 180*Math.atan2(this.cross(point),this.dot(point))/Math.PI},getDistance:function(){var point=Point.read(arguments),x=point.x-this.x,y=point.y-this.y,d=x*x+y*y,squared=Base.read(arguments);return squared?d:Math.sqrt(d)},normalize:function(length){length===undefined&&(length=1);var current=this.getLength(),scale=0!==current?length/current:0,point=new Point(this.x*scale,this.y*scale);return scale>=0&&(point._angle=this._angle),point},rotate:function(angle,center){if(0===angle)return this.clone();angle=angle*Math.PI/180;var point=center?this.subtract(center):this,s=Math.sin(angle),c=Math.cos(angle);return point=new Point(point.x*c-point.y*s,point.x*s+point.y*c),center?point.add(center):point},transform:function(matrix){return matrix?matrix._transformPoint(this):this},add:function(){var point=Point.read(arguments);return new Point(this.x+point.x,this.y+point.y)},subtract:function(){var point=Point.read(arguments);return new Point(this.x-point.x,this.y-point.y)},multiply:function(){var point=Point.read(arguments);return new Point(this.x*point.x,this.y*point.y)},divide:function(){var point=Point.read(arguments);return new Point(this.x/point.x,this.y/point.y)},modulo:function(){var point=Point.read(arguments);return new Point(this.x%point.x,this.y%point.y)},negate:function(){return new Point(-this.x,-this.y)},isInside:function(rect){return rect.contains(this)},isClose:function(point,tolerance){return this.getDistance(point)<tolerance},isColinear:function(point){return Math.abs(this.cross(point))<1e-5},isOrthogonal:function(point){return Math.abs(this.dot(point))<1e-5},isZero:function(){return Numerical.isZero(this.x)&&Numerical.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(){var point=Point.read(arguments);return this.x*point.x+this.y*point.y},cross:function(){var point=Point.read(arguments);return this.x*point.y-this.y*point.x},project:function(){var point=Point.read(arguments);if(point.isZero())return new Point(0,0);var scale=this.dot(point)/point.dot(point);return new Point(point.x*scale,point.y*scale)},statics:{min:function(){var point1=Point.read(arguments),point2=Point.read(arguments);return new Point(Math.min(point1.x,point2.x),Math.min(point1.y,point2.y))},max:function(){var point1=Point.read(arguments),point2=Point.read(arguments);return new Point(Math.max(point1.x,point2.x),Math.max(point1.y,point2.y))},random:function(){return new Point(Math.random(),Math.random())}}},Base.each(["round","ceil","floor","abs"],function(name){var op=Math[name];this[name]=function(){return new Point(op(this.x),op(this.y))}},{})),LinkedPoint=Point.extend({initialize:function(x,y,owner,setter){this._x=x,this._y=y,this._owner=owner,this._setter=setter},set:function(x,y,_dontNotify){return this._x=x,this._y=y,_dontNotify||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(x){this._x=x,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(y){this._y=y,this._owner[this._setter](this)}}),Size=Base.extend({_class:"Size",_readIndex:!0,initialize:function(arg0,arg1){var type=typeof arg0;if("number"===type){var hasHeight="number"==typeof arg1;this.width=arg0,this.height=hasHeight?arg1:arg0,this.__read&&(this.__read=hasHeight?2:1)}else"undefined"===type||null===arg0?(this.width=this.height=0,this.__read&&(this.__read=null===arg0?1:0)):(Array.isArray(arg0)?(this.width=arg0[0],this.height=arg0.length>1?arg0[1]:arg0[0]):null!=arg0.width?(this.width=arg0.width,this.height=arg0.height):null!=arg0.x?(this.width=arg0.x,this.height=arg0.y):(this.width=this.height=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(width,height){return this.width=width,this.height=height,this},equals:function(size){return size===this||size&&(this.width===size.width&&this.height===size.height||Array.isArray(size)&&this.width===size[0]&&this.height===size[1])||!1},clone:function(){return new Size(this.width,this.height)},toString:function(){var f=Formatter.instance;return"{ width: "+f.number(this.width)+", height: "+f.number(this.height)+" }"},_serialize:function(options){var f=options.formatter;return[f.number(this.width),f.number(this.height)]},add:function(){var size=Size.read(arguments);return new Size(this.width+size.width,this.height+size.height)},subtract:function(){var size=Size.read(arguments);return new Size(this.width-size.width,this.height-size.height)},multiply:function(){var size=Size.read(arguments);return new Size(this.width*size.width,this.height*size.height)},divide:function(){var size=Size.read(arguments);return new Size(this.width/size.width,this.height/size.height)},modulo:function(){var size=Size.read(arguments);return new Size(this.width%size.width,this.height%size.height)},negate:function(){return new Size(-this.width,-this.height)},isZero:function(){return Numerical.isZero(this.width)&&Numerical.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(size1,size2){return new Size(Math.min(size1.width,size2.width),Math.min(size1.height,size2.height))},max:function(size1,size2){return new Size(Math.max(size1.width,size2.width),Math.max(size1.height,size2.height))},random:function(){return new Size(Math.random(),Math.random())}}},Base.each(["round","ceil","floor","abs"],function(name){var op=Math[name];this[name]=function(){return new Size(op(this.width),op(this.height))}},{})),LinkedSize=Size.extend({initialize:function(width,height,owner,setter){this._width=width,this._height=height,this._owner=owner,this._setter=setter},set:function(width,height,_dontNotify){return this._width=width,this._height=height,_dontNotify||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(width){this._width=width,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(height){this._height=height,this._owner[this._setter](this)}}),Rectangle=Base.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(arg0,arg1,arg2,arg3){var type=typeof arg0,read=0;if("number"===type?(this.x=arg0,this.y=arg1,this.width=arg2,this.height=arg3,read=4):"undefined"===type||null===arg0?(this.x=this.y=this.width=this.height=0,read=null===arg0?1:0):1===arguments.length&&(Array.isArray(arg0)?(this.x=arg0[0],this.y=arg0[1],this.width=arg0[2],this.height=arg0[3],read=1):arg0.x!==undefined||arg0.width!==undefined?(this.x=arg0.x||0,this.y=arg0.y||0,this.width=arg0.width||0,this.height=arg0.height||0,read=1):arg0.from===undefined&&arg0.to===undefined&&(this.x=this.y=this.width=this.height=0,this._set(arg0),read=1)),!read){var point=Point.readNamed(arguments,"from"),next=Base.peek(arguments);if(this.x=point.x,this.y=point.y,next&&next.x!==undefined||Base.hasNamed(arguments,"to")){var to=Point.readNamed(arguments,"to");this.width=to.x-point.x,this.height=to.y-point.y,this.width<0&&(this.x=to.x,this.width=-this.width),this.height<0&&(this.y=to.y,this.height=-this.height)}else{var size=Size.read(arguments);this.width=size.width,this.height=size.height}read=arguments.__index}this.__read&&(this.__read=read)},set:function(x,y,width,height){return this.x=x,this.y=y,this.width=width,this.height=height,this},clone:function(){return new Rectangle(this.x,this.y,this.width,this.height)},equals:function(rect){var rt=Base.isPlainValue(rect)?Rectangle.read(arguments):rect;return rt===this||rt&&this.x===rt.x&&this.y===rt.y&&this.width===rt.width&&this.height===rt.height||!1},toString:function(){var f=Formatter.instance;return"{ x: "+f.number(this.x)+", y: "+f.number(this.y)+", width: "+f.number(this.width)+", height: "+f.number(this.height)+" }"},_serialize:function(options){var f=options.formatter;return[f.number(this.x),f.number(this.y),f.number(this.width),f.number(this.height)]},getPoint:function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this.x,this.y,this,"setPoint")},setPoint:function(){var point=Point.read(arguments);this.x=point.x,this.y=point.y},getSize:function(_dontLink){var ctor=_dontLink?Size:LinkedSize;return new ctor(this.width,this.height,this,"setSize")},setSize:function(){var size=Size.read(arguments);this._fixX&&(this.x+=(this.width-size.width)*this._fixX),this._fixY&&(this.y+=(this.height-size.height)*this._fixY),this.width=size.width,this.height=size.height,this._fixW=1,this._fixH=1},getLeft:function(){return this.x},setLeft:function(left){this._fixW||(this.width-=left-this.x),this.x=left,this._fixX=0},getTop:function(){return this.y},setTop:function(top){this._fixH||(this.height-=top-this.y),this.y=top,this._fixY=0},getRight:function(){return this.x+this.width},setRight:function(right){this._fixX!==undefined&&1!==this._fixX&&(this._fixW=0),this._fixW?this.x=right-this.width:this.width=right-this.x,this._fixX=1},getBottom:function(){return this.y+this.height},setBottom:function(bottom){this._fixY!==undefined&&1!==this._fixY&&(this._fixH=0),this._fixH?this.y=bottom-this.height:this.height=bottom-this.y,this._fixY=1},getCenterX:function(){return this.x+.5*this.width},setCenterX:function(x){this.x=x-.5*this.width,this._fixX=.5},getCenterY:function(){return this.y+.5*this.height},setCenterY:function(y){this.y=y-.5*this.height,this._fixY=.5},getCenter:function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var point=Point.read(arguments);return this.setCenterX(point.x),this.setCenterY(point.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(arg){return arg&&arg.width!==undefined||4==(Array.isArray(arg)?arg:arguments).length?this._containsRectangle(Rectangle.read(arguments)):this._containsPoint(Point.read(arguments))},_containsPoint:function(point){var x=point.x,y=point.y;return x>=this.x&&y>=this.y&&x<=this.x+this.width&&y<=this.y+this.height
},_containsRectangle:function(rect){var x=rect.x,y=rect.y;return x>=this.x&&y>=this.y&&x+rect.width<=this.x+this.width&&y+rect.height<=this.y+this.height},intersects:function(){var rect=Rectangle.read(arguments);return rect.x+rect.width>this.x&&rect.y+rect.height>this.y&&rect.x<this.x+this.width&&rect.y<this.y+this.height},touches:function(){var rect=Rectangle.read(arguments);return rect.x+rect.width>=this.x&&rect.y+rect.height>=this.y&&rect.x<=this.x+this.width&&rect.y<=this.y+this.height},intersect:function(){var rect=Rectangle.read(arguments),x1=Math.max(this.x,rect.x),y1=Math.max(this.y,rect.y),x2=Math.min(this.x+this.width,rect.x+rect.width),y2=Math.min(this.y+this.height,rect.y+rect.height);return new Rectangle(x1,y1,x2-x1,y2-y1)},unite:function(){var rect=Rectangle.read(arguments),x1=Math.min(this.x,rect.x),y1=Math.min(this.y,rect.y),x2=Math.max(this.x+this.width,rect.x+rect.width),y2=Math.max(this.y+this.height,rect.y+rect.height);return new Rectangle(x1,y1,x2-x1,y2-y1)},include:function(){var point=Point.read(arguments),x1=Math.min(this.x,point.x),y1=Math.min(this.y,point.y),x2=Math.max(this.x+this.width,point.x),y2=Math.max(this.y+this.height,point.y);return new Rectangle(x1,y1,x2-x1,y2-y1)},expand:function(){var amount=Size.read(arguments),hor=amount.width,ver=amount.height;return new Rectangle(this.x-hor/2,this.y-ver/2,this.width+hor,this.height+ver)},scale:function(hor,ver){return this.expand(this.width*hor-this.width,this.height*(ver===undefined?hor:ver)-this.height)}},new function(){return Base.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(parts,index){var part=parts.join(""),xFirst=/^[RL]/.test(part);index>=4&&(parts[1]+=xFirst?"Y":"X");var x=parts[xFirst?0:1],y=parts[xFirst?1:0],getX="get"+x,getY="get"+y,setX="set"+x,setY="set"+y,get="get"+part,set="set"+part;this[get]=function(_dontLink){var ctor=_dontLink?Point:LinkedPoint;return new ctor(this[getX](),this[getY](),this,set)},this[set]=function(){var point=Point.read(arguments);this[setX](point.x),this[setY](point.y)}},{beans:!0})}),LinkedRectangle=Rectangle.extend({initialize:function(x,y,width,height,owner,setter){this.set(x,y,width,height,!0),this._owner=owner,this._setter=setter},set:function(x,y,width,height,_dontNotify){return this._x=x,this._y=y,this._width=width,this._height=height,_dontNotify||this._owner[this._setter](this),this}},new function(){var proto=Rectangle.prototype;return Base.each(["x","y","width","height"],function(key){var part=Base.capitalize(key),internal="_"+key;this["get"+part]=function(){return this[internal]},this["set"+part]=function(value){this[internal]=value,this._dontNotify||this._owner[this._setter](this)}},Base.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(key){var name="set"+key;this[name]=function(){this._dontNotify=!0,proto[name].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return this._owner._boundsSelected},setSelected:function(selected){var owner=this._owner;owner.setSelected&&(owner._boundsSelected=selected,owner.setSelected(selected||owner._selectedSegmentState>0))}}))}),Matrix=Base.extend({_class:"Matrix",initialize:function Matrix(arg){var count=arguments.length,ok=!0;if(6===count?this.set.apply(this,arguments):1===count?arg instanceof Matrix?this.set(arg._a,arg._c,arg._b,arg._d,arg._tx,arg._ty):Array.isArray(arg)?this.set.apply(this,arg):ok=!1:0===count?this.reset():ok=!1,!ok)throw new Error("Unsupported matrix parameters")},set:function(a,c,b,d,tx,ty,_dontNotify){return this._a=a,this._c=c,this._b=b,this._d=d,this._tx=tx,this._ty=ty,_dontNotify||this._changed(),this},_serialize:function(options){return Base.serialize(this.getValues(),options)},_changed:function(){var owner=this._owner;owner&&(owner._applyMatrix?owner.transform(null,!0):owner._changed(9))},clone:function(){return new Matrix(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(mx){return mx===this||mx&&this._a===mx._a&&this._b===mx._b&&this._c===mx._c&&this._d===mx._d&&this._tx===mx._tx&&this._ty===mx._ty||!1},toString:function(){var f=Formatter.instance;return"[["+[f.number(this._a),f.number(this._b),f.number(this._tx)].join(", ")+"], ["+[f.number(this._c),f.number(this._d),f.number(this._ty)].join(", ")+"]]"},reset:function(_dontNotify){return this._a=this._d=1,this._c=this._b=this._tx=this._ty=0,_dontNotify||this._changed(),this},apply:function(){var owner=this._owner;return owner?(owner.transform(null,!0),this.isIdentity()):!1},translate:function(){var point=Point.read(arguments),x=point.x,y=point.y;return this._tx+=x*this._a+y*this._b,this._ty+=x*this._c+y*this._d,this._changed(),this},scale:function(){var scale=Point.read(arguments),center=Point.read(arguments,0,{readNull:!0});return center&&this.translate(center),this._a*=scale.x,this._c*=scale.x,this._b*=scale.y,this._d*=scale.y,center&&this.translate(center.negate()),this._changed(),this},rotate:function(angle){angle*=Math.PI/180;var center=Point.read(arguments,1),x=center.x,y=center.y,cos=Math.cos(angle),sin=Math.sin(angle),tx=x-x*cos+y*sin,ty=y-x*sin-y*cos,a=this._a,b=this._b,c=this._c,d=this._d;return this._a=cos*a+sin*b,this._b=-sin*a+cos*b,this._c=cos*c+sin*d,this._d=-sin*c+cos*d,this._tx+=tx*a+ty*b,this._ty+=tx*c+ty*d,this._changed(),this},shear:function(){var shear=Point.read(arguments),center=Point.read(arguments,0,{readNull:!0});center&&this.translate(center);var a=this._a,c=this._c;return this._a+=shear.y*this._b,this._c+=shear.y*this._d,this._b+=shear.x*a,this._d+=shear.x*c,center&&this.translate(center.negate()),this._changed(),this},skew:function(){var skew=Point.read(arguments),center=Point.read(arguments,0,{readNull:!0}),toRadians=Math.PI/180,shear=new Point(Math.tan(skew.x*toRadians),Math.tan(skew.y*toRadians));return this.shear(shear,center)},concatenate:function(mx){var a=this._a,b=this._b,c=this._c,d=this._d;return this._a=mx._a*a+mx._c*b,this._b=mx._b*a+mx._d*b,this._c=mx._a*c+mx._c*d,this._d=mx._b*c+mx._d*d,this._tx+=mx._tx*a+mx._ty*b,this._ty+=mx._tx*c+mx._ty*d,this._changed(),this},preConcatenate:function(mx){var a=this._a,b=this._b,c=this._c,d=this._d,tx=this._tx,ty=this._ty;return this._a=mx._a*a+mx._b*c,this._b=mx._a*b+mx._b*d,this._c=mx._c*a+mx._d*c,this._d=mx._c*b+mx._d*d,this._tx=mx._a*tx+mx._b*ty+mx._tx,this._ty=mx._c*tx+mx._d*ty+mx._ty,this._changed(),this},isIdentity:function(){return 1===this._a&&0===this._c&&0===this._b&&1===this._d&&0===this._tx&&0===this._ty},orNullIfIdentity:function(){return this.isIdentity()?null:this},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},transform:function(src,srcOffset,dst,dstOffset,count){return arguments.length<5?this._transformPoint(Point.read(arguments)):this._transformCoordinates(src,srcOffset,dst,dstOffset,count)},_transformPoint:function(point,dest,_dontNotify){var x=point.x,y=point.y;return dest||(dest=new Point),dest.set(x*this._a+y*this._b+this._tx,x*this._c+y*this._d+this._ty,_dontNotify)},_transformCoordinates:function(src,srcOffset,dst,dstOffset,count){for(var i=srcOffset,j=dstOffset,max=i+2*count;max>i;){var x=src[i++],y=src[i++];dst[j++]=x*this._a+y*this._b+this._tx,dst[j++]=x*this._c+y*this._d+this._ty}return dst},_transformCorners:function(rect){var x1=rect.x,y1=rect.y,x2=x1+rect.width,y2=y1+rect.height,coords=[x1,y1,x2,y1,x2,y2,x1,y2];return this._transformCoordinates(coords,0,coords,0,4)},_transformBounds:function(bounds,dest,_dontNotify){for(var coords=this._transformCorners(bounds),min=coords.slice(0,2),max=coords.slice(),i=2;8>i;i++){var val=coords[i],j=1&i;val<min[j]?min[j]=val:val>max[j]&&(max[j]=val)}return dest||(dest=new Rectangle),dest.set(min[0],min[1],max[0]-min[0],max[1]-min[1],_dontNotify)},inverseTransform:function(){return this._inverseTransform(Point.read(arguments))},_getDeterminant:function(){var det=this._a*this._d-this._b*this._c;return isFinite(det)&&!Numerical.isZero(det)&&isFinite(this._tx)&&isFinite(this._ty)?det:null},_inverseTransform:function(point,dest,_dontNotify){var det=this._getDeterminant();if(!det)return null;var x=point.x-this._tx,y=point.y-this._ty;return dest||(dest=new Point),dest.set((x*this._d-y*this._b)/det,(y*this._a-x*this._c)/det,_dontNotify)},decompose:function(){var a=this._a,b=this._b,c=this._c,d=this._d;if(Numerical.isZero(a*d-b*c))return null;var scaleX=Math.sqrt(a*a+b*b);a/=scaleX,b/=scaleX;var shear=a*c+b*d;c-=a*shear,d-=b*shear;var scaleY=Math.sqrt(c*c+d*d);return c/=scaleY,d/=scaleY,shear/=scaleY,b*c>a*d&&(a=-a,b=-b,shear=-shear,scaleX=-scaleX),{scaling:new Point(scaleX,scaleY),rotation:180*-Math.atan2(b,a)/Math.PI,shearing:shear}},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return new Point(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var det=this._getDeterminant();return det&&new Matrix(this._d/det,-this._c/det,-this._b/det,this._a/det,(this._b*this._ty-this._d*this._tx)/det,(this._c*this._tx-this._a*this._ty)/det)},shiftless:function(){return new Matrix(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(ctx){ctx.transform(this._a,this._c,this._b,this._d,this._tx,this._ty)}},Base.each(["a","c","b","d","tx","ty"],function(name){var part=Base.capitalize(name),prop="_"+name;this["get"+part]=function(){return this[prop]},this["set"+part]=function(value){this[prop]=value,this._changed()}},{})),Line=Base.extend({_class:"Line",initialize:function(arg0,arg1,arg2,arg3,arg4){var asVector=!1;arguments.length>=4?(this._px=arg0,this._py=arg1,this._vx=arg2,this._vy=arg3,asVector=arg4):(this._px=arg0.x,this._py=arg0.y,this._vx=arg1.x,this._vy=arg1.y,asVector=arg2),asVector||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new Point(this._px,this._py)},getVector:function(){return new Point(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(line,isInfinite){return Line.intersect(this._px,this._py,this._vx,this._vy,line._px,line._py,line._vx,line._vy,!0,isInfinite)},getSide:function(point){return Line.getSide(this._px,this._py,this._vx,this._vy,point.x,point.y,!0)},getDistance:function(point){return Math.abs(Line.getSignedDistance(this._px,this._py,this._vx,this._vy,point.x,point.y,!0))},statics:{intersect:function(apx,apy,avx,avy,bpx,bpy,bvx,bvy,asVector,isInfinite){asVector||(avx-=apx,avy-=apy,bvx-=bpx,bvy-=bpy);var cross=bvy*avx-bvx*avy;if(!Numerical.isZero(cross)){var dx=apx-bpx,dy=apy-bpy,ta=(bvx*dy-bvy*dx)/cross,tb=(avx*dy-avy*dx)/cross;if((isInfinite||ta>=0&&1>=ta)&&(isInfinite||tb>=0&&1>=tb))return new Point(apx+ta*avx,apy+ta*avy)}},getSide:function(px,py,vx,vy,x,y,asVector){asVector||(vx-=px,vy-=py);var v2x=x-px,v2y=y-py,ccw=v2x*vy-v2y*vx;return 0===ccw&&(ccw=v2x*vx+v2y*vy,ccw>0&&(v2x-=vx,v2y-=vy,ccw=v2x*vx+v2y*vy,0>ccw&&(ccw=0))),0>ccw?-1:ccw>0?1:0},getSignedDistance:function(px,py,vx,vy,x,y,asVector){asVector||(vx-=px,vy-=py);var m=vy/vx,b=py-m*px;return(y-m*x-b)/Math.sqrt(m*m+1)}}}),Project=PaperScopeItem.extend({_class:"Project",_list:"projects",_reference:"project",initialize:function(element){PaperScopeItem.call(this,!0),this.layers=[],this.symbols=[],this._currentStyle=new Style(null,null,this),this.activeLayer=new Layer,this._view=View.create(this,element||CanvasProvider.getCanvas(1,1)),this._selectedItems={},this._selectedItemCount=0,this._updateVersion=0},_serialize:function(options,dictionary){return Base.serialize(this.layers,options,!0,dictionary)},clear:function(){for(var i=this.layers.length-1;i>=0;i--)this.layers[i].remove();this.symbols=[]},isEmpty:function(){return this.layers.length<=1&&(!this.activeLayer||this.activeLayer.isEmpty())},remove:function remove(){return remove.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(style){this._currentStyle.initialize(style)},getIndex:function(){return this._index},addChild:function(child){return child instanceof Layer?(Base.splice(this.layers,[child]),this.activeLayer||(this.activeLayer=child)):child instanceof Item?(this.activeLayer||this.addChild(new Layer(Item.NO_INSERT))).addChild(child):child=null,child},getSelectedItems:function(){var items=[];for(var id in this._selectedItems){var item=this._selectedItems[id];item.isInserted()&&items.push(item)}return items},getOptions:function(){return this._scope.settings},_updateSelection:function(item){var id=item._id,selectedItems=this._selectedItems;item._selected?selectedItems[id]!==item&&(this._selectedItemCount++,selectedItems[id]=item):selectedItems[id]===item&&(this._selectedItemCount--,delete selectedItems[id])},selectAll:function(){for(var layers=this.layers,i=0,l=layers.length;l>i;i++)layers[i].setFullySelected(!0)},deselectAll:function(){var selectedItems=this._selectedItems;for(var i in selectedItems)selectedItems[i].setFullySelected(!1)},hitTest:function(){for(var point=Point.read(arguments),options=HitResult.getOptions(Base.read(arguments)),i=this.layers.length-1;i>=0;i--){var res=this.layers[i].hitTest(point,options);if(res)return res}return null},getItems:function(match){return Item._getItems(this.layers,match,!0)},getItem:function(match){return Item._getItems(this.layers,match,!1)},importJSON:function(json){this.activate();var layer=this.activeLayer;return Base.importJSON(json,layer&&layer.isEmpty()&&layer)},draw:function(ctx,matrix,pixelRatio){this._updateVersion++,ctx.save(),matrix.applyToContext(ctx);for(var param=new Base({offset:new Point(0,0),pixelRatio:pixelRatio,trackTransforms:!0,transforms:[matrix]}),i=0,l=this.layers.length;l>i;i++)this.layers[i].draw(ctx,param);if(ctx.restore(),this._selectedItemCount>0){ctx.save(),ctx.strokeWidth=1;for(var id in this._selectedItems){var item=this._selectedItems[id],globalMatrix=item._globalMatrix,size=this._scope.settings.handleSize,half=size/2;if(item._updateVersion===this._updateVersion&&(item._drawSelected||item._boundsSelected)&&globalMatrix){var color=item.getSelectedColor()||item.getLayer().getSelectedColor();if(ctx.strokeStyle=ctx.fillStyle=color?color.toCanvasStyle(ctx):"#009dec",item._drawSelected&&item._drawSelected(ctx,globalMatrix),item._boundsSelected){var coords=globalMatrix._transformCorners(item.getInternalBounds());ctx.beginPath();for(var i=0;8>i;i++)ctx[0===i?"moveTo":"lineTo"](coords[i],coords[++i]);ctx.closePath(),ctx.stroke();for(var i=0;8>i;i++)ctx.fillRect(coords[i]-half,coords[++i]-half,size,size)}}}ctx.restore()}}}),Symbol=Base.extend({_class:"Symbol",initialize:function Symbol(item,dontCenter){this._id=Symbol._id=(Symbol._id||0)+1,this.project=paper.project,this.project.symbols.push(this),item&&this.setDefinition(item,dontCenter)},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._class,this._definition],options,!1,dictionary)})},_changed:function(flags){8&flags&&Item._clearBoundsCache(this),1&flags&&(this.project._needsUpdate=!0)},getDefinition:function(){return this._definition},setDefinition:function(item,_dontCenter){item._parentSymbol&&(item=item.clone()),this._definition&&(this._definition._parentSymbol=null),this._definition=item,item.remove(),item.setSelected(!1),_dontCenter||item.setPosition(new Point),item._parentSymbol=this,this._changed(9)},place:function(position){return new PlacedSymbol(this,position)},clone:function(){return new Symbol(this._definition.clone(!1))}}),Item=Base.extend(Callback,{statics:{extend:function extend(src){return src._serializeFields&&(src._serializeFields=new Base(this.prototype._serializeFields,src._serializeFields)),extend.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_applyMatrix:!0,_canApplyMatrix:!0,_boundsSelected:!1,_selectChildren:!1,_serializeFields:{name:null,matrix:new Matrix,pivot:null,locked:!1,visible:!0,blendMode:"normal",opacity:1,guide:!1,selected:!1,clipMask:!1,applyMatrix:null,data:{}},initialize:function(){},_initialize:function(props,point){var internal=props&&props.internal===!0,matrix=this._matrix=new Matrix,project=paper.project;return internal||(this._id=Item._id=(Item._id||0)+1),this._applyMatrix=this._canApplyMatrix&&paper.settings.applyMatrix,point&&matrix.translate(point),matrix._owner=this,this._style=new Style(project._currentStyle,this,project),this._project||(internal||props&&props.insert===!1?this._setProject(project):(project.activeLayer||new Layer).addChild(this)),props&&props!==Item.NO_INSERT?this._set(props,{insert:!0}):!0},_events:new function(){var mouseFlags={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}},mouseEvent={install:function(type){var counters=this.getView()._eventCounters;if(counters)for(var key in mouseFlags)counters[key]=(counters[key]||0)+(mouseFlags[key][type]||0)},uninstall:function(type){var counters=this.getView()._eventCounters;if(counters)for(var key in mouseFlags)counters[key]-=mouseFlags[key][type]||0}};return Base.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],function(name){this[name]=mouseEvent},{onFrame:{install:function(){this._animateItem(!0)},uninstall:function(){this._animateItem(!1)}},onLoad:{}})},_animateItem:function(animate){this.getView()._animateItem(this,animate)},_serialize:function(options,dictionary){function serialize(fields){for(var key in fields){var value=that[key];Base.equals(value,"leading"===key?1.2*fields.fontSize:fields[key])||(props[key]=Base.serialize(value,options,"data"!==key,dictionary))}}var props={},that=this;return serialize(this._serializeFields),this instanceof Group||serialize(this._style._defaults),[this._class,props]},_changed:function(flags){var symbol=this._parentSymbol,cacheParent=this._parent||symbol,project=this._project;if(8&flags&&(this._bounds=this._position=this._decomposed=this._globalMatrix=this._currentPath=undefined),cacheParent&&40&flags&&Item._clearBoundsCache(cacheParent),2&flags&&Item._clearBoundsCache(this),project&&(1&flags&&(project._needsUpdate=!0),project._changes)){var entry=project._changesById[this._id];entry?entry.flags|=flags:(entry={item:this,flags:flags},project._changesById[this._id]=entry,project._changes.push(entry))}symbol&&symbol._changed(flags)},set:function(props){return props&&this._set(props,{insert:!0}),this},getId:function(){return this._id},getClassName:function(){return this._class},getName:function(){return this._name},setName:function(name,unique){if(this._name&&this._removeNamed(),name===+name+"")throw new Error("Names consisting only of numbers are not supported.");if(name&&this._parent){for(var children=this._parent._children,namedChildren=this._parent._namedChildren,orig=name,i=1;unique&&children[name];)name=orig+" "+i++;(namedChildren[name]=namedChildren[name]||[]).push(this),children[name]=this}this._name=name||undefined,this._changed(128)},getStyle:function(){return this._style},setStyle:function(style){this.getStyle().set(style)},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()}},Base.each(["locked","visible","blendMode","opacity","guide"],function(name){var part=Base.capitalize(name),name="_"+name;this["get"+part]=function(){return this[name]},this["set"+part]=function(value){value!=this[name]&&(this[name]=value,this._changed("_locked"===name?128:129))}},{}),{beans:!0,_locked:!1,_visible:!0,_blendMode:"normal",_opacity:1,_guide:!1,isSelected:function(){if(this._selectChildren)for(var i=0,l=this._children.length;l>i;i++)if(this._children[i].isSelected())return!0;return this._selected},setSelected:function(selected,noChildren){if(!noChildren&&this._selectChildren)for(var i=0,l=this._children.length;l>i;i++)this._children[i].setSelected(selected);(selected=!!selected)^this._selected&&(this._selected=selected,this._project._updateSelection(this),this._changed(129))},_selected:!1,isFullySelected:function(){if(this._children&&this._selected){for(var i=0,l=this._children.length;l>i;i++)if(!this._children[i].isFullySelected())return!1;return!0}return this._selected},setFullySelected:function(selected){if(this._children)for(var i=0,l=this._children.length;l>i;i++)this._children[i].setFullySelected(selected);this.setSelected(selected,!0)},isClipMask:function(){return this._clipMask},setClipMask:function(clipMask){this._clipMask!=(clipMask=!!clipMask)&&(this._clipMask=clipMask,clipMask&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(129),this._parent&&this._parent._changed(1024))},_clipMask:!1,getData:function(){return this._data||(this._data={}),this._data},setData:function(data){this._data=data},getPosition:function(_dontLink){var position=this._position,ctor=_dontLink?Point:LinkedPoint;if(!position){var pivot=this._pivot;position=this._position=pivot?this._matrix._transformPoint(pivot):this.getBounds().getCenter(!0)}return new ctor(position.x,position.y,this,"setPosition")},setPosition:function(){this.translate(Point.read(arguments).subtract(this.getPosition(!0)))},getPivot:function(_dontLink){var pivot=this._pivot;if(pivot){var ctor=_dontLink?Point:LinkedPoint;pivot=new ctor(pivot.x,pivot.y,this,"setAnchor")}return pivot},setPivot:function(){this._pivot=Point.read(arguments),this._position=undefined},_pivot:null,getRegistration:"#getPivot",setRegistration:"#setPivot"},Base.each(["bounds","strokeBounds","handleBounds","roughBounds","internalBounds","internalRoughBounds"],function(key){var getter="get"+Base.capitalize(key),match=key.match(/^internal(.*)$/),internalGetter=match?"get"+match[1]:null;this[getter]=function(_matrix){var boundsGetter=this._boundsGetter,name=!internalGetter&&("string"==typeof boundsGetter?boundsGetter:boundsGetter&&boundsGetter[getter])||getter,bounds=this._getCachedBounds(name,_matrix,null,internalGetter);return"bounds"===key?new LinkedRectangle(bounds.x,bounds.y,bounds.width,bounds.height,this,"setBounds"):bounds}},{beans:!0,_getBounds:function(getter,matrix,cacheItem){var children=this._children;if(!children||0==children.length)return new Rectangle;for(var x1=1/0,x2=-x1,y1=x1,y2=x2,i=0,l=children.length;l>i;i++){var child=children[i];if(child._visible&&!child.isEmpty()){var rect=child._getCachedBounds(getter,matrix,cacheItem);x1=Math.min(rect.x,x1),y1=Math.min(rect.y,y1),x2=Math.max(rect.x+rect.width,x2),y2=Math.max(rect.y+rect.height,y2)}}return isFinite(x1)?new Rectangle(x1,y1,x2-x1,y2-y1):new Rectangle},setBounds:function(){var rect=Rectangle.read(arguments),bounds=this.getBounds(),matrix=new Matrix,center=rect.getCenter();matrix.translate(center),(rect.width!=bounds.width||rect.height!=bounds.height)&&matrix.scale(0!=bounds.width?rect.width/bounds.width:1,0!=bounds.height?rect.height/bounds.height:1),center=bounds.getCenter(),matrix.translate(-center.x,-center.y),this.transform(matrix)},_getCachedBounds:function(getter,matrix,cacheItem,internalGetter){matrix=matrix&&matrix.orNullIfIdentity();var _matrix=internalGetter?null:this._matrix.orNullIfIdentity(),cache=(!matrix||matrix.equals(_matrix))&&getter,cacheParent=this._parent||this._parentSymbol;if(cacheItem&&cacheParent){var id=cacheItem._id,ref=cacheParent._boundsCache=cacheParent._boundsCache||{ids:{},list:[]};ref.ids[id]||(ref.list.push(cacheItem),ref.ids[id]=cacheItem)}if(cache&&this._bounds&&this._bounds[cache])return this._bounds[cache].clone();matrix=matrix?_matrix?matrix.clone().concatenate(_matrix):matrix:_matrix;var bounds=this._getBounds(internalGetter||getter,matrix,cache?this:cacheItem);if(cache){this._bounds||(this._bounds={});var cached=this._bounds[cache]=bounds.clone();cached._internal=!!internalGetter}return bounds},statics:{_clearBoundsCache:function(item){if(item._boundsCache){for(var i=0,list=item._boundsCache.list,l=list.length;l>i;i++){var child=list[i];child._bounds=child._position=undefined,child!==item&&child._boundsCache&&Item._clearBoundsCache(child)}item._boundsCache=undefined}}}}),{beans:!0,_decompose:function(){return this._decomposed=this._matrix.decompose()},getRotation:function(){var decomposed=this._decomposed||this._decompose();return decomposed&&decomposed.rotation},setRotation:function(rotation){var current=this.getRotation();if(null!=current&&null!=rotation){var decomposed=this._decomposed;this.rotate(rotation-current),decomposed.rotation=rotation,this._decomposed=decomposed}},getScaling:function(){var decomposed=this._decomposed||this._decompose();return decomposed&&decomposed.scaling},setScaling:function(){var current=this.getScaling();if(null!=current){var scaling=Point.read(arguments,0,{clone:!0}),decomposed=this._decomposed;this.scale(scaling.x/current.x,scaling.y/current.y),decomposed.scaling=scaling,this._decomposed=decomposed}},getMatrix:function(){return this._matrix},setMatrix:function(matrix){this._matrix.initialize(matrix),this._applyMatrix?this.transform(null,!0):this._changed(9)},getGlobalMatrix:function(_internal){var matrix=this._globalMatrix,updateVersion=this._project._updateVersion,viewMatrix=this.getView()._matrix;return matrix&&matrix._updateVersion!==updateVersion&&(matrix=null),matrix||(matrix=this._globalMatrix=this._matrix.clone(),matrix.preConcatenate(this._parent?this._parent.getGlobalMatrix(!0):viewMatrix),matrix._updateVersion=updateVersion),_internal?matrix:viewMatrix.inverted().concatenate(matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(transform){(this._applyMatrix=this._canApplyMatrix&&!!transform)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(project,installEvents){if(this._project!==project){this._project&&this._installEvents(!1),this._project=project;for(var children=this._children,i=0,l=children&&children.length;l>i;i++)children[i]._setProject(project);installEvents=!0}installEvents&&this._installEvents(!0)},getView:function(){return this._project.getView()},_installEvents:function _installEvents(install){_installEvents.base.call(this,install);for(var children=this._children,i=0,l=children&&children.length;l>i;i++)children[i]._installEvents(install)},getLayer:function(){for(var parent=this;parent=parent._parent;)if(parent instanceof Layer)return parent;return null},getParent:function(){return this._parent},setParent:function(item){return item.addChild(this)},getChildren:function(){return this._children},setChildren:function(items){this.removeChildren(),this.addChildren(items)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},isInserted:function(){return this._parent?this._parent.isInserted():!1},equals:function(item){return item===this||item&&this._class===item._class&&this._style.equals(item._style)&&this._matrix.equals(item._matrix)&&this._locked===item._locked&&this._visible===item._visible&&this._blendMode===item._blendMode&&this._opacity===item._opacity&&this._clipMask===item._clipMask&&this._guide===item._guide&&this._equals(item)||!1},_equals:function(item){return Base.equals(this._children,item._children)},clone:function(insert){return this._clone(new this.constructor(Item.NO_INSERT),insert)},_clone:function(copy,insert){if(copy.setStyle(this._style),this._children)for(var i=0,l=this._children.length;l>i;i++)copy.addChild(this._children[i].clone(!1),!0);(insert||insert===undefined)&&copy.insertAbove(this);for(var keys=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide","_applyMatrix"],i=0,l=keys.length;l>i;i++){var key=keys[i];this.hasOwnProperty(key)&&(copy[key]=this[key])}return copy._matrix.initialize(this._matrix),copy._data=this._data?Base.clone(this._data):null,copy.setSelected(this._selected),this._name&&copy.setName(this._name,!0),copy},copyTo:function(itemOrProject){return itemOrProject.addChild(this.clone(!1))},rasterize:function(resolution){var bounds=this.getStrokeBounds(),scale=(resolution||this.getView().getResolution())/72,topLeft=bounds.getTopLeft().floor(),bottomRight=bounds.getBottomRight().ceil(),size=new Size(bottomRight.subtract(topLeft)),canvas=CanvasProvider.getCanvas(size.multiply(scale)),ctx=canvas.getContext("2d"),matrix=(new Matrix).scale(scale).translate(topLeft.negate());ctx.save(),matrix.applyToContext(ctx),this.draw(ctx,new Base({transforms:[matrix]})),ctx.restore();var raster=new Raster(Item.NO_INSERT);return raster.setCanvas(canvas),raster.transform((new Matrix).translate(topLeft.add(size.divide(2))).scale(1/scale)),raster.insertAbove(this),raster},contains:function(){return!!this._contains(this._matrix._inverseTransform(Point.read(arguments)))},_contains:function(point){if(this._children){for(var i=this._children.length-1;i>=0;i--)if(this._children[i].contains(point))return!0;return!1}return point.isInside(this.getInternalBounds())},hitTest:function(point,options){function checkBounds(type,part){var pt=bounds["get"+part]();return point.subtract(pt).divide(tolerancePadding).length<=1?new HitResult(type,that,{name:Base.hyphenate(part),point:pt}):void 0}if(point=Point.read(arguments),options=HitResult.getOptions(Base.read(arguments)),this._locked||!this._visible||this._guide&&!options.guides||this.isEmpty())return null;var matrix=this._matrix,parentTotalMatrix=options._totalMatrix,view=this.getView(),totalMatrix=options._totalMatrix=parentTotalMatrix?parentTotalMatrix.clone().concatenate(matrix):this.getGlobalMatrix().clone().preConcatenate(view._matrix),tolerancePadding=options._tolerancePadding=new Size(Path._getPenPadding(1,totalMatrix.inverted())).multiply(Math.max(options.tolerance,1e-5));if(point=matrix._inverseTransform(point),!this._children&&!this.getInternalRoughBounds().expand(tolerancePadding.multiply(2))._containsPoint(point))return null;var type,res,checkSelf=!(options.guides&&!this._guide||options.selected&&!this._selected||(type=options.type)&&("string"==typeof type?type!==Base.hyphenate(this._class):!(this instanceof type))),that=this;if(checkSelf&&(options.center||options.bounds)&&this._parent){var bounds=this.getInternalBounds();if(options.center&&(res=checkBounds("center","Center")),!res&&options.bounds)for(var points=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],i=0;8>i&&!res;i++)res=checkBounds("bounds",points[i])}var children=!res&&this._children;if(children)for(var opts=this._getChildHitTestOptions(options),i=children.length-1;i>=0&&!res;i--)res=children[i].hitTest(point,opts);return!res&&checkSelf&&(res=this._hitTest(point,options)),res&&res.point&&(res.point=matrix.transform(res.point)),options._totalMatrix=parentTotalMatrix,res},_getChildHitTestOptions:function(options){return options},_hitTest:function(point,options){return options.fill&&this.hasFill()&&this._contains(point)?new HitResult("fill",this):void 0}},{matches:function(match){function matchObject(obj1,obj2){for(var i in obj1)if(obj1.hasOwnProperty(i)){var val1=obj1[i],val2=obj2[i];if(Base.isPlainObject(val1)&&Base.isPlainObject(val2)){if(!matchObject(val1,val2))return!1}else if(!Base.equals(val1,val2))return!1}return!0}for(var key in match)if(match.hasOwnProperty(key)){var value=this[key],compare=match[key];if(value===undefined&&"type"===key&&(value=Base.hyphenate(this._class)),/^(constructor|class)$/.test(key)){if(!(this instanceof compare))return!1
}else if(compare instanceof RegExp){if(!compare.test(value))return!1}else if("function"==typeof compare){if(!compare(value))return!1}else if(Base.isPlainObject(compare)){if(!matchObject(compare,value))return!1}else if(!Base.equals(value,compare))return!1}return!0},getItems:function(match){return Item._getItems(this._children,match,!0)},getItem:function(match){return Item._getItems(this._children,match,!1)},statics:{_getItems:function _getItems(children,match,list){for(var items=list&&[],i=0,l=children&&children.length;l>i;i++){var child=children[i];if(child.matches(match)){if(!list)return child;items.push(child)}var res=_getItems(child._children,match,list);if(list)items.push.apply(items,res);else if(res)return res}return list?items:null}}},{importJSON:function(json){var res=Base.importJSON(json,this);return res!==this?this.addChild(res):res},addChild:function(item,_preserve){return this.insertChild(undefined,item,_preserve)},insertChild:function(index,item,_preserve){var res=this.insertChildren(index,[item],_preserve);return res&&res[0]},addChildren:function(items,_preserve){return this.insertChildren(this._children.length,items,_preserve)},insertChildren:function(index,items,_preserve,_proto){var children=this._children;if(children&&items&&items.length>0){items=Array.prototype.slice.apply(items);for(var i=items.length-1;i>=0;i--){var item=items[i];!_proto||item instanceof _proto?item._remove(!1,!0):items.splice(i,1)}Base.splice(children,items,index,0);for(var project=this._project,notifySelf=project&&project._changes,i=0,l=items.length;l>i;i++){var item=items[i];item._parent=this,item._setProject(this._project,!0),item._name&&item.setName(item._name),notifySelf&&this._changed(5)}this._changed(11)}else items=null;return items},_insert:function(above,item,_preserve){if(!item._parent)return null;var index=item._index+(above?1:0);return item._parent===this._parent&&index>this._index&&index--,item._parent.insertChild(index,this,_preserve)},insertAbove:function(item,_preserve){return this._insert(!0,item,_preserve)},insertBelow:function(item,_preserve){return this._insert(!1,item,_preserve)},sendToBack:function(){return this._parent.insertChild(0,this)},bringToFront:function(){return this._parent.addChild(this)},appendTop:"#addChild",appendBottom:function(item){return this.insertChild(0,item)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",reduce:function(){if(this._children&&1===this._children.length){var child=this._children[0].reduce();return child.insertAbove(this),child.setStyle(this._style),this.remove(),child}return this},_removeNamed:function(){var children=this._parent._children,namedChildren=this._parent._namedChildren,name=this._name,namedArray=namedChildren[name],index=namedArray?namedArray.indexOf(this):-1;-1!=index&&(children[name]==this&&delete children[name],namedArray.splice(index,1),namedArray.length?children[name]=namedArray[namedArray.length-1]:delete namedChildren[name])},_remove:function(notifySelf,notifyParent){var parent=this._parent;if(parent){if(this._name&&this._removeNamed(),null!=this._index&&Base.splice(parent._children,null,this._index,1),this._installEvents(!1),notifySelf){var project=this._project;project&&project._changes&&this._changed(5)}return notifyParent&&parent._changed(11),this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},removeChildren:function(from,to){if(!this._children)return null;from=from||0,to=Base.pick(to,this._children.length);for(var removed=Base.splice(this._children,null,from,to-from),i=removed.length-1;i>=0;i--)removed[i]._remove(!0,!1);return removed.length>0&&this._changed(11),removed},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var i=0,l=this._children.length;l>i;i++)this._children[i]._index=i;this._changed(11)}},isEmpty:function(){return!this._children||0==this._children.length},isEditable:function(){for(var item=this;item;){if(!item._visible||item._locked)return!1;item=item._parent}return!0},_getOrder:function(item){function getList(item){var list=[];do list.unshift(item);while(item=item._parent);return list}for(var list1=getList(this),list2=getList(item),i=0,l=Math.min(list1.length,list2.length);l>i;i++)if(list1[i]!=list2[i])return list1[i]._index<list2[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isAbove:function(item){return-1===this._getOrder(item)},isBelow:function(item){return 1===this._getOrder(item)},isParent:function(item){return this._parent===item},isChild:function(item){return item&&item._parent===this},isDescendant:function(item){for(var parent=this;parent=parent._parent;)if(parent==item)return!0;return!1},isAncestor:function(item){return item?item.isDescendant(this):!1},isGroupedWith:function(item){for(var parent=this._parent;parent;){if(parent._parent&&/^(Group|Layer|CompoundPath)$/.test(parent._class)&&item.isDescendant(parent))return!0;parent=parent._parent}return!1},translate:function(){var mx=new Matrix;return this.transform(mx.translate.apply(mx,arguments))},rotate:function(angle){return this.transform((new Matrix).rotate(angle,Point.read(arguments,1,{readNull:!0})||this.getPosition(!0)))}},Base.each(["scale","shear","skew"],function(name){this[name]=function(){var point=Point.read(arguments),center=Point.read(arguments,0,{readNull:!0});return this.transform((new Matrix)[name](point,center||this.getPosition(!0)))}},{}),{transform:function(matrix,_applyMatrix){matrix&&matrix.isIdentity()&&(matrix=null);var _matrix=this._matrix,applyMatrix=(_applyMatrix||this._applyMatrix)&&(!_matrix.isIdentity()||matrix);if(!matrix&&!applyMatrix)return this;if(matrix&&_matrix.preConcatenate(matrix),applyMatrix=applyMatrix&&this._transformContent(_matrix)){var pivot=this._pivot,style=this._style,fillColor=style.getFillColor(!0),strokeColor=style.getStrokeColor(!0);pivot&&pivot.transform(_matrix),fillColor&&fillColor.transform(_matrix),strokeColor&&strokeColor.transform(_matrix),_matrix.reset(!0)}var bounds=this._bounds,position=this._position;this._changed(9);var decomp=bounds&&matrix&&matrix.decompose();if(decomp&&!decomp.shearing&&decomp.rotation%90===0){for(var key in bounds){var rect=bounds[key];(applyMatrix||!rect._internal)&&matrix._transformBounds(rect,rect)}var getter=this._boundsGetter,rect=bounds[getter&&getter.getBounds||getter||"getBounds"];rect&&(this._position=rect.getCenter(!0)),this._bounds=bounds}else matrix&&position&&(this._position=matrix._transformPoint(position,position));return this},_transformContent:function(matrix){var children=this._children;if(children){for(var i=0,l=children.length;l>i;i++)children[i].transform(matrix,!0);return!0}},globalToLocal:function(){var matrix=this.getGlobalMatrix();return matrix&&matrix._inverseTransform(Point.read(arguments))},localToGlobal:function(){var matrix=this.getGlobalMatrix();return matrix&&matrix._transformPoint(Point.read(arguments))},fitBounds:function(rectangle,fill){rectangle=Rectangle.read(arguments);var bounds=this.getBounds(),itemRatio=bounds.height/bounds.width,rectRatio=rectangle.height/rectangle.width,scale=(fill?itemRatio>rectRatio:rectRatio>itemRatio)?rectangle.width/bounds.width:rectangle.height/bounds.height,newBounds=new Rectangle(new Point,new Size(bounds.width*scale,bounds.height*scale));newBounds.setCenter(rectangle.getCenter()),this.setBounds(newBounds)},_setStyles:function(ctx){var style=this._style,fillColor=style.getFillColor(),strokeColor=style.getStrokeColor(),shadowColor=style.getShadowColor();if(fillColor&&(ctx.fillStyle=fillColor.toCanvasStyle(ctx)),strokeColor){var strokeWidth=style.getStrokeWidth();if(strokeWidth>0){ctx.strokeStyle=strokeColor.toCanvasStyle(ctx),ctx.lineWidth=strokeWidth;var strokeJoin=style.getStrokeJoin(),strokeCap=style.getStrokeCap(),miterLimit=style.getMiterLimit();if(strokeJoin&&(ctx.lineJoin=strokeJoin),strokeCap&&(ctx.lineCap=strokeCap),miterLimit&&(ctx.miterLimit=miterLimit),paper.support.nativeDash){var dashArray=style.getDashArray(),dashOffset=style.getDashOffset();dashArray&&dashArray.length&&("setLineDash"in ctx?(ctx.setLineDash(dashArray),ctx.lineDashOffset=dashOffset):(ctx.mozDash=dashArray,ctx.mozDashOffset=dashOffset))}}}if(shadowColor){var shadowBlur=style.getShadowBlur();if(shadowBlur>0){ctx.shadowColor=shadowColor.toCanvasStyle(ctx),ctx.shadowBlur=shadowBlur;var offset=this.getShadowOffset();ctx.shadowOffsetX=offset.x,ctx.shadowOffsetY=offset.y}}},draw:function(ctx,param){if(this._visible&&0!==this._opacity){var updateVersion=this._updateVersion=this._project._updateVersion,trackTransforms=param.trackTransforms,transforms=param.transforms,matrix=this._matrix,parentMatrix=transforms[transforms.length-1],globalMatrix=parentMatrix.clone().concatenate(matrix);if(globalMatrix.isInvertible()){trackTransforms&&(transforms.push(this._globalMatrix=globalMatrix),globalMatrix._updateVersion=updateVersion);var mainCtx,itemOffset,prevOffset,blendMode=this._blendMode,opacity=this._opacity,normalBlend="normal"===blendMode,nativeBlend=BlendMode.nativeModes[blendMode],direct=normalBlend&&1===opacity||param.clip||(nativeBlend||normalBlend&&1>opacity)&&this._canComposite();if(!direct){var bounds=this.getStrokeBounds(parentMatrix);if(!bounds.width||!bounds.height)return;prevOffset=param.offset,itemOffset=param.offset=bounds.getTopLeft().floor(),mainCtx=ctx,ctx=CanvasProvider.getContext(bounds.getSize().ceil().add(new Size(1,1)),param.pixelRatio)}ctx.save(),direct?(ctx.globalAlpha=opacity,nativeBlend&&(ctx.globalCompositeOperation=blendMode)):ctx.translate(-itemOffset.x,-itemOffset.y),(direct?matrix:globalMatrix).applyToContext(ctx),!direct&&param.clipItem&&param.clipItem.draw(ctx,param.extend({clip:!0})),this._draw(ctx,param),ctx.restore(),trackTransforms&&transforms.pop(),param.clip&&!param.dontFinish&&ctx.clip(),direct||(BlendMode.process(blendMode,ctx,mainCtx,opacity,itemOffset.subtract(prevOffset).multiply(param.pixelRatio)),CanvasProvider.release(ctx),param.offset=prevOffset)}}},_canComposite:function(){return!1}},Base.each(["down","drag","up","move"],function(name){this["removeOn"+Base.capitalize(name)]=function(){var hash={};return hash[name]=!0,this.removeOn(hash)}},{removeOn:function(obj){for(var name in obj)if(obj[name]){var key="mouse"+name,project=this._project,sets=project._removeSets=project._removeSets||{};sets[key]=sets[key]||{},sets[key][this._id]=this}return this}})),Group=Item.extend({_class:"Group",_selectChildren:!0,_serializeFields:{children:[]},initialize:function(arg){this._children=[],this._namedChildren={},this._initialize(arg)||this.addChildren(Array.isArray(arg)?arg:arguments)},_changed:function _changed(flags){_changed.base.call(this,flags),1026&flags&&(this._clipItem=undefined)},_getClipItem:function(){var clipItem=this._clipItem;if(clipItem===undefined){clipItem=null;for(var i=0,l=this._children.length;l>i;i++){var child=this._children[i];if(child._clipMask){clipItem=child;break}}this._clipItem=clipItem}return clipItem},isClipped:function(){return!!this._getClipItem()},setClipped:function(clipped){var child=this.getFirstChild();child&&child.setClipMask(clipped)},_draw:function(ctx,param){var clip=param.clip,clipItem=!clip&&this._getClipItem(),draw=!0;if(param=param.extend({clipItem:clipItem,clip:!1}),clip?this._currentPath?(ctx.currentPath=this._currentPath,draw=!1):(ctx.beginPath(),param.dontStart=param.dontFinish=!0):clipItem&&clipItem.draw(ctx,param.extend({clip:!0})),draw)for(var i=0,l=this._children.length;l>i;i++){var item=this._children[i];item!==clipItem&&item.draw(ctx,param)}clip&&(this._currentPath=ctx.currentPath)}}),Layer=Group.extend({_class:"Layer",initialize:function(arg){var props=Base.isPlainObject(arg)?new Base(arg):{children:Array.isArray(arg)?arg:arguments},insert=props.insert;props.insert=!1,Group.call(this,props),(insert||insert===undefined)&&(this._project.addChild(this),this.activate())},_remove:function _remove(notify){return this._parent?_remove.base.call(this,notify):null!=this._index?(this._project.activeLayer===this&&(this._project.activeLayer=this.getNextSibling()||this.getPreviousSibling()),Base.splice(this._project.layers,null,this._index,1),this._installEvents(!1),this._project._needsUpdate=!0,!0):!1},getNextSibling:function getNextSibling(){return this._parent?getNextSibling.base.call(this):this._project.layers[this._index+1]||null},getPreviousSibling:function getPreviousSibling(){return this._parent?getPreviousSibling.base.call(this):this._project.layers[this._index-1]||null},isInserted:function isInserted(){return this._parent?isInserted.base.call(this):null!=this._index},activate:function(){this._project.activeLayer=this},_insert:function _insert(above,item,_preserve){return item instanceof Layer&&!item._parent?(this._remove(!0,!0),Base.splice(item._project.layers,[this],item._index+(above?1:0),0),this._setProject(item._project,!0),this):_insert.base.call(this,above,item,_preserve)}}),Shape=Item.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_boundsSelected:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(props){this._initialize(props)},_equals:function(item){return this._type===item._type&&this._size.equals(item._size)&&Base.equals(this._radius,item._radius)},clone:function(insert){var copy=new Shape(Item.NO_INSERT);return copy.setType(this._type),copy.setSize(this._size),copy.setRadius(this._radius),this._clone(copy,insert)},getType:function(){return this._type},setType:function(type){this._type=type},getShape:"#getType",setShape:"#setType",getSize:function(){var size=this._size;return new LinkedSize(size.width,size.height,this,"setSize")},setSize:function(){var size=Size.read(arguments);if(this._size){if(!this._size.equals(size)){var type=this._type,width=size.width,height=size.height;if("rectangle"===type){var radius=Size.min(this._radius,size.divide(2));this._radius.set(radius.width,radius.height)}else"circle"===type?(width=height=(width+height)/2,this._radius=width/2):"ellipse"===type&&this._radius.set(width/2,height/2);this._size.set(width,height),this._changed(9)}}else this._size=size.clone()},getRadius:function(){var rad=this._radius;return"circle"===this._type?rad:new LinkedSize(rad.width,rad.height,this,"setRadius")},setRadius:function(radius){var type=this._type;if("circle"===type){if(radius===this._radius)return;var size=2*radius;this._radius=radius,this._size.set(size,size)}else if(radius=Size.read(arguments),this._radius){if(this._radius.equals(radius))return;if(this._radius.set(radius.width,radius.height),"rectangle"===type){var size=Size.max(this._size,radius.multiply(2));this._size.set(size.width,size.height)}else"ellipse"===type&&this._size.set(2*radius.width,2*radius.height)}else this._radius=radius.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(insert){var path=new(Path[Base.capitalize(this._type)])({center:new Point,size:this._size,radius:this._radius,insert:!1});return path.setStyle(this._style),path.transform(this._matrix),(insert||insert===undefined)&&path.insertAbove(this),path},_draw:function(ctx,param){var style=this._style,hasFill=style.hasFill(),hasStroke=style.hasStroke(),dontPaint=param.dontFinish||param.clip;if(hasFill||hasStroke||dontPaint){var radius=this._radius,type=this._type;if(param.dontStart||ctx.beginPath(),"circle"===type)ctx.arc(0,0,radius,0,2*Math.PI,!0);else{var rx=radius.width,ry=radius.height,kappa=.5522847498307936;if("ellipse"===type){var cx=rx*kappa,cy=ry*kappa;ctx.moveTo(-rx,0),ctx.bezierCurveTo(-rx,-cy,-cx,-ry,0,-ry),ctx.bezierCurveTo(cx,-ry,rx,-cy,rx,0),ctx.bezierCurveTo(rx,cy,cx,ry,0,ry),ctx.bezierCurveTo(-cx,ry,-rx,cy,-rx,0)}else{var size=this._size,width=size.width,height=size.height;if(0===rx&&0===ry)ctx.rect(-width/2,-height/2,width,height);else{kappa=1-kappa;var x=width/2,y=height/2,cx=rx*kappa,cy=ry*kappa;ctx.moveTo(-x,-y+ry),ctx.bezierCurveTo(-x,-y+cy,-x+cx,-y,-x+rx,-y),ctx.lineTo(x-rx,-y),ctx.bezierCurveTo(x-cx,-y,x,-y+cy,x,-y+ry),ctx.lineTo(x,y-ry),ctx.bezierCurveTo(x,y-cy,x-cx,y,x-rx,y),ctx.lineTo(-x+rx,y),ctx.bezierCurveTo(-x+cx,y,-x,y-cy,-x,y-ry)}}}ctx.closePath()}dontPaint||!hasFill&&!hasStroke||(this._setStyles(ctx),hasFill&&(ctx.fill(style.getWindingRule()),ctx.shadowColor="rgba(0,0,0,0)"),hasStroke&&ctx.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(getter,matrix){var rect=new Rectangle(this._size).setCenter(0,0);return"getBounds"!==getter&&this.hasStroke()&&(rect=rect.expand(this.getStrokeWidth())),matrix?matrix._transformBounds(rect):rect}},new function(){function getCornerCenter(that,point,expand){var radius=that._radius;if(!radius.isZero())for(var halfSize=that._size.divide(2),i=0;4>i;i++){var dir=new Point(1&i?1:-1,i>1?1:-1),corner=dir.multiply(halfSize),center=corner.subtract(dir.multiply(radius)),rect=new Rectangle(corner,center);if((expand?rect.expand(expand):rect).contains(point))return center}}function getEllipseRadius(point,radius){var angle=point.getAngleInRadians(),width=2*radius.width,height=2*radius.height,x=width*Math.sin(angle),y=height*Math.cos(angle);return width*height/(2*Math.sqrt(x*x+y*y))}return{_contains:function _contains(point){if("rectangle"===this._type){var center=getCornerCenter(this,point);return center?point.subtract(center).divide(this._radius).getLength()<=1:_contains.base.call(this,point)}return point.divide(this.size).getLength()<=.5},_hitTest:function _hitTest(point,options){var hit=!1;if(this.hasStroke()){var type=this._type,radius=this._radius,strokeWidth=this.getStrokeWidth()+2*options.tolerance;if("rectangle"===type){var center=getCornerCenter(this,point,strokeWidth);if(center){var pt=point.subtract(center);hit=2*Math.abs(pt.getLength()-getEllipseRadius(pt,radius))<=strokeWidth}else{var rect=new Rectangle(this._size).setCenter(0,0),outer=rect.expand(strokeWidth),inner=rect.expand(-strokeWidth);hit=outer._containsPoint(point)&&!inner._containsPoint(point)}}else"ellipse"===type&&(radius=getEllipseRadius(point,radius)),hit=2*Math.abs(point.getLength()-radius)<=strokeWidth}return hit?new HitResult("stroke",this):_hitTest.base.apply(this,arguments)}}},{statics:new function(){function createShape(type,point,size,radius,args){var item=new Shape(Base.getNamed(args));return item._type=type,item._size=size,item._radius=radius,item.translate(point)}return{Circle:function(){var center=Point.readNamed(arguments,"center"),radius=Base.readNamed(arguments,"radius");return createShape("circle",center,new Size(2*radius),radius,arguments)},Rectangle:function(){var rect=Rectangle.readNamed(arguments,"rectangle"),radius=Size.min(Size.readNamed(arguments,"radius"),rect.getSize(!0).divide(2));return createShape("rectangle",rect.getCenter(!0),rect.getSize(!0),radius,arguments)},Ellipse:function(){var ellipse=Shape._readEllipse(arguments),radius=ellipse.radius;return createShape("ellipse",ellipse.center,radius.multiply(2),radius,arguments)},_readEllipse:function(args){var center,radius;if(Base.hasNamed(args,"radius"))center=Point.readNamed(args,"center"),radius=Size.readNamed(args,"radius");else{var rect=Rectangle.readNamed(args,"rectangle");center=rect.getCenter(!0),radius=rect.getSize(!0).divide(2)}return{center:center,radius:radius}}}}}),Raster=Item.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsGetter:"getBounds",_boundsSelected:!0,_serializeFields:{source:null},initialize:function(object,position){this._initialize(object,position!==undefined&&Point.read(arguments,1))||("string"==typeof object?this.setSource(object):this.setImage(object)),this._size||(this._size=new Size)},_equals:function(item){return this.getSource()===item.getSource()},clone:function(insert){var copy=new Raster(Item.NO_INSERT),image=this._image,canvas=this._canvas;if(image)copy.setImage(image);else if(canvas){var copyCanvas=CanvasProvider.getCanvas(this._size);copyCanvas.getContext("2d").drawImage(canvas,0,0),copy.setCanvas(copyCanvas)}return this._clone(copy,insert)},getSize:function(){var size=this._size;return new LinkedSize(size.width,size.height,this,"setSize")},setSize:function(){var size=Size.read(arguments);if(!this._size.equals(size)){var element=this.getElement();this.setCanvas(CanvasProvider.getCanvas(size)),element&&this.getContext(!0).drawImage(element,0,0,size.width,size.height)}},getWidth:function(){return this._size.width},getHeight:function(){return this._size.height},isEmpty:function(){return 0==this._size.width&&0==this._size.height},getPpi:function(){var matrix=this._matrix,orig=new Point(0,0).transform(matrix),u=new Point(1,0).transform(matrix).subtract(orig),v=new Point(0,1).transform(matrix).subtract(orig);return new Size(72/u.getLength(),72/v.getLength())},getImage:function(){return this._image},setImage:function(image){this._canvas&&CanvasProvider.release(this._canvas),image.getContext?(this._image=null,this._canvas=image):(this._image=image,this._canvas=null),this._size=new Size(image.naturalWidth||image.width,image.naturalHeight||image.height),this._context=null,this._changed(521)},getCanvas:function(){if(!this._canvas){var ctx=CanvasProvider.getContext(this._size);try{this._image&&ctx.drawImage(this._image,0,0),this._canvas=ctx.canvas}catch(e){CanvasProvider.release(ctx)}}return this._canvas},setCanvas:"#setImage",getContext:function(modify){return this._context||(this._context=this.getCanvas().getContext("2d")),modify&&(this._image=null,this._changed(513)),this._context},setContext:function(context){this._context=context},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(src){function loaded(){var view=that.getView();view&&(paper=view._scope,that.setImage(image),that.fire("load"),view.update())}var image,that=this;image=document.getElementById(src)||new Image,image.naturalWidth&&image.naturalHeight?setTimeout(loaded,0):(DomEvent.add(image,{load:loaded}),image.src||(image.src=src)),this.setImage(image)},getElement:function(){return this._canvas||this._image},getSubCanvas:function(rect){var rect=Rectangle.read(arguments),ctx=CanvasProvider.getContext(rect.getSize());return ctx.drawImage(this.getCanvas(),rect.x,rect.y,rect.width,rect.height,0,0,rect.width,rect.height),ctx.canvas},getSubRaster:function(rect){var rect=Rectangle.read(arguments),raster=new Raster(Item.NO_INSERT);return raster.setCanvas(this.getSubCanvas(rect)),raster.translate(rect.getCenter().subtract(this.getSize().divide(2))),raster._matrix.preConcatenate(this._matrix),raster.insertAbove(this),raster},toDataURL:function(){var src=this._image&&this._image.src;if(/^data:/.test(src))return src;var canvas=this.getCanvas();return canvas?canvas.toDataURL():null},drawImage:function(image){var point=Point.read(arguments,1);this.getContext(!0).drawImage(image,point.x,point.y)},getAverageColor:function(object){var bounds,path;object?object instanceof PathItem?(path=object,bounds=object.getBounds()):object.width?bounds=new Rectangle(object):object.x&&(bounds=new Rectangle(object.x-.5,object.y-.5,1,1)):bounds=this.getBounds();var sampleSize=32,width=Math.min(bounds.width,sampleSize),height=Math.min(bounds.height,sampleSize),ctx=Raster._sampleContext;ctx?ctx.clearRect(0,0,sampleSize+1,sampleSize+1):ctx=Raster._sampleContext=CanvasProvider.getContext(new Size(sampleSize)),ctx.save();var matrix=(new Matrix).scale(width/bounds.width,height/bounds.height).translate(-bounds.x,-bounds.y);matrix.applyToContext(ctx),path&&path.draw(ctx,new Base({clip:!0,transforms:[matrix]})),this._matrix.applyToContext(ctx),ctx.drawImage(this.getElement(),-this._size.width/2,-this._size.height/2),ctx.restore();for(var pixels=ctx.getImageData(.5,.5,Math.ceil(width),Math.ceil(height)).data,channels=[0,0,0],total=0,i=0,l=pixels.length;l>i;i+=4){var alpha=pixels[i+3];total+=alpha,alpha/=255,channels[0]+=pixels[i]*alpha,channels[1]+=pixels[i+1]*alpha,channels[2]+=pixels[i+2]*alpha}for(var i=0;3>i;i++)channels[i]/=total;return total?Color.read(channels):null},getPixel:function(point){var point=Point.read(arguments),data=this.getContext().getImageData(point.x,point.y,1,1).data;return new Color("rgb",[data[0]/255,data[1]/255,data[2]/255],data[3]/255)},setPixel:function(){var point=Point.read(arguments),color=Color.read(arguments),components=color._convert("rgb"),alpha=color._alpha,ctx=this.getContext(!0),imageData=ctx.createImageData(1,1),data=imageData.data;data[0]=255*components[0],data[1]=255*components[1],data[2]=255*components[2],data[3]=null!=alpha?255*alpha:255,ctx.putImageData(imageData,point.x,point.y)},createImageData:function(){var size=Size.read(arguments);return this.getContext().createImageData(size.width,size.height)},getImageData:function(rect){var rect=Rectangle.read(arguments);return rect.isEmpty()&&(rect=new Rectangle(this._size)),this.getContext().getImageData(rect.x,rect.y,rect.width,rect.height)},setImageData:function(data){var point=Point.read(arguments,1);this.getContext(!0).putImageData(data,point.x,point.y)},_getBounds:function(getter,matrix){var rect=new Rectangle(this._size).setCenter(0,0);return matrix?matrix._transformBounds(rect):rect},_hitTest:function(point){if(this._contains(point)){var that=this;return new HitResult("pixel",that,{offset:point.add(that._size.divide(2)).round(),color:{get:function(){return that.getPixel(this.offset)}}})}},_draw:function(ctx){var element=this.getElement();element&&(ctx.globalAlpha=this._opacity,ctx.drawImage(element,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),PlacedSymbol=Item.extend({_class:"PlacedSymbol",_applyMatrix:!1,_canApplyMatrix:!1,_boundsGetter:{getBounds:"getStrokeBounds"},_boundsSelected:!0,_serializeFields:{symbol:null},initialize:function(arg0,arg1){this._initialize(arg0,arg1!==undefined&&Point.read(arguments,1))||this.setSymbol(arg0 instanceof Symbol?arg0:new Symbol(arg0))},_equals:function(item){return this._symbol===item._symbol},getSymbol:function(){return this._symbol},setSymbol:function(symbol){this._symbol=symbol,this._changed(9)},clone:function(insert){var copy=new PlacedSymbol(Item.NO_INSERT);return copy.setSymbol(this._symbol),this._clone(copy,insert)},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(getter,matrix,cacheItem){return this.symbol._definition._getCachedBounds(getter,matrix,cacheItem)},_hitTest:function(point,options){var res=this._symbol._definition.hitTest(point,options);return res&&(res.item=this),res},_draw:function(ctx,param){this.symbol._definition.draw(ctx,param)}}),HitResult=Base.extend({_class:"HitResult",initialize:function(type,item,values){this.type=type,this.item=item,values&&(values.enumerable=!0,this.inject(values))},statics:{getOptions:function(options){return options&&options._merged?options:new Base({type:null,tolerance:paper.settings.hitTolerance,fill:!options,stroke:!options,segments:!options,handles:!1,ends:!1,center:!1,bounds:!1,guides:!1,selected:!1,_merged:!0},options)}}}),Segment=Base.extend({_class:"Segment",beans:!0,initialize:function(arg0,arg1,arg2,arg3,arg4,arg5){var point,handleIn,handleOut,count=arguments.length;0===count||(1===count?arg0.point?(point=arg0.point,handleIn=arg0.handleIn,handleOut=arg0.handleOut):point=arg0:2===count&&"number"==typeof arg0?point=arguments:3>=count?(point=arg0,handleIn=arg1,handleOut=arg2):(point=arg0!==undefined?[arg0,arg1]:null,handleIn=arg2!==undefined?[arg2,arg3]:null,handleOut=arg4!==undefined?[arg4,arg5]:null)),new SegmentPoint(point,this,"_point"),new SegmentPoint(handleIn,this,"_handleIn"),new SegmentPoint(handleOut,this,"_handleOut")},_serialize:function(options){return Base.serialize(this.isLinear()?this._point:[this._point,this._handleIn,this._handleOut],options,!0)},_changed:function(point){var path=this._path;if(path){var curveIn,curveOut,curves=path._curves,index=this._index;curves&&(point&&point!==this._point&&point!==this._handleIn||!(curveIn=curves[index-1]||path._closed&&curves[curves.length-1])||curveIn._changed(),point&&point!==this._point&&point!==this._handleOut||!(curveOut=curves[index])||curveOut._changed()),path._changed(25)}},getPoint:function(){return this._point},setPoint:function(){var point=Point.read(arguments);this._point.set(point.x,point.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(){var point=Point.read(arguments);this._handleIn.set(point.x,point.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(){var point=Point.read(arguments);this._handleOut.set(point.x,point.y)},isLinear:function(){return this._handleIn.isZero()&&this._handleOut.isZero()},setLinear:function(){this._handleIn.set(0,0),this._handleOut.set(0,0)},isColinear:function(segment){var next1=this.getNext(),next2=segment.getNext();return this._handleOut.isZero()&&next1._handleIn.isZero()&&segment._handleOut.isZero()&&next2._handleIn.isZero()&&next1._point.subtract(this._point).isColinear(next2._point.subtract(segment._point))},isOrthogonal:function(){var prev=this.getPrevious(),next=this.getNext();return prev._handleOut.isZero()&&this._handleIn.isZero()&&this._handleOut.isZero()&&next._handleIn.isZero()&&this._point.subtract(prev._point).isOrthogonal(next._point.subtract(this._point))},isArc:function(){var next=this.getNext(),handle1=this._handleOut,handle2=next._handleIn,kappa=.5522847498307936;if(handle1.isOrthogonal(handle2)){var from=this._point,to=next._point,corner=new Line(from,handle1,!0).intersect(new Line(to,handle2,!0),!0);return corner&&Numerical.isZero(handle1.getLength()/corner.subtract(from).getLength()-kappa)&&Numerical.isZero(handle2.getLength()/corner.subtract(to).getLength()-kappa)}return!1},_selectionState:0,isSelected:function(_point){var state=this._selectionState;return _point?_point===this._point?!!(4&state):_point===this._handleIn?!!(1&state):_point===this._handleOut?!!(2&state):!1:!!(7&state)},setSelected:function(selected,_point){var path=this._path,selected=!!selected,state=this._selectionState,oldState=state,flag=_point?_point===this._point?4:_point===this._handleIn?1:_point===this._handleOut?2:0:7;selected?state|=flag:state&=~flag,this._selectionState=state,path&&state!==oldState&&(path._updateSelection(this,oldState,state),path._changed(129))},getIndex:function(){return this._index!==undefined?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var path=this._path,index=this._index;return path?(index>0&&!path._closed&&index===path._segments.length-1&&index--,path.getCurves()[index]||null):null},getLocation:function(){var curve=this.getCurve();return curve?new CurveLocation(curve,this===curve._segment1?0:1):null},getNext:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index+1]||this._path._closed&&segments[0])||null},getPrevious:function(){var segments=this._path&&this._path._segments;return segments&&(segments[this._index-1]||this._path._closed&&segments[segments.length-1])||null},reverse:function(){return new Segment(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Segment(this._point,this._handleIn,this._handleOut)},equals:function(segment){return segment===this||segment&&this._class===segment._class&&this._point.equals(segment._point)&&this._handleIn.equals(segment._handleIn)&&this._handleOut.equals(segment._handleOut)||!1},toString:function(){var parts=["point: "+this._point];return this._handleIn.isZero()||parts.push("handleIn: "+this._handleIn),this._handleOut.isZero()||parts.push("handleOut: "+this._handleOut),"{ "+parts.join(", ")+" }"},transform:function(matrix){this._transformCoordinates(matrix,new Array(6),!0),this._changed()},_transformCoordinates:function(matrix,coords,change){var point=this._point,handleIn=change&&this._handleIn.isZero()?null:this._handleIn,handleOut=change&&this._handleOut.isZero()?null:this._handleOut,x=point._x,y=point._y,i=2;return coords[0]=x,coords[1]=y,handleIn&&(coords[i++]=handleIn._x+x,coords[i++]=handleIn._y+y),handleOut&&(coords[i++]=handleOut._x+x,coords[i++]=handleOut._y+y),matrix&&(matrix._transformCoordinates(coords,0,coords,0,i/2),x=coords[0],y=coords[1],change?(point._x=x,point._y=y,i=2,handleIn&&(handleIn._x=coords[i++]-x,handleIn._y=coords[i++]-y),handleOut&&(handleOut._x=coords[i++]-x,handleOut._y=coords[i++]-y)):(handleIn||(coords[i++]=x,coords[i++]=y),handleOut||(coords[i++]=x,coords[i++]=y))),coords
}}),SegmentPoint=Point.extend({initialize:function(point,owner,key){var x,y,selected;if(point)if((x=point[0])!==undefined)y=point[1];else{var pt=point;(x=pt.x)===undefined&&(pt=Point.read(arguments),x=pt.x),y=pt.y,selected=pt.selected}else x=y=0;this._x=x,this._y=y,this._owner=owner,owner[key]=this,selected&&this.setSelected(!0)},set:function(x,y){return this._x=x,this._y=y,this._owner._changed(this),this},_serialize:function(options){var f=options.formatter,x=f.number(this._x),y=f.number(this._y);return this.isSelected()?{x:x,y:y,selected:!0}:[x,y]},getX:function(){return this._x},setX:function(x){this._x=x,this._owner._changed(this)},getY:function(){return this._y},setY:function(y){this._y=y,this._owner._changed(this)},isZero:function(){return Numerical.isZero(this._x)&&Numerical.isZero(this._y)},setSelected:function(selected){this._owner.setSelected(selected,this)},isSelected:function(){return this._owner.isSelected(this)}}),Curve=Base.extend({_class:"Curve",initialize:function(arg0,arg1,arg2,arg3,arg4,arg5,arg6,arg7){var count=arguments.length;if(3===count)this._path=arg0,this._segment1=arg1,this._segment2=arg2;else if(0===count)this._segment1=new Segment,this._segment2=new Segment;else if(1===count)this._segment1=new Segment(arg0.segment1),this._segment2=new Segment(arg0.segment2);else if(2===count)this._segment1=new Segment(arg0),this._segment2=new Segment(arg1);else{var point1,handle1,handle2,point2;4===count?(point1=arg0,handle1=arg1,handle2=arg2,point2=arg3):8===count&&(point1=[arg0,arg1],point2=[arg6,arg7],handle1=[arg2-arg0,arg3-arg1],handle2=[arg4-arg6,arg5-arg7]),this._segment1=new Segment(point1,null,handle1),this._segment2=new Segment(point2,handle2,null)}},_changed:function(){this._length=this._bounds=undefined},getPoint1:function(){return this._segment1._point},setPoint1:function(){var point=Point.read(arguments);this._segment1._point.set(point.x,point.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(){var point=Point.read(arguments);this._segment2._point.set(point.x,point.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){var point=Point.read(arguments);this._segment1._handleOut.set(point.x,point.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){var point=Point.read(arguments);this._segment2._handleIn.set(point.x,point.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var curves=this._path&&this._path._curves;return curves&&(curves[this._segment1._index+1]||this._path._closed&&curves[0])||null},getPrevious:function(){var curves=this._path&&this._path._curves;return curves&&(curves[this._segment1._index-1]||this._path._closed&&curves[curves.length-1])||null},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle2().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(selected){this.getPoint1().setSelected(selected),this.getHandle1().setSelected(selected),this.getHandle2().setSelected(selected),this.getPoint2().setSelected(selected)},getValues:function(matrix){return Curve.getValues(this._segment1,this._segment2,matrix)},getPoints:function(){for(var coords=this.getValues(),points=[],i=0;8>i;i+=2)points.push(new Point(coords[i],coords[i+1]));return points},getLength:function(){return null==this._length&&(this._length=this.isLinear()?this._segment2._point.getDistance(this._segment1._point):Curve.getLength(this.getValues(),0,1)),this._length},getArea:function(){return Curve.getArea(this.getValues())},getPart:function(from,to){return new Curve(Curve.getPart(this.getValues(),from,to))},getPartLength:function(from,to){return Curve.getLength(this.getValues(),from,to)},isLinear:function(){return this._segment1._handleOut.isZero()&&this._segment2._handleIn.isZero()},isHorizontal:function(){return this.isLinear()&&Numerical.isZero(this._segment1._point._y-this._segment2._point._y)},getIntersections:function(curve){return Curve.getIntersections(this.getValues(),curve.getValues(),this,curve,[])},_getParameter:function(offset,isParameter){return isParameter?offset:offset&&offset.curve===this?offset.parameter:offset===undefined&&isParameter===undefined?.5:this.getParameterAt(offset,0)},divide:function(offset,isParameter,ignoreLinear){var parameter=this._getParameter(offset,isParameter),tolerance=1e-5,res=null;if(parameter>tolerance&&1-tolerance>parameter){var parts=Curve.subdivide(this.getValues(),parameter),isLinear=ignoreLinear?!1:this.isLinear(),left=parts[0],right=parts[1];isLinear||(this._segment1._handleOut.set(left[2]-left[0],left[3]-left[1]),this._segment2._handleIn.set(right[4]-right[6],right[5]-right[7]));var x=left[6],y=left[7],segment=new Segment(new Point(x,y),!isLinear&&new Point(left[4]-x,left[5]-y),!isLinear&&new Point(right[2]-x,right[3]-y));if(this._path)this._segment1._index>0&&0===this._segment2._index?this._path.add(segment):this._path.insert(this._segment2._index,segment),res=this;else{var end=this._segment2;this._segment2=segment,res=new Curve(segment,end)}}return res},split:function(offset,isParameter){return this._path?this._path.split(this._segment1._index,this._getParameter(offset,isParameter)):null},reverse:function(){return new Curve(this._segment2.reverse(),this._segment1.reverse())},remove:function(){var removed=!1;if(this._path){var segment2=this._segment2,handleOut=segment2._handleOut;removed=segment2.remove(),removed&&this._segment1._handleOut.set(handleOut.x,handleOut.y)}return removed},clone:function(){return new Curve(this._segment1,this._segment2)},toString:function(){var parts=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||parts.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||parts.push("handle2: "+this._segment2._handleIn),parts.push("point2: "+this._segment2._point),"{ "+parts.join(", ")+" }"},statics:{getValues:function(segment1,segment2,matrix){var p1=segment1._point,h1=segment1._handleOut,h2=segment2._handleIn,p2=segment2._point,values=[p1._x,p1._y,p1._x+h1._x,p1._y+h1._y,p2._x+h2._x,p2._y+h2._y,p2._x,p2._y];return matrix&&matrix._transformCoordinates(values,0,values,0,6),values},evaluate:function(v,t,type){var x,y,p1x=v[0],p1y=v[1],c1x=v[2],c1y=v[3],c2x=v[4],c2y=v[5],p2x=v[6],p2y=v[7],tolerance=1e-5;if(0===type&&(tolerance>t||t>1-tolerance)){var isZero=tolerance>t;x=isZero?p1x:p2x,y=isZero?p1y:p2y}else{var cx=3*(c1x-p1x),bx=3*(c2x-c1x)-cx,ax=p2x-p1x-cx-bx,cy=3*(c1y-p1y),by=3*(c2y-c1y)-cy,ay=p2y-p1y-cy-by;if(0===type)x=((ax*t+bx)*t+cx)*t+p1x,y=((ay*t+by)*t+cy)*t+p1y;else if(tolerance>t&&c1x===p1x&&c1y===p1y||t>1-tolerance&&c2x===p2x&&c2y===p2y?(x=p2x-p1x,y=p2y-p1y):tolerance>t?(x=cx,y=cy):t>1-tolerance?(x=3*(p2x-c2x),y=3*(p2y-c2y)):(x=(3*ax*t+2*bx)*t+cx,y=(3*ay*t+2*by)*t+cy),3===type){var x2=6*ax*t+2*bx,y2=6*ay*t+2*by;return(x*y2-y*x2)/Math.pow(x*x+y*y,1.5)}}return 2===type?new Point(y,-x):new Point(x,y)},subdivide:function(v,t){var p1x=v[0],p1y=v[1],c1x=v[2],c1y=v[3],c2x=v[4],c2y=v[5],p2x=v[6],p2y=v[7];t===undefined&&(t=.5);var u=1-t,p3x=u*p1x+t*c1x,p3y=u*p1y+t*c1y,p4x=u*c1x+t*c2x,p4y=u*c1y+t*c2y,p5x=u*c2x+t*p2x,p5y=u*c2y+t*p2y,p6x=u*p3x+t*p4x,p6y=u*p3y+t*p4y,p7x=u*p4x+t*p5x,p7y=u*p4y+t*p5y,p8x=u*p6x+t*p7x,p8y=u*p6y+t*p7y;return[[p1x,p1y,p3x,p3y,p6x,p6y,p8x,p8y],[p8x,p8y,p7x,p7y,p5x,p5y,p2x,p2y]]},solveCubic:function(v,coord,val,roots,min,max){var p1=v[coord],c1=v[coord+2],c2=v[coord+4],p2=v[coord+6],c=3*(c1-p1),b=3*(c2-c1)-c,a=p2-p1-c-b;return Numerical.solveCubic(a,b,c,p1-val,roots,min,max)},getParameterOf:function(v,x,y){var tolerance=1e-5;if(Math.abs(v[0]-x)<tolerance&&Math.abs(v[1]-y)<tolerance)return 0;if(Math.abs(v[6]-x)<tolerance&&Math.abs(v[7]-y)<tolerance)return 1;for(var tx,ty,txs=[],tys=[],sx=Curve.solveCubic(v,0,x,txs),sy=Curve.solveCubic(v,1,y,tys),cx=0;-1==sx||sx>cx;)if(-1==sx||(tx=txs[cx++])>=0&&1>=tx){for(var cy=0;-1==sy||sy>cy;)if((-1==sy||(ty=tys[cy++])>=0&&1>=ty)&&(-1==sx?tx=ty:-1==sy&&(ty=tx),Math.abs(tx-ty)<tolerance))return.5*(tx+ty);if(-1==sx)break}return null},getPart:function(v,from,to){return from>0&&(v=Curve.subdivide(v,from)[1]),1>to&&(v=Curve.subdivide(v,(to-from)/(1-from))[0]),v},isLinear:function(v){var isZero=Numerical.isZero;return isZero(v[0]-v[2])&&isZero(v[1]-v[3])&&isZero(v[4]-v[6])&&isZero(v[5]-v[7])},isFlatEnough:function(v,tolerance){var p1x=v[0],p1y=v[1],c1x=v[2],c1y=v[3],c2x=v[4],c2y=v[5],p2x=v[6],p2y=v[7],ux=3*c1x-2*p1x-p2x,uy=3*c1y-2*p1y-p2y,vx=3*c2x-2*p2x-p1x,vy=3*c2y-2*p2y-p1y;return Math.max(ux*ux,vx*vx)+Math.max(uy*uy,vy*vy)<10*tolerance*tolerance},getArea:function(v){var p1x=v[0],p1y=v[1],c1x=v[2],c1y=v[3],c2x=v[4],c2y=v[5],p2x=v[6],p2y=v[7];return(3*c1y*p1x-1.5*c1y*c2x-1.5*c1y*p2x-3*p1y*c1x-1.5*p1y*c2x-.5*p1y*p2x+1.5*c2y*p1x+1.5*c2y*c1x-3*c2y*p2x+.5*p2y*p1x+1.5*p2y*c1x+3*p2y*c2x)/10},getBounds:function(v){for(var min=v.slice(0,2),max=min.slice(),roots=[0,0],i=0;2>i;i++)Curve._addBounds(v[i],v[i+2],v[i+4],v[i+6],i,0,min,max,roots);return new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1])},_addBounds:function(v0,v1,v2,v3,coord,padding,min,max,roots){function add(value,padding){var left=value-padding,right=value+padding;left<min[coord]&&(min[coord]=left),right>max[coord]&&(max[coord]=right)}var a=3*(v1-v2)-v0+v3,b=2*(v0+v2)-4*v1,c=v1-v0,count=Numerical.solveQuadratic(a,b,c,roots),tMin=1e-5,tMax=1-tMin;add(v3,0);for(var i=0;count>i;i++){var t=roots[i],u=1-t;t>tMin&&tMax>t&&add(u*u*u*v0+3*u*u*t*v1+3*u*t*t*v2+t*t*t*v3,padding)}}}},Base.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(name){this[name]=function(){this._bounds||(this._bounds={});var bounds=this._bounds[name];return bounds||(bounds=this._bounds[name]=Path[name]([this._segment1,this._segment2],!1,this._path.getStyle())),bounds.clone()}},{}),Base.each(["getPoint","getTangent","getNormal","getCurvature"],function(name,index){this[name+"At"]=function(offset,isParameter){var values=this.getValues();return Curve.evaluate(values,isParameter?offset:Curve.getParameterAt(values,offset,0),index)},this[name]=function(parameter){return Curve.evaluate(this.getValues(),parameter,index)}},{getParameterAt:function(offset,start){return Curve.getParameterAt(this.getValues(),offset,start!==undefined?start:0>offset?1:0)},getParameterOf:function(point){var point=Point.read(arguments);return Curve.getParameterOf(this.getValues(),point.x,point.y)},getLocationAt:function(offset,isParameter){return isParameter||(offset=this.getParameterAt(offset)),new CurveLocation(this,offset)},getLocationOf:function(point){var point=Point.read(arguments),t=this.getParameterOf(point);return null!=t?new CurveLocation(this,t):null},getNearestLocation:function(point){function refine(t){if(t>=0&&1>=t){var dist=point.getDistance(Curve.evaluate(values,t,0),!0);if(minDist>dist)return minDist=dist,minT=t,!0}}for(var point=Point.read(arguments),values=this.getValues(),count=100,minDist=1/0,minT=0,i=0;count>=i;i++)refine(i/count);for(var step=1/(2*count);step>1e-5;)refine(minT-step)||refine(minT+step)||(step/=2);var pt=Curve.evaluate(values,minT,0);return new CurveLocation(this,minT,pt,null,null,null,point.getDistance(pt))},getNearestPoint:function(point){var point=Point.read(arguments);return this.getNearestLocation(point).getPoint()}}),new function(){function getLengthIntegrand(v){var p1x=v[0],p1y=v[1],c1x=v[2],c1y=v[3],c2x=v[4],c2y=v[5],p2x=v[6],p2y=v[7],ax=9*(c1x-c2x)+3*(p2x-p1x),bx=6*(p1x+c2x)-12*c1x,cx=3*(c1x-p1x),ay=9*(c1y-c2y)+3*(p2y-p1y),by=6*(p1y+c2y)-12*c1y,cy=3*(c1y-p1y);return function(t){var dx=(ax*t+bx)*t+cx,dy=(ay*t+by)*t+cy;return Math.sqrt(dx*dx+dy*dy)}}function getIterations(a,b){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(b-a))))}return{statics:!0,getLength:function(v,a,b){a===undefined&&(a=0),b===undefined&&(b=1);var isZero=Numerical.isZero;if(0===a&&1===b&&isZero(v[0]-v[2])&&isZero(v[1]-v[3])&&isZero(v[6]-v[4])&&isZero(v[7]-v[5])){var dx=v[6]-v[0],dy=v[7]-v[1];return Math.sqrt(dx*dx+dy*dy)}var ds=getLengthIntegrand(v);return Numerical.integrate(ds,a,b,getIterations(a,b))},getParameterAt:function(v,offset,start){function f(t){var count=getIterations(start,t);return length+=t>start?Numerical.integrate(ds,start,t,count):-Numerical.integrate(ds,t,start,count),start=t,length-offset}if(0===offset)return start;var forward=offset>0,a=forward?start:0,b=forward?1:start,offset=Math.abs(offset),ds=getLengthIntegrand(v),rangeLength=Numerical.integrate(ds,a,b,getIterations(a,b));if(offset>=rangeLength)return forward?b:a;var guess=offset/rangeLength,length=0;return Numerical.findRoot(f,ds,forward?a+guess:b-guess,a,b,16,1e-5)}}},new function(){function addLocation(locations,include,curve1,t1,point1,curve2,t2,point2){var loc=new CurveLocation(curve1,t1,point1,curve2,t2,point2);(!include||include(loc))&&locations.push(loc)}function addCurveIntersections(v1,v2,curve1,curve2,locations,include,tMin,tMax,uMin,uMax,oldTDiff,reverse,recursion){if(!(recursion>20)){var tMinNew,tMaxNew,tDiff,q0x=v2[0],q0y=v2[1],q3x=v2[6],q3y=v2[7],tolerance=1e-5,hullEpsilon=1e-9,getSignedDistance=Line.getSignedDistance,d1=getSignedDistance(q0x,q0y,q3x,q3y,v2[2],v2[3])||0,d2=getSignedDistance(q0x,q0y,q3x,q3y,v2[4],v2[5])||0,factor=d1*d2>0?.75:4/9,dMin=factor*Math.min(0,d1,d2),dMax=factor*Math.max(0,d1,d2),dp0=getSignedDistance(q0x,q0y,q3x,q3y,v1[0],v1[1]),dp1=getSignedDistance(q0x,q0y,q3x,q3y,v1[2],v1[3]),dp2=getSignedDistance(q0x,q0y,q3x,q3y,v1[4],v1[5]),dp3=getSignedDistance(q0x,q0y,q3x,q3y,v1[6],v1[7]);if(q0x===q3x&&hullEpsilon>=uMax-uMin&&recursion>3)tMinNew=(tMax+tMin)/2,tMaxNew=tMinNew,tDiff=0;else{var tMinClip,tMaxClip,hull=getConvexHull(dp0,dp1,dp2,dp3),top=hull[0],bottom=hull[1];if(tMinClip=clipConvexHull(top,bottom,dMin,dMax),top.reverse(),bottom.reverse(),tMaxClip=clipConvexHull(top,bottom,dMin,dMax),null==tMinClip||null==tMaxClip)return!1;v1=Curve.getPart(v1,tMinClip,tMaxClip),tDiff=tMaxClip-tMinClip,tMinNew=tMax*tMinClip+tMin*(1-tMinClip),tMaxNew=tMax*tMaxClip+tMin*(1-tMaxClip)}if(oldTDiff>.8&&tDiff>.8)if(tMaxNew-tMinNew>uMax-uMin){var parts=Curve.subdivide(v1,.5),t=tMinNew+(tMaxNew-tMinNew)/2;addCurveIntersections(v2,parts[0],curve2,curve1,locations,include,uMin,uMax,tMinNew,t,tDiff,!reverse,++recursion),addCurveIntersections(v2,parts[1],curve2,curve1,locations,include,uMin,uMax,t,tMaxNew,tDiff,!reverse,recursion)}else{var parts=Curve.subdivide(v2,.5),t=uMin+(uMax-uMin)/2;addCurveIntersections(parts[0],v1,curve2,curve1,locations,include,uMin,t,tMinNew,tMaxNew,tDiff,!reverse,++recursion),addCurveIntersections(parts[1],v1,curve2,curve1,locations,include,t,uMax,tMinNew,tMaxNew,tDiff,!reverse,recursion)}else if(Math.max(uMax-uMin,tMaxNew-tMinNew)<tolerance){var t1=tMinNew+(tMaxNew-tMinNew)/2,t2=uMin+(uMax-uMin)/2;reverse?addLocation(locations,include,curve2,t2,Curve.evaluate(v2,t2,0),curve1,t1,Curve.evaluate(v1,t1,0)):addLocation(locations,include,curve1,t1,Curve.evaluate(v1,t1,0),curve2,t2,Curve.evaluate(v2,t2,0))}else addCurveIntersections(v2,v1,curve2,curve1,locations,include,uMin,uMax,tMinNew,tMaxNew,tDiff,!reverse,++recursion)}}function getConvexHull(dq0,dq1,dq2,dq3){var hull,p0=[0,dq0],p1=[1/3,dq1],p2=[2/3,dq2],p3=[1,dq3],getSignedDistance=Line.getSignedDistance,dist1=getSignedDistance(0,dq0,1,dq3,1/3,dq1),dist2=getSignedDistance(0,dq0,1,dq3,2/3,dq2),flip=!1;if(0>dist1*dist2)hull=[[p0,p1,p3],[p0,p2,p3]],flip=0>dist1;else{var pmax,cross=0,distZero=0===dist1||0===dist2;Math.abs(dist1)>Math.abs(dist2)?(pmax=p1,cross=(dq3-dq2-(dq3-dq0)/3)*(2*(dq3-dq2)-dq3+dq1)/3):(pmax=p2,cross=(dq1-dq0+(dq0-dq3)/3)*(-2*(dq0-dq1)+dq0-dq2)/3),hull=0>cross||distZero?[[p0,pmax,p3],[p0,p3]]:[[p0,p1,p2,p3],[p0,p3]],flip=dist1?0>dist1:0>dist2}return flip?hull.reverse():hull}function clipConvexHull(hullTop,hullBottom,dMin,dMax){for(var tProxy,px,py,qx,qy,tVal=null,i=0,l=hullBottom.length-1;l>i;i++){if(py=hullBottom[i][1],qy=hullBottom[i+1][1],qy>py)tProxy=null;else{if(!(dMax>=qy))continue;px=hullBottom[i][0],qx=hullBottom[i+1][0],tProxy=px+(dMax-py)*(qx-px)/(qy-py)}break}hullTop[0][1]<=dMax&&(tProxy=hullTop[0][0]);for(var i=0,l=hullTop.length-1;l>i;i++){if(py=hullTop[i][1],qy=hullTop[i+1][1],py>=dMin)tVal=tProxy;else if(py>qy)tVal=null;else{if(!(qy>=dMin))continue;px=hullTop[i][0],qx=hullTop[i+1][0],tVal=px+(dMin-py)*(qx-px)/(qy-py)}break}return tVal}function addCurveLineIntersections(v1,v2,curve1,curve2,locations,include){for(var flip=Curve.isLinear(v1),vc=flip?v2:v1,vl=flip?v1:v2,lx1=vl[0],ly1=vl[1],lx2=vl[6],ly2=vl[7],ldx=lx2-lx1,ldy=ly2-ly1,angle=Math.atan2(-ldy,ldx),sin=Math.sin(angle),cos=Math.cos(angle),rlx2=ldx*cos-ldy*sin,rvl=[0,0,0,0,rlx2,0,rlx2,0],rvc=[],i=0;8>i;i+=2){var x=vc[i]-lx1,y=vc[i+1]-ly1;rvc.push(x*cos-y*sin,y*cos+x*sin)}for(var roots=[],count=Curve.solveCubic(rvc,1,0,roots,0,1),i=0;count>i;i++){var tc=roots[i],x=Curve.evaluate(rvc,tc,0).x;if(x>=0&&rlx2>=x){var tl=Curve.getParameterOf(rvl,x,0),t1=flip?tl:tc,t2=flip?tc:tl;addLocation(locations,include,curve1,t1,Curve.evaluate(v1,t1,0),curve2,t2,Curve.evaluate(v2,t2,0))}}}function addLineIntersection(v1,v2,curve1,curve2,locations,include){var point=Line.intersect(v1[0],v1[1],v1[6],v1[7],v2[0],v2[1],v2[6],v2[7]);if(point){var x=point.x,y=point.y;addLocation(locations,include,curve1,Curve.getParameterOf(v1,x,y),point,curve2,Curve.getParameterOf(v2,x,y),point)}}return{statics:{getIntersections:function(v1,v2,curve1,curve2,locations,include){var linear1=Curve.isLinear(v1),linear2=Curve.isLinear(v2);return(linear1&&linear2?addLineIntersection:linear1||linear2?addCurveLineIntersections:addCurveIntersections)(v1,v2,curve1,curve2,locations,include,0,1,0,1,0,!1,0),locations}}}}),CurveLocation=Base.extend({_class:"CurveLocation",beans:!0,initialize:function CurveLocation(curve,parameter,point,_curve2,_parameter2,_point2,_distance){this._id=CurveLocation._id=(CurveLocation._id||0)+1,this._curve=curve,this._segment1=curve._segment1,this._segment2=curve._segment2,this._parameter=parameter,this._point=point,this._curve2=_curve2,this._parameter2=_parameter2,this._point2=_point2,this._distance=_distance},getSegment:function(_preferFirst){if(!this._segment){var curve=this.getCurve(),parameter=this.getParameter();if(1===parameter)this._segment=curve._segment2;else if(0===parameter||_preferFirst)this._segment=curve._segment1;else{if(null==parameter)return null;this._segment=curve.getPartLength(0,parameter)<curve.getPartLength(parameter,1)?curve._segment1:curve._segment2}}return this._segment},getCurve:function(_uncached){return(!this._curve||_uncached)&&(this._curve=this._segment1.getCurve(),null==this._curve.getParameterOf(this._point)&&(this._curve=this._segment2.getPrevious().getCurve())),this._curve},getIntersection:function(){var intersection=this._intersection;if(!intersection&&this._curve2){var param=this._parameter2;this._intersection=intersection=new CurveLocation(this._curve2,param,this._point2||this._point,this),intersection._intersection=this}return intersection},getPath:function(){var curve=this.getCurve();return curve&&curve._path},getIndex:function(){var curve=this.getCurve();return curve&&curve.getIndex()},getOffset:function(){var path=this.getPath();return path&&path._getOffset(this)},getCurveOffset:function(){var curve=this.getCurve(),parameter=this.getParameter();return null!=parameter&&curve&&curve.getPartLength(0,parameter)},getParameter:function(_uncached){if((null==this._parameter||_uncached)&&this._point){var curve=this.getCurve(_uncached&&this._point);this._parameter=curve&&curve.getParameterOf(this._point)}return this._parameter},getPoint:function(_uncached){if((!this._point||_uncached)&&null!=this._parameter){var curve=this.getCurve();this._point=curve&&curve.getPointAt(this._parameter,!0)}return this._point},getTangent:function(){var parameter=this.getParameter(),curve=this.getCurve();return null!=parameter&&curve&&curve.getTangentAt(parameter,!0)},getNormal:function(){var parameter=this.getParameter(),curve=this.getCurve();return null!=parameter&&curve&&curve.getNormalAt(parameter,!0)},getDistance:function(){return this._distance},divide:function(){var curve=this.getCurve(!0);return curve&&curve.divide(this.getParameter(!0),!0)},split:function(){var curve=this.getCurve(!0);return curve&&curve.split(this.getParameter(!0),!0)},equals:function(loc){var isZero=Numerical.isZero;return this===loc||loc&&this._curve===loc._curve&&this._curve2===loc._curve2&&isZero(this._parameter-loc._parameter)&&isZero(this._parameter2-loc._parameter2)||!1},toString:function(){var parts=[],point=this.getPoint(),f=Formatter.instance;point&&parts.push("point: "+point);var index=this.getIndex();null!=index&&parts.push("index: "+index);var parameter=this.getParameter();return null!=parameter&&parts.push("parameter: "+f.number(parameter)),null!=this._distance&&parts.push("distance: "+f.number(this._distance)),"{ "+parts.join(", ")+" }"}}),PathItem=Item.extend({_class:"PathItem",initialize:function(){},getIntersections:function(path,_expand){function compare(loc1,loc2){var path1=loc1.getPath(),path2=loc2.getPath();return path1===path2?loc1.getIndex()+loc1.getParameter()-(loc2.getIndex()+loc2.getParameter()):path1._id-path2._id}if(this===path&&(path=null),path&&!this.getBounds().touches(path.getBounds()))return[];for(var locations=[],curves1=this.getCurves(),curves2=path?path.getCurves():curves1,matrix1=this._matrix.orNullIfIdentity(),matrix2=path?path._matrix.orNullIfIdentity():matrix1,length1=curves1.length,length2=path?curves2.length:length1,values2=[],MIN=1e-11,MAX=1-1e-11,i=0;length2>i;i++)values2[i]=curves2[i].getValues(matrix2);for(var i=0;length1>i;i++){var curve1=curves1[i],values1=path?curve1.getValues(matrix1):values2[i];if(!path){var seg1=curve1.getSegment1(),seg2=curve1.getSegment2(),h1=seg1._handleOut,h2=seg2._handleIn;if(new Line(seg1._point.subtract(h1),h1.multiply(2),!0).intersect(new Line(seg2._point.subtract(h2),h2.multiply(2),!0),!1)){var parts=Curve.subdivide(values1);Curve.getIntersections(parts[0],parts[1],curve1,curve1,locations,function(loc){return loc._parameter<=MAX?(loc._parameter/=2,loc._parameter2=.5+loc._parameter2/2,!0):void 0})}}for(var j=path?0:i+1;length2>j;j++)Curve.getIntersections(values1,values2[j],curve1,curves2[j],locations,!path&&(j===i+1||j===length2-1&&0===i)&&function(loc){var t=loc._parameter;return t>=MIN&&MAX>=t})}for(var last=locations.length-1,i=last;i>=0;i--){var loc=locations[i],next=loc._curve.getNext(),next2=loc._curve2.getNext();next&&loc._parameter>=MAX&&(loc._parameter=0,loc._curve=next),next2&&loc._parameter2>=MAX&&(loc._parameter2=0,loc._curve2=next2)}if(last>0){locations.sort(compare);for(var i=last;i>=0;i--)locations[i].equals(locations[0===i?last:i-1])&&(locations.splice(i,1),last--)}if(_expand){for(var i=last;i>=0;i--)locations.push(locations[i].getIntersection());locations.sort(compare)}return locations},setPathData:function(data){function getCoord(index,coord){var val=+coords[index];return relative&&(val+=current[coord]),val}function getPoint(index){return new Point(getCoord(index,"x"),getCoord(index+1,"y"))}var coords,previous,control,parts=data.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),relative=!1,current=new Point,start=new Point;this.clear();for(var i=0,l=parts.length;l>i;i++){var part=parts[i],command=part[0],lower=command.toLowerCase();coords=part.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var length=coords&&coords.length;switch(relative=command===lower,"z"!==previous||/[mz]/.test(lower)||this.moveTo(current=start),lower){case"m":case"l":var move="m"===lower;move&&previous&&"z"!==previous&&this.closePath(!0);for(var j=0;length>j;j+=2)this[0===j&&move?"moveTo":"lineTo"](current=getPoint(j));control=current,move&&(start=current);break;case"h":case"v":for(var coord="h"===lower?"x":"y",j=0;length>j;j++)current[coord]=getCoord(j,coord),this.lineTo(current);control=current;break;case"c":for(var j=0;length>j;j+=6)this.cubicCurveTo(getPoint(j),control=getPoint(j+2),current=getPoint(j+4));break;case"s":for(var j=0;length>j;j+=4)this.cubicCurveTo(/[cs]/.test(previous)?current.multiply(2).subtract(control):current,control=getPoint(j),current=getPoint(j+2)),previous=lower;break;case"q":for(var j=0;length>j;j+=4)this.quadraticCurveTo(control=getPoint(j),current=getPoint(j+2));break;case"t":for(var j=0;length>j;j+=2)this.quadraticCurveTo(control=/[qt]/.test(previous)?current.multiply(2).subtract(control):current,current=getPoint(j)),previous=lower;break;case"a":for(var j=0;length>j;j+=7)this.arcTo(current=getPoint(j+5),new Size(+coords[0],+coords[1]),+coords[2],+coords[4],+coords[3]);break;case"z":this.closePath(!0)}previous=lower}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(point){var winding=this._getWinding(point,!1,!0);return!!("evenodd"===this.getWindingRule()?1&winding:winding)}}),Path=PathItem.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(arg){this._closed=!1,this._segments=[];var segments=Array.isArray(arg)?"object"==typeof arg[0]?arg:arguments:!arg||arg.size!==undefined||arg.x===undefined&&arg.point===undefined?null:arguments;segments&&segments.length>0?this.setSegments(segments):(this._curves=undefined,this._selectedSegmentState=0,segments||"string"!=typeof arg||(this.setPathData(arg),arg=null)),this._initialize(!segments&&arg)},_equals:function(item){return Base.equals(this._segments,item._segments)},clone:function(insert){var copy=new Path(Item.NO_INSERT);return copy.setSegments(this._segments),copy._closed=this._closed,this._clockwise!==undefined&&(copy._clockwise=this._clockwise),this._clone(copy,insert)},_changed:function _changed(flags){if(_changed.base.call(this,flags),8&flags){var parent=this._parent;if(parent&&(parent._currentPath=undefined),this._length=this._clockwise=undefined,this._curves&&!(16&flags))for(var i=0,l=this._curves.length;l>i;i++)this._curves[i]._changed();this._monoCurves=undefined}else 32&flags&&(this._bounds=undefined)},getStyle:function(){var parent=this._parent;return(parent instanceof CompoundPath?parent:this)._style},getSegments:function(){return this._segments},setSegments:function(segments){var fullySelected=this.isFullySelected();this._segments.length=0,this._selectedSegmentState=0,this._curves=undefined,segments&&segments.length>0&&this._add(Segment.readAll(segments)),fullySelected&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var curves=this._curves,segments=this._segments;if(!curves){var length=this._countCurves();curves=this._curves=new Array(length);for(var i=0;length>i;i++)curves[i]=new Curve(this,segments[i],segments[i+1]||segments[0])}return curves},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var curves=this.getCurves();return curves[curves.length-1]},isClosed:function(){return this._closed},setClosed:function(closed){if(this._closed!=(closed=!!closed)){if(this._closed=closed,this._curves){var length=this._curves.length=this._countCurves();closed&&(this._curves[length-1]=new Curve(this,this._segments[length-1],this._segments[0]))}this._changed(25)}}},{beans:!0,getPathData:function(_precision){function addCurve(seg1,seg2,skipLine){var point1=seg1._point,point2=seg2._point,handle1=seg1._handleOut,handle2=seg2._handleIn;if(handle1.isZero()&&handle2.isZero())skipLine||parts.push("L"+f.point(point2,_precision));else{var end=point2.subtract(point1);parts.push("c"+f.point(handle1,_precision)+" "+f.point(end.add(handle2),_precision)+" "+f.point(end,_precision))}}var segments=this._segments,f=Formatter.instance,parts=[];if(0===segments.length)return"";parts.push("M"+f.point(segments[0]._point));for(var i=0,l=segments.length-1;l>i;i++)addCurve(segments[i],segments[i+1],!1);return this._closed&&(addCurve(segments[segments.length-1],segments[0],!0),parts.push("z")),parts.join("")}},{isEmpty:function(){return 0===this._segments.length},isPolygon:function(){for(var i=0,l=this._segments.length;l>i;i++)if(!this._segments[i].isLinear())return!1;return!0},_transformContent:function(matrix){for(var coords=new Array(6),i=0,l=this._segments.length;l>i;i++)this._segments[i]._transformCoordinates(matrix,coords,!0);return!0},_add:function(segs,index){for(var segments=this._segments,curves=this._curves,amount=segs.length,append=null==index,index=append?segments.length:index,i=0;amount>i;i++){var segment=segs[i];segment._path&&(segment=segs[i]=segment.clone()),segment._path=this,segment._index=index+i,segment._selectionState&&this._updateSelection(segment,0,segment._selectionState)}if(append)segments.push.apply(segments,segs);else{segments.splice.apply(segments,[index,0].concat(segs));for(var i=index+amount,l=segments.length;l>i;i++)segments[i]._index=i}if(curves||segs._curves){curves||(curves=this._curves=[]);var from=index>0?index-1:index,start=from,to=Math.min(from+amount,this._countCurves());segs._curves&&(curves.splice.apply(curves,[from,0].concat(segs._curves)),start+=segs._curves.length);for(var i=start;to>i;i++)curves.splice(i,0,new Curve(this,null,null));this._adjustCurves(from,to)}return this._changed(25),segs},_adjustCurves:function(from,to){for(var curve,segments=this._segments,curves=this._curves,i=from;to>i;i++)curve=curves[i],curve._path=this,curve._segment1=segments[i],curve._segment2=segments[i+1]||segments[0];(curve=curves[this._closed&&0===from?segments.length-1:from-1])&&(curve._segment2=segments[from]||segments[0]),(curve=curves[to])&&(curve._segment1=segments[to])},_countCurves:function(){var length=this._segments.length;return!this._closed&&length>0?length-1:length},add:function(segment1){return arguments.length>1&&"number"!=typeof segment1?this._add(Segment.readAll(arguments)):this._add([Segment.read(arguments)])[0]},insert:function(index,segment1){return arguments.length>2&&"number"!=typeof segment1?this._add(Segment.readAll(arguments,1),index):this._add([Segment.read(arguments,1)],index)[0]},addSegment:function(){return this._add([Segment.read(arguments)])[0]},insertSegment:function(index){return this._add([Segment.read(arguments,1)],index)[0]},addSegments:function(segments){return this._add(Segment.readAll(segments))},insertSegments:function(index,segments){return this._add(Segment.readAll(segments),index)},removeSegment:function(index){return this.removeSegments(index,index+1)[0]||null},removeSegments:function(from,to,_includeCurves){from=from||0,to=Base.pick(to,this._segments.length);var segments=this._segments,curves=this._curves,count=segments.length,removed=segments.splice(from,to-from),amount=removed.length;if(!amount)return removed;for(var i=0;amount>i;i++){var segment=removed[i];segment._selectionState&&this._updateSelection(segment,segment._selectionState,0),segment._index=segment._path=null}for(var i=from,l=segments.length;l>i;i++)segments[i]._index=i;if(curves){var index=from>0&&to===count+(this._closed?1:0)?from-1:from,curves=curves.splice(index,amount);_includeCurves&&(removed._curves=curves.slice(1)),this._adjustCurves(index,index)}return this._changed(25),removed},clear:"#removeSegments",isFullySelected:function(){var length=this._segments.length;return this._selected&&length>0&&this._selectedSegmentState===7*length},setFullySelected:function(selected){selected&&this._selectSegments(!0),this.setSelected(selected)},setSelected:function setSelected(selected){selected||this._selectSegments(!1),setSelected.base.call(this,selected)},_selectSegments:function(selected){var length=this._segments.length;this._selectedSegmentState=selected?7*length:0;for(var i=0;length>i;i++)this._segments[i]._selectionState=selected?7:0},_updateSelection:function(segment,oldState,newState){segment._selectionState=newState;var total=this._selectedSegmentState+=newState-oldState;total>0&&this.setSelected(!0)},flatten:function(maxDistance){for(var flattener=new PathFlattener(this),pos=0,step=flattener.length/Math.ceil(flattener.length/maxDistance),end=flattener.length+(this._closed?-step:step)/2,segments=[];end>=pos;)segments.push(new Segment(flattener.evaluate(pos,0))),pos+=step;
this.setSegments(segments)},reduce:function(){for(var curves=this.getCurves(),i=curves.length-1;i>=0;i--){var curve=curves[i];curve.isLinear()&&0===curve.getLength()&&curve.remove()}return this},simplify:function(tolerance){if(this._segments.length>2){var fitter=new PathFitter(this,tolerance||2.5);this.setSegments(fitter.fit())}},split:function(index,parameter){if(null!==parameter){if(1===arguments.length){var arg=index;"number"==typeof arg&&(arg=this.getLocationAt(arg)),index=arg.index,parameter=arg.parameter}var tolerance=1e-5;parameter>=1-tolerance&&(index++,parameter--);var curves=this.getCurves();if(index>=0&&index<curves.length){parameter>tolerance&&curves[index++].divide(parameter,!0);var path,segs=this.removeSegments(index,this._segments.length,!0);return this._closed?(this.setClosed(!1),path=this):index>0&&(path=this._clone((new Path).insertAbove(this,!0))),path._add(segs,0),this.addSegment(segs[0]),path}return null}},isClockwise:function(){return this._clockwise!==undefined?this._clockwise:Path.isClockwise(this._segments)},setClockwise:function(clockwise){this.isClockwise()!=(clockwise=!!clockwise)&&this.reverse(),this._clockwise=clockwise},reverse:function(){this._segments.reverse();for(var i=0,l=this._segments.length;l>i;i++){var segment=this._segments[i],handleIn=segment._handleIn;segment._handleIn=segment._handleOut,segment._handleOut=handleIn,segment._index=i}this._curves=null,this._clockwise!==undefined&&(this._clockwise=!this._clockwise)},join:function(path){if(path){var segments=path._segments,last1=this.getLastSegment(),last2=path.getLastSegment();last1._point.equals(last2._point)&&path.reverse();var first1,first2=path.getFirstSegment();last1._point.equals(first2._point)?(last1.setHandleOut(first2._handleOut),this._add(segments.slice(1))):(first1=this.getFirstSegment(),first1._point.equals(first2._point)&&path.reverse(),last2=path.getLastSegment(),first1._point.equals(last2._point)?(first1.setHandleIn(last2._handleIn),this._add(segments.slice(0,segments.length-1),0)):this._add(segments.slice())),path.closed&&this._add([segments[0]]),path.remove()}var first=this.getFirstSegment(),last=this.getLastSegment();first!==last&&first._point.equals(last._point)&&(first.setHandleIn(last._handleIn),last.remove(),this.setClosed(!0))},getLength:function(){if(null==this._length){var curves=this.getCurves();this._length=0;for(var i=0,l=curves.length;l>i;i++)this._length+=curves[i].getLength()}return this._length},getArea:function(){for(var curves=this.getCurves(),area=0,i=0,l=curves.length;l>i;i++)area+=curves[i].getArea();return area},_getOffset:function(location){var index=location&&location.getIndex();if(null!=index){for(var curves=this.getCurves(),offset=0,i=0;index>i;i++)offset+=curves[i].getLength();var curve=curves[index],parameter=location.getParameter();return parameter>0&&(offset+=curve.getPartLength(0,parameter)),offset}return null},getLocationOf:function(point){for(var point=Point.read(arguments),curves=this.getCurves(),i=0,l=curves.length;l>i;i++){var loc=curves[i].getLocationOf(point);if(loc)return loc}return null},getLocationAt:function(offset,isParameter){var curves=this.getCurves(),length=0;if(isParameter){var index=~~offset;return curves[index].getLocationAt(offset-index,!0)}for(var i=0,l=curves.length;l>i;i++){var start=length,curve=curves[i];if(length+=curve.getLength(),length>offset)return curve.getLocationAt(offset-start)}return offset<=this.getLength()?new CurveLocation(curves[curves.length-1],1):null},getPointAt:function(offset,isParameter){var loc=this.getLocationAt(offset,isParameter);return loc&&loc.getPoint()},getTangentAt:function(offset,isParameter){var loc=this.getLocationAt(offset,isParameter);return loc&&loc.getTangent()},getNormalAt:function(offset,isParameter){var loc=this.getLocationAt(offset,isParameter);return loc&&loc.getNormal()},getNearestLocation:function(point){for(var point=Point.read(arguments),curves=this.getCurves(),minDist=1/0,minLoc=null,i=0,l=curves.length;l>i;i++){var loc=curves[i].getNearestLocation(point);loc._distance<minDist&&(minDist=loc._distance,minLoc=loc)}return minLoc},getNearestPoint:function(point){var point=Point.read(arguments);return this.getNearestLocation(point).getPoint()},toShape:function(insert){function isColinear(i,j){return segments[i].isColinear(segments[j])}function isOrthogonal(i){return segments[i].isOrthogonal()}function isArc(i){return segments[i].isArc()}function getDistance(i,j){return segments[i]._point.getDistance(segments[j]._point)}if(!this._closed)return null;var type,size,radius,topCenter,segments=this._segments;if(this.isPolygon()&&4===segments.length&&isColinear(0,2)&&isColinear(1,3)&&isOrthogonal(1)?(type=Shape.Rectangle,size=new Size(getDistance(0,3),getDistance(0,1)),topCenter=segments[1]._point.add(segments[2]._point).divide(2)):8===segments.length&&isArc(0)&&isArc(2)&&isArc(4)&&isArc(6)&&isColinear(1,5)&&isColinear(3,7)?(type=Shape.Rectangle,size=new Size(getDistance(1,6),getDistance(0,3)),radius=size.subtract(new Size(getDistance(0,7),getDistance(1,2))).divide(2),topCenter=segments[3]._point.add(segments[4]._point).divide(2)):4===segments.length&&isArc(0)&&isArc(1)&&isArc(2)&&isArc(3)&&(Numerical.isZero(getDistance(0,2)-getDistance(1,3))?(type=Shape.Circle,radius=getDistance(0,2)/2):(type=Shape.Ellipse,radius=new Size(getDistance(2,0)/2,getDistance(3,1)/2)),topCenter=segments[1]._point),type){var center=this.getPosition(!0),shape=new type({center:center,size:size,radius:radius,insert:!1});return shape.rotate(topCenter.subtract(center).getAngle()+90),shape.setStyle(this._style),(insert||insert===undefined)&&shape.insertAbove(this),shape}return null},_hitTest:function(point,options){function isCloseEnough(pt,padding){return point.subtract(pt).divide(padding).length<=1}function checkSegmentPoint(seg,pt,name){if(!options.selected||pt.isSelected()){var anchor=seg._point;if(pt!==anchor&&(pt=pt.add(anchor)),isCloseEnough(pt,strokePadding))return new HitResult(name,that,{segment:seg,point:pt})}}function checkSegmentPoints(seg,ends){return(ends||options.segments)&&checkSegmentPoint(seg,seg._point,"segment")||!ends&&options.handles&&(checkSegmentPoint(seg,seg._handleIn,"handle-in")||checkSegmentPoint(seg,seg._handleOut,"handle-out"))}function addToArea(point){area.add(point)}function checkSegmentStroke(segment){if(("round"!==join||"round"!==cap)&&(area=new Path({internal:!0,closed:!0}),closed||segment._index>0&&segment._index<numSegments-1?"round"!==join&&(segment._handleIn.isZero()||segment._handleOut.isZero())&&Path._addBevelJoin(segment,join,radius,miterLimit,addToArea,!0):"round"!==cap&&Path._addSquareCap(segment,cap,radius,addToArea,!0),!area.isEmpty())){var loc;return area.contains(point)||(loc=area.getNearestLocation(point))&&isCloseEnough(loc.getPoint(),tolerancePadding)}return isCloseEnough(segment._point,strokePadding)}var join,cap,miterLimit,area,loc,res,that=this,style=this.getStyle(),segments=this._segments,numSegments=segments.length,closed=this._closed,tolerancePadding=options._tolerancePadding,strokePadding=tolerancePadding,hasStroke=options.stroke&&style.hasStroke(),hasFill=options.fill&&style.hasFill(),radius=hasStroke?style.getStrokeWidth()/2:hasFill?0:null;if(null!=radius&&(radius>0?(join=style.getStrokeJoin(),cap=style.getStrokeCap(),miterLimit=radius*style.getMiterLimit(),strokePadding=tolerancePadding.add(new Point(radius,radius))):join=cap="round"),!options.ends||options.segments||closed){if(options.segments||options.handles)for(var i=0;numSegments>i;i++)if(res=checkSegmentPoints(segments[i]))return res}else if(res=checkSegmentPoints(segments[0],!0)||checkSegmentPoints(segments[numSegments-1],!0))return res;if(null!=radius){if(loc=this.getNearestLocation(point)){var parameter=loc.getParameter();0===parameter||1===parameter&&numSegments>1?checkSegmentStroke(loc.getSegment())||(loc=null):isCloseEnough(loc.getPoint(),strokePadding)||(loc=null)}if(!loc&&"miter"===join&&numSegments>1)for(var i=0;numSegments>i;i++){var segment=segments[i];if(point.getDistance(segment._point)<=miterLimit&&checkSegmentStroke(segment)){loc=segment.getLocation();break}}}return!loc&&hasFill&&this._contains(point)||loc&&!hasStroke?new HitResult("fill",this):loc?new HitResult("stroke",this,{location:loc,point:loc.getPoint()}):null}},new function(){function drawHandles(ctx,segments,matrix,size){function drawHandle(index){var hX=coords[index],hY=coords[index+1];(pX!=hX||pY!=hY)&&(ctx.beginPath(),ctx.moveTo(pX,pY),ctx.lineTo(hX,hY),ctx.stroke(),ctx.beginPath(),ctx.arc(hX,hY,half,0,2*Math.PI,!0),ctx.fill())}for(var half=size/2,coords=new Array(6),i=0,l=segments.length;l>i;i++){var segment=segments[i];segment._transformCoordinates(matrix,coords,!1);var state=segment._selectionState,pX=coords[0],pY=coords[1];if(1&state&&drawHandle(2),2&state&&drawHandle(4),ctx.fillRect(pX-half,pY-half,size,size),!(4&state)){var fillStyle=ctx.fillStyle;ctx.fillStyle="#ffffff",ctx.fillRect(pX-half+1,pY-half+1,size-2,size-2),ctx.fillStyle=fillStyle}}}function drawSegments(ctx,path,matrix){function drawSegment(i){var segment=segments[i];if(matrix)segment._transformCoordinates(matrix,coords,!1),curX=coords[0],curY=coords[1];else{var point=segment._point;curX=point._x,curY=point._y}if(first)ctx.moveTo(curX,curY),first=!1;else{if(matrix)inX=coords[2],inY=coords[3];else{var handle=segment._handleIn;inX=curX+handle._x,inY=curY+handle._y}inX==curX&&inY==curY&&outX==prevX&&outY==prevY?ctx.lineTo(curX,curY):ctx.bezierCurveTo(outX,outY,inX,inY,curX,curY)}if(prevX=curX,prevY=curY,matrix)outX=coords[4],outY=coords[5];else{var handle=segment._handleOut;outX=prevX+handle._x,outY=prevY+handle._y}}for(var curX,curY,prevX,prevY,inX,inY,outX,outY,segments=path._segments,length=segments.length,coords=new Array(6),first=!0,i=0;length>i;i++)drawSegment(i);path._closed&&length>0&&drawSegment(0)}return{_draw:function(ctx,param){function getOffset(i){return dashArray[(i%dashLength+dashLength)%dashLength]}var dontStart=param.dontStart,dontPaint=param.dontFinish||param.clip;dontStart||ctx.beginPath();var style=this.getStyle(),hasFill=style.hasFill(),hasStroke=style.hasStroke(),dashArray=style.getDashArray(),dashLength=!paper.support.nativeDash&&hasStroke&&dashArray&&dashArray.length;if(!dontStart&&this._currentPath?ctx.currentPath=this._currentPath:(hasFill||hasStroke&&!dashLength||dontPaint)&&(drawSegments(ctx,this),this._closed&&ctx.closePath(),dontStart||(this._currentPath=ctx.currentPath)),!dontPaint&&(hasFill||hasStroke)&&(this._setStyles(ctx),hasFill&&(ctx.fill(style.getWindingRule()),ctx.shadowColor="rgba(0,0,0,0)"),hasStroke)){if(dashLength){dontStart||ctx.beginPath();var to,flattener=new PathFlattener(this),length=flattener.length,from=-style.getDashOffset(),i=0;for(from%=length;from>0;)from-=getOffset(i--)+getOffset(i--);for(;length>from;)to=from+getOffset(i++),(from>0||to>0)&&flattener.drawPart(ctx,Math.max(from,0),Math.max(to,0)),from=to+getOffset(i++)}ctx.stroke()}},_drawSelected:function(ctx,matrix){ctx.beginPath(),drawSegments(ctx,this,matrix),ctx.stroke(),drawHandles(ctx,this._segments,matrix,paper.settings.handleSize)}}},new function(){function getFirstControlPoints(rhs){var n=rhs.length,x=[],tmp=[],b=2;x[0]=rhs[0]/b;for(var i=1;n>i;i++)tmp[i]=1/b,b=(n-1>i?4:2)-tmp[i],x[i]=(rhs[i]-x[i-1])/b;for(var i=1;n>i;i++)x[n-i-1]-=tmp[n-i]*x[n-i];return x}return{smooth:function(){var segments=this._segments,size=segments.length,closed=this._closed,n=size,overlap=0;if(!(2>=size)){closed&&(overlap=Math.min(size,4),n+=2*Math.min(size,overlap));for(var knots=[],i=0;size>i;i++)knots[i+overlap]=segments[i]._point;if(closed)for(var i=0;overlap>i;i++)knots[i]=segments[i+size-overlap]._point,knots[i+size+overlap]=segments[i]._point;else n--;for(var rhs=[],i=1;n-1>i;i++)rhs[i]=4*knots[i]._x+2*knots[i+1]._x;rhs[0]=knots[0]._x+2*knots[1]._x,rhs[n-1]=3*knots[n-1]._x;for(var x=getFirstControlPoints(rhs),i=1;n-1>i;i++)rhs[i]=4*knots[i]._y+2*knots[i+1]._y;rhs[0]=knots[0]._y+2*knots[1]._y,rhs[n-1]=3*knots[n-1]._y;var y=getFirstControlPoints(rhs);if(closed){for(var i=0,j=size;overlap>i;i++,j++){var f1=i/overlap,f2=1-f1,ie=i+overlap,je=j+overlap;x[j]=x[i]*f1+x[j]*f2,y[j]=y[i]*f1+y[j]*f2,x[je]=x[ie]*f2+x[je]*f1,y[je]=y[ie]*f2+y[je]*f1}n--}for(var handleIn=null,i=overlap;n-overlap>=i;i++){var segment=segments[i-overlap];handleIn&&segment.setHandleIn(handleIn.subtract(segment._point)),n>i&&(segment.setHandleOut(new Point(x[i],y[i]).subtract(segment._point)),handleIn=n-1>i?new Point(2*knots[i+1]._x-x[i+1],2*knots[i+1]._y-y[i+1]):new Point((knots[n]._x+x[n-1])/2,(knots[n]._y+y[n-1])/2))}if(closed&&handleIn){var segment=this._segments[0];segment.setHandleIn(handleIn.subtract(segment._point))}}}}},new function(){function getCurrentSegment(that){var segments=that._segments;if(0===segments.length)throw new Error("Use a moveTo() command first");return segments[segments.length-1]}return{moveTo:function(){var segments=this._segments;1===segments.length&&this.removeSegment(0),segments.length||this._add([new Segment(Point.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Segment(Point.read(arguments))])},cubicCurveTo:function(){var handle1=Point.read(arguments),handle2=Point.read(arguments),to=Point.read(arguments),current=getCurrentSegment(this);current.setHandleOut(handle1.subtract(current._point)),this._add([new Segment(to,handle2.subtract(to))])},quadraticCurveTo:function(){var handle=Point.read(arguments),to=Point.read(arguments),current=getCurrentSegment(this)._point;this.cubicCurveTo(handle.add(current.subtract(handle).multiply(1/3)),handle.add(to.subtract(handle).multiply(1/3)),to)},curveTo:function(){var through=Point.read(arguments),to=Point.read(arguments),t=Base.pick(Base.read(arguments),.5),t1=1-t,current=getCurrentSegment(this)._point,handle=through.subtract(current.multiply(t1*t1)).subtract(to.multiply(t*t)).divide(2*t*t1);if(handle.isNaN())throw new Error("Cannot put a curve through points with parameter = "+t);this.quadraticCurveTo(handle,to)},arcTo:function(){var through,center,extent,vector,matrix,current=getCurrentSegment(this),from=current._point,to=Point.read(arguments),peek=Base.peek(arguments),clockwise=Base.pick(peek,!0);if("boolean"==typeof clockwise)var middle=from.add(to).divide(2),through=middle.add(middle.subtract(from).rotate(clockwise?-90:90));else if(Base.remain(arguments)<=2)through=to,to=Point.read(arguments);else{var radius=Size.read(arguments);if(radius.isZero())return this.lineTo(to);var rotation=Base.read(arguments),clockwise=!!Base.read(arguments),large=!!Base.read(arguments),middle=from.add(to).divide(2),pt=from.subtract(middle).rotate(-rotation),x=pt.x,y=pt.y,abs=Math.abs,EPSILON=1e-11,rx=abs(radius.width),ry=abs(radius.height),rxSq=rx*rx,rySq=ry*ry,xSq=x*x,ySq=y*y,factor=Math.sqrt(xSq/rxSq+ySq/rySq);if(factor>1&&(rx*=factor,ry*=factor,rxSq=rx*rx,rySq=ry*ry),factor=(rxSq*rySq-rxSq*ySq-rySq*xSq)/(rxSq*ySq+rySq*xSq),abs(factor)<EPSILON&&(factor=0),0>factor)throw new Error("Cannot create an arc with the given arguments");center=new Point(rx*y/ry,-ry*x/rx).multiply((large===clockwise?-1:1)*Math.sqrt(factor)).rotate(rotation).add(middle),matrix=(new Matrix).translate(center).rotate(rotation).scale(rx,ry),vector=matrix._inverseTransform(from),extent=vector.getDirectedAngle(matrix._inverseTransform(to)),!clockwise&&extent>0?extent-=360:clockwise&&0>extent&&(extent+=360)}if(through){var l1=new Line(from.add(through).divide(2),through.subtract(from).rotate(90),!0),l2=new Line(through.add(to).divide(2),to.subtract(through).rotate(90),!0),line=new Line(from,to),throughSide=line.getSide(through);if(center=l1.intersect(l2,!0),!center){if(!throughSide)return this.lineTo(to);throw new Error("Cannot create an arc with the given arguments")}vector=from.subtract(center),extent=vector.getDirectedAngle(to.subtract(center));var centerSide=line.getSide(center);0===centerSide?extent=throughSide*Math.abs(extent):throughSide===centerSide&&(extent+=0>extent?360:-360)}for(var ext=Math.abs(extent),count=ext>=360?4:Math.ceil(ext/90),inc=extent/count,half=inc*Math.PI/360,z=4/3*Math.sin(half)/(1+Math.cos(half)),segments=[],i=0;count>=i;i++){var pt=to,out=null;if(count>i&&(out=vector.rotate(90).multiply(z),matrix?(pt=matrix._transformPoint(vector),out=matrix._transformPoint(vector.add(out)).subtract(pt)):pt=center.add(vector)),0===i)current.setHandleOut(out);else{var _in=vector.rotate(-90).multiply(z);matrix&&(_in=matrix._transformPoint(vector.add(_in)).subtract(pt)),segments.push(new Segment(pt,_in,out))}vector=vector.rotate(inc)}this._add(segments)},lineBy:function(){var to=Point.read(arguments),current=getCurrentSegment(this)._point;this.lineTo(current.add(to))},curveBy:function(){var through=Point.read(arguments),to=Point.read(arguments),parameter=Base.read(arguments),current=getCurrentSegment(this)._point;this.curveTo(current.add(through),current.add(to),parameter)},cubicCurveBy:function(){var handle1=Point.read(arguments),handle2=Point.read(arguments),to=Point.read(arguments),current=getCurrentSegment(this)._point;this.cubicCurveTo(current.add(handle1),current.add(handle2),current.add(to))},quadraticCurveBy:function(){var handle=Point.read(arguments),to=Point.read(arguments),current=getCurrentSegment(this)._point;this.quadraticCurveTo(current.add(handle),current.add(to))},arcBy:function(){var current=getCurrentSegment(this)._point,point=current.add(Point.read(arguments)),clockwise=Base.pick(Base.peek(arguments),!0);"boolean"==typeof clockwise?this.arcTo(point,clockwise):this.arcTo(point,current.add(Point.read(arguments)))},closePath:function(join){this.setClosed(!0),join&&this.join()}}},{_getBounds:function(getter,matrix){return Path[getter](this._segments,this._closed,this.getStyle(),matrix)},statics:{isClockwise:function(segments){for(var sum=0,i=0,l=segments.length;l>i;i++)for(var v=Curve.getValues(segments[i],segments[l>i+1?i+1:0]),j=2;8>j;j+=2)sum+=(v[j-2]-v[j])*(v[j+1]+v[j-1]);return sum>0},getBounds:function(segments,closed,style,matrix,strokePadding){function processSegment(segment){segment._transformCoordinates(matrix,coords,!1);for(var i=0;2>i;i++)Curve._addBounds(prevCoords[i],prevCoords[i+4],coords[i+2],coords[i],i,strokePadding?strokePadding[i]:0,min,max,roots);var tmp=prevCoords;prevCoords=coords,coords=tmp}var first=segments[0];if(!first)return new Rectangle;for(var coords=new Array(6),prevCoords=first._transformCoordinates(matrix,new Array(6),!1),min=prevCoords.slice(0,2),max=min.slice(),roots=new Array(2),i=1,l=segments.length;l>i;i++)processSegment(segments[i]);return closed&&processSegment(first),new Rectangle(min[0],min[1],max[0]-min[0],max[1]-min[1])},getStrokeBounds:function(segments,closed,style,matrix){function add(point){bounds=bounds.include(matrix?matrix._transformPoint(point,point):point)}function addRound(segment){bounds=bounds.unite(joinBounds.setCenter(matrix?matrix._transformPoint(segment._point):segment._point))}function addJoin(segment,join){var handleIn=segment._handleIn,handleOut=segment._handleOut;"round"===join||!handleIn.isZero()&&!handleOut.isZero()&&handleIn.isColinear(handleOut)?addRound(segment):Path._addBevelJoin(segment,join,radius,miterLimit,add)}function addCap(segment,cap){"round"===cap?addRound(segment):Path._addSquareCap(segment,cap,radius,add)}if(!style.hasStroke())return Path.getBounds(segments,closed,style,matrix);for(var length=segments.length-(closed?0:1),radius=style.getStrokeWidth()/2,padding=Path._getPenPadding(radius,matrix),bounds=Path.getBounds(segments,closed,style,matrix,padding),join=style.getStrokeJoin(),cap=style.getStrokeCap(),miterLimit=radius*style.getMiterLimit(),joinBounds=new Rectangle(new Size(padding).multiply(2)),i=1;length>i;i++)addJoin(segments[i],join);return closed?addJoin(segments[0],join):length>0&&(addCap(segments[0],cap),addCap(segments[segments.length-1],cap)),bounds},_getPenPadding:function(radius,matrix){if(!matrix)return[radius,radius];var mx=matrix.shiftless(),hor=mx.transform(new Point(radius,0)),ver=mx.transform(new Point(0,radius)),phi=hor.getAngleInRadians(),a=hor.getLength(),b=ver.getLength(),sin=Math.sin(phi),cos=Math.cos(phi),tan=Math.tan(phi),tx=-Math.atan(b*tan/a),ty=Math.atan(b/(tan*a));return[Math.abs(a*Math.cos(tx)*cos-b*Math.sin(tx)*sin),Math.abs(b*Math.sin(ty)*cos+a*Math.cos(ty)*sin)]},_addBevelJoin:function(segment,join,radius,miterLimit,addPoint,area){var curve2=segment.getCurve(),curve1=curve2.getPrevious(),point=curve2.getPointAt(0,!0),normal1=curve1.getNormalAt(1,!0),normal2=curve2.getNormalAt(0,!0),step=normal1.getDirectedAngle(normal2)<0?-radius:radius;if(normal1.setLength(step),normal2.setLength(step),area&&(addPoint(point),addPoint(point.add(normal1))),"miter"===join){var corner=new Line(point.add(normal1),new Point(-normal1.y,normal1.x),!0).intersect(new Line(point.add(normal2),new Point(-normal2.y,normal2.x),!0),!0);if(corner&&point.getDistance(corner)<=miterLimit&&(addPoint(corner),!area))return}area||addPoint(point.add(normal1)),addPoint(point.add(normal2))},_addSquareCap:function(segment,cap,radius,addPoint,area){var point=segment._point,loc=segment.getLocation(),normal=loc.getNormal().normalize(radius);area&&(addPoint(point.subtract(normal)),addPoint(point.add(normal))),"square"===cap&&(point=point.add(normal.rotate(0==loc.getParameter()?-90:90))),addPoint(point.add(normal)),addPoint(point.subtract(normal))},getHandleBounds:function(segments,closed,style,matrix,strokePadding,joinPadding){for(var coords=new Array(6),x1=1/0,x2=-x1,y1=x1,y2=x2,i=0,l=segments.length;l>i;i++){var segment=segments[i];segment._transformCoordinates(matrix,coords,!1);for(var j=0;6>j;j+=2){var padding=0==j?joinPadding:strokePadding,paddingX=padding?padding[0]:0,paddingY=padding?padding[1]:0,x=coords[j],y=coords[j+1],xn=x-paddingX,xx=x+paddingX,yn=y-paddingY,yx=y+paddingY;x1>xn&&(x1=xn),xx>x2&&(x2=xx),y1>yn&&(y1=yn),yx>y2&&(y2=yx)}}return new Rectangle(x1,y1,x2-x1,y2-y1)},getRoughBounds:function(segments,closed,style,matrix){var strokeRadius=style.hasStroke()?style.getStrokeWidth()/2:0,joinRadius=strokeRadius;return strokeRadius>0&&("miter"===style.getStrokeJoin()&&(joinRadius=strokeRadius*style.getMiterLimit()),"square"===style.getStrokeCap()&&(joinRadius=Math.max(joinRadius,strokeRadius*Math.sqrt(2)))),Path.getHandleBounds(segments,closed,style,matrix,Path._getPenPadding(strokeRadius,matrix),Path._getPenPadding(joinRadius,matrix))}}});Path.inject({statics:new function(){function createPath(segments,closed,args){var props=Base.getNamed(args),path=new Path(props&&props.insert===!1&&Item.NO_INSERT);return path._add(segments),path._closed=closed,path.set(props)}function createEllipse(center,radius,args){for(var segments=new Array(4),i=0;4>i;i++){var segment=ellipseSegments[i];segments[i]=new Segment(segment._point.multiply(radius).add(center),segment._handleIn.multiply(radius),segment._handleOut.multiply(radius))}return createPath(segments,!0,args)}var kappa=.5522847498307936,ellipseSegments=[new Segment([-1,0],[0,kappa],[0,-kappa]),new Segment([0,-1],[-kappa,0],[kappa,0]),new Segment([1,0],[0,-kappa],[0,kappa]),new Segment([0,1],[kappa,0],[-kappa,0])];return{Line:function(){return createPath([new Segment(Point.readNamed(arguments,"from")),new Segment(Point.readNamed(arguments,"to"))],!1,arguments)},Circle:function(){var center=Point.readNamed(arguments,"center"),radius=Base.readNamed(arguments,"radius");return createEllipse(center,new Size(radius),arguments)},Rectangle:function(){var segments,rect=Rectangle.readNamed(arguments,"rectangle"),radius=Size.readNamed(arguments,"radius",0,{readNull:!0}),bl=rect.getBottomLeft(!0),tl=rect.getTopLeft(!0),tr=rect.getTopRight(!0),br=rect.getBottomRight(!0);if(!radius||radius.isZero())segments=[new Segment(bl),new Segment(tl),new Segment(tr),new Segment(br)];else{radius=Size.min(radius,rect.getSize(!0).divide(2));var rx=radius.width,ry=radius.height,hx=rx*kappa,hy=ry*kappa;segments=[new Segment(bl.add(rx,0),null,[-hx,0]),new Segment(bl.subtract(0,ry),[0,hy]),new Segment(tl.add(0,ry),null,[0,-hy]),new Segment(tl.add(rx,0),[-hx,0],null),new Segment(tr.subtract(rx,0),null,[hx,0]),new Segment(tr.add(0,ry),[0,-hy],null),new Segment(br.subtract(0,ry),null,[0,hy]),new Segment(br.subtract(rx,0),[hx,0])]}return createPath(segments,!0,arguments)},RoundRectangle:"#Rectangle",Ellipse:function(){var ellipse=Shape._readEllipse(arguments);return createEllipse(ellipse.center,ellipse.radius,arguments)},Oval:"#Ellipse",Arc:function(){var from=Point.readNamed(arguments,"from"),through=Point.readNamed(arguments,"through"),to=Point.readNamed(arguments,"to"),props=Base.getNamed(arguments),path=new Path(props&&props.insert===!1&&Item.NO_INSERT);return path.moveTo(from),path.arcTo(through,to),path.set(props)},RegularPolygon:function(){for(var center=Point.readNamed(arguments,"center"),sides=Base.readNamed(arguments,"sides"),radius=Base.readNamed(arguments,"radius"),step=360/sides,three=!(sides%3),vector=new Point(0,three?-radius:radius),offset=three?-1:.5,segments=new Array(sides),i=0;sides>i;i++)segments[i]=new Segment(center.add(vector.rotate((i+offset)*step)));return createPath(segments,!0,arguments)},Star:function(){for(var center=Point.readNamed(arguments,"center"),points=2*Base.readNamed(arguments,"points"),radius1=Base.readNamed(arguments,"radius1"),radius2=Base.readNamed(arguments,"radius2"),step=360/points,vector=new Point(0,-1),segments=new Array(points),i=0;points>i;i++)segments[i]=new Segment(center.add(vector.rotate(step*i).multiply(i%2?radius2:radius1)));return createPath(segments,!0,arguments)}}}});var CompoundPath=PathItem.extend({_class:"CompoundPath",_serializeFields:{children:[]},initialize:function(arg){this._children=[],this._namedChildren={},this._initialize(arg)||("string"==typeof arg?this.setPathData(arg):this.addChildren(Array.isArray(arg)?arg:arguments))},insertChildren:function insertChildren(index,items,_preserve){items=insertChildren.base.call(this,index,items,_preserve,Path);for(var i=0,l=!_preserve&&items&&items.length;l>i;i++){var item=items[i];item._clockwise===undefined&&item.setClockwise(0===item._index)}return items},reverse:function(){for(var children=this._children,i=0,l=children.length;l>i;i++)children[i].reverse()},smooth:function(){for(var i=0,l=this._children.length;l>i;i++)this._children[i].smooth()},isClockwise:function(){var child=this.getFirstChild();return child&&child.isClockwise()},setClockwise:function(clockwise){this.isClockwise()!==!!clockwise&&this.reverse()},getFirstSegment:function(){var first=this.getFirstChild();return first&&first.getFirstSegment()},getLastSegment:function(){var last=this.getLastChild();return last&&last.getLastSegment()},getCurves:function(){for(var children=this._children,curves=[],i=0,l=children.length;l>i;i++)curves.push.apply(curves,children[i].getCurves());return curves},getFirstCurve:function(){var first=this.getFirstChild();return first&&first.getFirstCurve()},getLastCurve:function(){var last=this.getLastChild();return last&&last.getFirstCurve()},getArea:function(){for(var children=this._children,area=0,i=0,l=children.length;l>i;i++)area+=children[i].getArea();return area}},{beans:!0,getPathData:function(_precision){for(var children=this._children,paths=[],i=0,l=children.length;l>i;i++)paths.push(children[i].getPathData(_precision));return paths.join(" ")}},{_getChildHitTestOptions:function(options){return"path"===options.type?options:new Base(options,{fill:!1})},_draw:function(ctx,param){var children=this._children;if(0!==children.length){if(this._currentPath)ctx.currentPath=this._currentPath;else{param=param.extend({dontStart:!0,dontFinish:!0}),ctx.beginPath();for(var i=0,l=children.length;l>i;i++)children[i].draw(ctx,param);this._currentPath=ctx.currentPath}if(!param.clip){this._setStyles(ctx);var style=this._style;style.hasFill()&&(ctx.fill(style.getWindingRule()),ctx.shadowColor="rgba(0,0,0,0)"),style.hasStroke()&&ctx.stroke()}}},_drawSelected:function(ctx,matrix){for(var children=this._children,i=0,l=children.length;l>i;i++){var child=children[i],mx=child._matrix;child._drawSelected(ctx,mx.isIdentity()?matrix:matrix.clone().concatenate(child._matrix))}}},new function(){function getCurrentPath(that,check){var children=that._children;if(check&&0===children.length)throw new Error("Use a moveTo() command first");return children[children.length-1]}var fields={moveTo:function(){var current=getCurrentPath(this),path=current&&current.isEmpty()?current:new Path;path!==current&&this.addChild(path),path.moveTo.apply(path,arguments)},moveBy:function(){var current=getCurrentPath(this,!0),last=current&&current.getLastSegment(),point=Point.read(arguments);this.moveTo(last?point.add(last._point):point)},closePath:function(join){getCurrentPath(this,!0).closePath(join)}};return Base.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(key){fields[key]=function(){var path=getCurrentPath(this,!0);path[key].apply(path,arguments)}}),fields});PathItem.inject(new function(){function computeBoolean(path1,path2,operator,subtract){function preparePath(path){return path.clone(!1).reduce().reorient().transform(null,!0)}function collect(paths){for(var i=0,l=paths.length;l>i;i++){var path=paths[i];segments.push.apply(segments,path._segments),monoCurves.push.apply(monoCurves,path._getMonoCurves())}}var _path1=preparePath(path1),_path2=path2&&path1!==path2&&preparePath(path2);_path1.isClockwise()||_path1.reverse(),!_path2||subtract^_path2.isClockwise()||_path2.reverse(),splitPath(_path1.getIntersections(_path2,!0));var chain=[],windings=[],lengths=[],segments=[],monoCurves=[];collect(_path1._children||[_path1]),_path2&&collect(_path2._children||[_path2]),segments.sort(function(a,b){var _a=a._intersection,_b=b._intersection;return!_a&&!_b||_a&&_b?0:_a?-1:1});for(var i=0,l=segments.length;l>i;i++){var segment=segments[i];if(null==segment._winding){chain.length=windings.length=lengths.length=0;var totalLength=0,startSeg=segment;do chain.push(segment),lengths.push(totalLength+=segment.getCurve().getLength()),segment=segment.getNext();while(segment&&!segment._intersection&&segment!==startSeg);for(var j=0;3>j;j++){var length=totalLength*Math.random(),amount=lengths.length,k=0;do if(lengths[k]>=length){k>0&&(length-=lengths[k-1]);break}while(++k<amount);var curve=chain[k].getCurve(),point=curve.getPointAt(length),hor=curve.isHorizontal(),path=curve._path;path._parent instanceof CompoundPath&&(path=path._parent),windings[j]=subtract&&_path2&&(path===_path1&&_path2._getWinding(point,hor)||path===_path2&&!_path1._getWinding(point,hor))?0:getWinding(point,monoCurves,hor)}windings.sort();for(var winding=windings[1],j=chain.length-1;j>=0;j--)chain[j]._winding=winding}}var result=new CompoundPath;return result.addChildren(tracePaths(segments,operator),!0),_path1.remove(),_path2&&_path2.remove(),result.reduce()}function splitPath(intersections){function resetLinear(){for(var i=0,l=linearSegments.length;l>i;i++){var segment=linearSegments[i];segment._handleOut.set(0,0),segment._handleIn.set(0,0)}}for(var linearSegments,curve,prevLoc,TOLERANCE=1e-5,i=intersections.length-1;i>=0;i--){var loc=intersections[i],t=loc._parameter;prevLoc&&prevLoc._curve===loc._curve&&prevLoc._parameter>0?t/=prevLoc._parameter:(linearSegments&&resetLinear(),curve=loc._curve,linearSegments=curve.isLinear()&&[]);var newCurve,segment;(newCurve=curve.divide(t,!0,!0))?(segment=newCurve._segment1,curve=newCurve.getPrevious()):segment=TOLERANCE>t?curve._segment1:t>1-TOLERANCE?curve._segment2:curve.getPartLength(0,t)<curve.getPartLength(t,1)?curve._segment1:curve._segment2,segment._intersection=loc.getIntersection(),loc._segment=segment,linearSegments&&linearSegments.push(segment),prevLoc=loc}linearSegments&&resetLinear()}function getWinding(point,curves,horizontal,testContains){var TOLERANCE=1e-5,x=point.x,y=point.y,windLeft=0,windRight=0,roots=[],abs=Math.abs,MAX=1-TOLERANCE;if(horizontal){for(var yTop=-1/0,yBottom=1/0,yBefore=y-TOLERANCE,yAfter=y+TOLERANCE,i=0,l=curves.length;l>i;i++){var values=curves[i].values;
if(Curve.solveCubic(values,0,x,roots,0,1)>0)for(var j=roots.length-1;j>=0;j--){var y0=Curve.evaluate(values,roots[j],0).y;yBefore>y0&&y0>yTop?yTop=y0:y0>yAfter&&yBottom>y0&&(yBottom=y0)}}yTop=(yTop+y)/2,yBottom=(yBottom+y)/2,yTop>-1/0&&(windLeft=getWinding(new Point(x,yTop),curves)),1/0>yBottom&&(windRight=getWinding(new Point(x,yBottom),curves))}else for(var xBefore=x-TOLERANCE,xAfter=x+TOLERANCE,i=0,l=curves.length;l>i;i++){var curve=curves[i],values=curve.values,winding=curve.winding,next=curve.next;if(winding&&(1===winding&&y>=values[1]&&y<=values[7]||y>=values[7]&&y<=values[1])&&1===Curve.solveCubic(values,1,y,roots,0,next.winding||next.values[1]!==y?MAX:1)){var t=roots[0],x0=Curve.evaluate(values,t,0).x,slope=Curve.evaluate(values,t,1).y;abs(slope)<TOLERANCE&&!Curve.isLinear(values)||TOLERANCE>t&&slope*Curve.evaluate(curve.previous.values,t,1).y<0?testContains&&x0>=xBefore&&xAfter>=x0&&(++windLeft,++windRight):xBefore>=x0?windLeft+=winding:x0>=xAfter&&(windRight+=winding)}}return Math.max(abs(windLeft),abs(windRight))}function tracePaths(segments,operator,selfOp){operator=operator||function(){return!0};for(var seg,startSeg,paths=[],ZERO=.001,ONE=.999,i=0,l=segments.length;l>i;i++)if(seg=startSeg=segments[i],!seg._visited&&operator(seg._winding)){var path=new Path(Item.NO_INSERT),inter=seg._intersection,startInterSeg=inter&&inter._segment,added=!1,dir=1;do{var interSeg,handleIn=dir>0?seg._handleIn:seg._handleOut,handleOut=dir>0?seg._handleOut:seg._handleIn;if(added&&(!operator(seg._winding)||selfOp)&&(inter=seg._intersection)&&(interSeg=inter._segment)&&interSeg!==startSeg){if(selfOp)seg._visited=interSeg._visited,seg=interSeg,dir=1;else{var c1=seg.getCurve();dir>0&&(c1=c1.getPrevious());var t1=c1.getTangentAt(1>dir?ZERO:ONE,!0),c4=interSeg.getCurve(),c3=c4.getPrevious(),t3=c3.getTangentAt(ONE,!0),t4=c4.getTangentAt(ZERO,!0),w3=t1.cross(t3),w4=t1.cross(t4);if(w3*w4!==0){var curve=w4>w3?c3:c4,nextCurve=operator(curve._segment1._winding)?curve:w4>w3?c4:c3,nextSeg=nextCurve._segment1;dir=nextCurve===c3?-1:1,nextSeg._visited&&seg._path!==nextSeg._path||!operator(nextSeg._winding)?dir=1:(seg._visited=interSeg._visited,seg=interSeg,nextSeg._visited&&(dir=1))}else dir=1}handleOut=dir>0?seg._handleOut:seg._handleIn}path.add(new Segment(seg._point,added&&handleIn,handleOut)),added=!0,seg._visited=!0,seg=dir>0?seg.getNext():seg.getPrevious()}while(seg&&!seg._visited&&seg!==startSeg&&seg!==startInterSeg&&(seg._intersection||operator(seg._winding)));!seg||seg!==startSeg&&seg!==startInterSeg?path.lastSegment._handleOut.set(0,0):(path.firstSegment.setHandleIn((seg===startInterSeg?startInterSeg:seg)._handleIn),path.setClosed(!0)),path._segments.length>(path._closed?path.isPolygon()?2:0:1)&&paths.push(path)}return paths}return{_getWinding:function(point,horizontal,testContains){return getWinding(point,this._getMonoCurves(),horizontal,testContains)},unite:function(path){return computeBoolean(this,path,function(w){return 1===w||0===w},!1)},intersect:function(path){return computeBoolean(this,path,function(w){return 2===w},!1)},subtract:function(path){return computeBoolean(this,path,function(w){return 1===w},!0)},exclude:function(path){return new Group([this.subtract(path),path.subtract(this)])},divide:function(path){return new Group([this.subtract(path),this.intersect(path)])}}}),Path.inject({_getMonoCurves:function(){function insertCurve(v){var y0=v[1],y1=v[7],curve={values:v,winding:y0===y1?0:y0>y1?-1:1,previous:prevCurve,next:null};prevCurve&&(prevCurve.next=curve),monoCurves.push(curve),prevCurve=curve}function handleCurve(v){if(0!==Curve.getLength(v)){var y0=v[1],y1=v[3],y2=v[5],y3=v[7];if(Curve.isLinear(v))insertCurve(v);else{var a=3*(y1-y2)-y0+y3,b=2*(y0+y2)-4*y1,c=y1-y0,TOLERANCE=1e-5,roots=[],count=Numerical.solveQuadratic(a,b,c,roots,TOLERANCE,1-TOLERANCE);if(0===count)insertCurve(v);else{roots.sort();var t=roots[0],parts=Curve.subdivide(v,t);insertCurve(parts[0]),count>1&&(t=(roots[1]-t)/(1-t),parts=Curve.subdivide(parts[1],t),insertCurve(parts[0])),insertCurve(parts[1])}}}}var prevCurve,monoCurves=this._monoCurves;if(!monoCurves){monoCurves=this._monoCurves=[];for(var curves=this.getCurves(),segments=this._segments,i=0,l=curves.length;l>i;i++)handleCurve(curves[i].getValues());if(!this._closed&&segments.length>1){var p1=segments[segments.length-1]._point,p2=segments[0]._point,p1x=p1._x,p1y=p1._y,p2x=p2._x,p2y=p2._y;handleCurve([p1x,p1y,p1x,p1y,p2x,p2y,p2x,p2y])}if(monoCurves.length>0){var first=monoCurves[0],last=monoCurves[monoCurves.length-1];first.previous=last,last.next=first}}return monoCurves},getInteriorPoint:function(){var bounds=this.getBounds(),point=bounds.getCenter(!0);if(!this.contains(point)){for(var curves=this._getMonoCurves(),roots=[],y=point.y,xIntercepts=[],i=0,l=curves.length;l>i;i++){var values=curves[i].values;if((1===curves[i].winding&&y>=values[1]&&y<=values[7]||y>=values[7]&&y<=values[1])&&Curve.solveCubic(values,1,y,roots,0,1)>0)for(var j=roots.length-1;j>=0;j--)xIntercepts.push(Curve.evaluate(values,roots[j],0).x);if(xIntercepts.length>1)break}point.x=(xIntercepts[0]+xIntercepts[1])/2}return point},reorient:function(){return this.setClockwise(!0),this}}),CompoundPath.inject({_getMonoCurves:function(){for(var children=this._children,monoCurves=[],i=0,l=children.length;l>i;i++)monoCurves.push.apply(monoCurves,children[i]._getMonoCurves());return monoCurves},reorient:function(){var children=this.removeChildren().sort(function(a,b){return b.getBounds().getArea()-a.getBounds().getArea()});this.addChildren(children);for(var clockwise=children[0].isClockwise(),i=1,l=children.length;l>i;i++){for(var point=children[i].getInteriorPoint(),counters=0,j=i-1;j>=0;j--)children[j].contains(point)&&counters++;children[i].setClockwise(counters%2===0&&clockwise)}return this}});var PathFlattener=Base.extend({initialize:function(path){function addCurve(segment1,segment2){var curve=Curve.getValues(segment1,segment2);that.curves.push(curve),that._computeParts(curve,segment1._index,0,1)}this.curves=[],this.parts=[],this.length=0,this.index=0;for(var segment2,segments=path._segments,segment1=segments[0],that=this,i=1,l=segments.length;l>i;i++)segment2=segments[i],addCurve(segment1,segment2),segment1=segment2;path._closed&&addCurve(segment2,segments[0])},_computeParts:function(curve,index,minT,maxT){if(maxT-minT>1/32&&!Curve.isFlatEnough(curve,.25)){var curves=Curve.subdivide(curve),halfT=(minT+maxT)/2;this._computeParts(curves[0],index,minT,halfT),this._computeParts(curves[1],index,halfT,maxT)}else{var x=curve[6]-curve[0],y=curve[7]-curve[1],dist=Math.sqrt(x*x+y*y);dist>1e-5&&(this.length+=dist,this.parts.push({offset:this.length,value:maxT,index:index}))}},getParameterAt:function(offset){for(var i,j=this.index;i=j,!(0==j||this.parts[--j].offset<offset););for(var l=this.parts.length;l>i;i++){var part=this.parts[i];if(part.offset>=offset){this.index=i;var prev=this.parts[i-1],prevVal=prev&&prev.index==part.index?prev.value:0,prevLen=prev?prev.offset:0;return{value:prevVal+(part.value-prevVal)*(offset-prevLen)/(part.offset-prevLen),index:part.index}}}var part=this.parts[this.parts.length-1];return{value:1,index:part.index}},evaluate:function(offset,type){var param=this.getParameterAt(offset);return Curve.evaluate(this.curves[param.index],param.value,type)},drawPart:function(ctx,from,to){from=this.getParameterAt(from),to=this.getParameterAt(to);for(var i=from.index;i<=to.index;i++){var curve=Curve.getPart(this.curves[i],i==from.index?from.value:0,i==to.index?to.value:1);i==from.index&&ctx.moveTo(curve[0],curve[1]),ctx.bezierCurveTo.apply(ctx,curve.slice(2))}}}),PathFitter=Base.extend({initialize:function(path,error){this.points=[];for(var prev,segments=path._segments,i=0,l=segments.length;l>i;i++){var point=segments[i].point.clone();prev&&prev.equals(point)||(this.points.push(point),prev=point)}this.error=error},fit:function(){var points=this.points,length=points.length;return this.segments=length>0?[new Segment(points[0])]:[],length>1&&this.fitCubic(0,length-1,points[1].subtract(points[0]).normalize(),points[length-2].subtract(points[length-1]).normalize()),this.segments},fitCubic:function(first,last,tan1,tan2){if(last-first==1){var pt1=this.points[first],pt2=this.points[last],dist=pt1.getDistance(pt2)/3;return void this.addCurve([pt1,pt1.add(tan1.normalize(dist)),pt2.add(tan2.normalize(dist)),pt2])}for(var split,uPrime=this.chordLengthParameterize(first,last),maxError=Math.max(this.error,this.error*this.error),i=0;4>=i;i++){var curve=this.generateBezier(first,last,uPrime,tan1,tan2),max=this.findMaxError(first,last,curve,uPrime);if(max.error<this.error)return void this.addCurve(curve);if(split=max.index,max.error>=maxError)break;this.reparameterize(first,last,uPrime,curve),maxError=max.error}var V1=this.points[split-1].subtract(this.points[split]),V2=this.points[split].subtract(this.points[split+1]),tanCenter=V1.add(V2).divide(2).normalize();this.fitCubic(first,split,tan1,tanCenter),this.fitCubic(split,last,tanCenter.negate(),tan2)},addCurve:function(curve){var prev=this.segments[this.segments.length-1];prev.setHandleOut(curve[1].subtract(curve[0])),this.segments.push(new Segment(curve[3],curve[2].subtract(curve[3])))},generateBezier:function(first,last,uPrime,tan1,tan2){for(var epsilon=1e-11,pt1=this.points[first],pt2=this.points[last],C=[[0,0],[0,0]],X=[0,0],i=0,l=last-first+1;l>i;i++){var u=uPrime[i],t=1-u,b=3*u*t,b0=t*t*t,b1=b*t,b2=b*u,b3=u*u*u,a1=tan1.normalize(b1),a2=tan2.normalize(b2),tmp=this.points[first+i].subtract(pt1.multiply(b0+b1)).subtract(pt2.multiply(b2+b3));C[0][0]+=a1.dot(a1),C[0][1]+=a1.dot(a2),C[1][0]=C[0][1],C[1][1]+=a2.dot(a2),X[0]+=a1.dot(tmp),X[1]+=a2.dot(tmp)}var alpha1,alpha2,detC0C1=C[0][0]*C[1][1]-C[1][0]*C[0][1];if(Math.abs(detC0C1)>epsilon){var detC0X=C[0][0]*X[1]-C[1][0]*X[0],detXC1=X[0]*C[1][1]-X[1]*C[0][1];alpha1=detXC1/detC0C1,alpha2=detC0X/detC0C1}else{var c0=C[0][0]+C[0][1],c1=C[1][0]+C[1][1];alpha1=alpha2=Math.abs(c0)>epsilon?X[0]/c0:Math.abs(c1)>epsilon?X[1]/c1:0}var segLength=pt2.getDistance(pt1);return epsilon*=segLength,(epsilon>alpha1||epsilon>alpha2)&&(alpha1=alpha2=segLength/3),[pt1,pt1.add(tan1.normalize(alpha1)),pt2.add(tan2.normalize(alpha2)),pt2]},reparameterize:function(first,last,u,curve){for(var i=first;last>=i;i++)u[i-first]=this.findRoot(curve,this.points[i],u[i-first])},findRoot:function(curve,point,u){for(var curve1=[],curve2=[],i=0;2>=i;i++)curve1[i]=curve[i+1].subtract(curve[i]).multiply(3);for(var i=0;1>=i;i++)curve2[i]=curve1[i+1].subtract(curve1[i]).multiply(2);var pt=this.evaluate(3,curve,u),pt1=this.evaluate(2,curve1,u),pt2=this.evaluate(1,curve2,u),diff=pt.subtract(point),df=pt1.dot(pt1)+diff.dot(pt2);return Math.abs(df)<1e-5?u:u-diff.dot(pt1)/df},evaluate:function(degree,curve,t){for(var tmp=curve.slice(),i=1;degree>=i;i++)for(var j=0;degree-i>=j;j++)tmp[j]=tmp[j].multiply(1-t).add(tmp[j+1].multiply(t));return tmp[0]},chordLengthParameterize:function(first,last){for(var u=[0],i=first+1;last>=i;i++)u[i-first]=u[i-first-1]+this.points[i].getDistance(this.points[i-1]);for(var i=1,m=last-first;m>=i;i++)u[i]/=u[m];return u},findMaxError:function(first,last,curve,u){for(var index=Math.floor((last-first+1)/2),maxDist=0,i=first+1;last>i;i++){var P=this.evaluate(3,curve,u[i-first]),v=P.subtract(this.points[i]),dist=v.x*v.x+v.y*v.y;dist>=maxDist&&(maxDist=dist,index=i)}return{error:maxDist,index:index}}}),TextItem=Item.extend({_class:"TextItem",_boundsSelected:!0,_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(arg){this._content="",this._lines=[];var hasProps=arg&&Base.isPlainObject(arg)&&arg.x===undefined&&arg.y===undefined;this._initialize(hasProps&&arg,!hasProps&&Point.read(arguments))},_equals:function(item){return this._content===item._content},_clone:function _clone(copy){return copy.setContent(this._content),_clone.base.call(this,copy)},getContent:function(){return this._content},setContent:function(content){this._content=""+content,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(265)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),PointText=TextItem.extend({_class:"PointText",initialize:function(){TextItem.apply(this,arguments)},clone:function(insert){return this._clone(new PointText(Item.NO_INSERT),insert)},getPoint:function(){var point=this._matrix.getTranslation();return new LinkedPoint(point.x,point.y,this,"setPoint")},setPoint:function(){var point=Point.read(arguments);this.translate(point.subtract(this._matrix.getTranslation()))},_draw:function(ctx){if(this._content){this._setStyles(ctx);var style=this._style,lines=this._lines,leading=style.getLeading(),shadowColor=ctx.shadowColor;ctx.font=style.getFontStyle(),ctx.textAlign=style.getJustification();for(var i=0,l=lines.length;l>i;i++){ctx.shadowColor=shadowColor;var line=lines[i];style.hasFill()&&(ctx.fillText(line,0,0),ctx.shadowColor="rgba(0,0,0,0)"),style.hasStroke()&&ctx.strokeText(line,0,0),ctx.translate(0,leading)}}},_getBounds:function(getter,matrix){var style=this._style,lines=this._lines,numLines=lines.length,justification=style.getJustification(),leading=style.getLeading(),width=this.getView().getTextWidth(style.getFontStyle(),lines),x=0;"left"!==justification&&(x-=width/("center"===justification?2:1));var bounds=new Rectangle(x,numLines?-.75*leading:0,width,numLines*leading);return matrix?matrix._transformBounds(bounds,bounds):bounds}}),Color=Base.extend(new function(){function fromCSS(string){var components,match=string.match(/^#(\w{1,2})(\w{1,2})(\w{1,2})$/);if(match){components=[0,0,0];for(var i=0;3>i;i++){var value=match[i+1];components[i]=parseInt(1==value.length?value+value:value,16)/255}}else if(match=string.match(/^rgba?\((.*)\)$/)){components=match[1].split(",");for(var i=0,l=components.length;l>i;i++){var value=+components[i];components[i]=3>i?value/255:value}}else{var cached=colorCache[string];if(!cached){colorCtx||(colorCtx=CanvasProvider.getContext(1,1),colorCtx.globalCompositeOperation="copy"),colorCtx.fillStyle="rgba(0,0,0,0)",colorCtx.fillStyle=string,colorCtx.fillRect(0,0,1,1);var data=colorCtx.getImageData(0,0,1,1).data;cached=colorCache[string]=[data[0]/255,data[1]/255,data[2]/255]}components=cached.slice()}return components}var colorCtx,types={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},componentParsers={},colorCache={},hsbIndices=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],converters={"rgb-hsb":function(r,g,b){var max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,h=0===delta?0:60*(max==r?(g-b)/delta+(b>g?6:0):max==g?(b-r)/delta+2:(r-g)/delta+4);return[h,0===max?0:delta/max,max]},"hsb-rgb":function(h,s,b){h=(h/60%6+6)%6;var i=Math.floor(h),f=h-i,i=hsbIndices[i],v=[b,b*(1-s),b*(1-s*f),b*(1-s*(1-f))];return[v[i[0]],v[i[1]],v[i[2]]]},"rgb-hsl":function(r,g,b){var max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,achromatic=0===delta,h=achromatic?0:60*(max==r?(g-b)/delta+(b>g?6:0):max==g?(b-r)/delta+2:(r-g)/delta+4),l=(max+min)/2,s=achromatic?0:.5>l?delta/(max+min):delta/(2-max-min);return[h,s,l]},"hsl-rgb":function(h,s,l){if(h=(h/360%1+1)%1,0===s)return[l,l,l];for(var t3s=[h+1/3,h,h-1/3],t2=.5>l?l*(1+s):l+s-l*s,t1=2*l-t2,c=[],i=0;3>i;i++){var t3=t3s[i];0>t3&&(t3+=1),t3>1&&(t3-=1),c[i]=1>6*t3?t1+6*(t2-t1)*t3:1>2*t3?t2:2>3*t3?t1+(t2-t1)*(2/3-t3)*6:t1}return c},"rgb-gray":function(r,g,b){return[.2989*r+.587*g+.114*b]},"gray-rgb":function(g){return[g,g,g]},"gray-hsb":function(g){return[0,0,g]},"gray-hsl":function(g){return[0,0,g]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return Base.each(types,function(properties,type){componentParsers[type]=[],Base.each(properties,function(name,index){var part=Base.capitalize(name),hasOverlap=/^(hue|saturation)$/.test(name),parser=componentParsers[type][index]="gradient"===name?function(value){var current=this._components[0];return value=Gradient.read(Array.isArray(value)?value:arguments,0,{readNull:!0}),current!==value&&(current&&current._removeOwner(this),value&&value._addOwner(this)),value}:"gradient"===type?function(){return Point.read(arguments,0,{readNull:"highlight"===name,clone:!0})}:function(value){return null==value||isNaN(value)?0:value};this["get"+part]=function(){return this._type===type||hasOverlap&&/^hs[bl]$/.test(this._type)?this._components[index]:this._convert(type)[index]},this["set"+part]=function(value){this._type===type||hasOverlap&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(type),this._properties=types[type],this._type=type),value=parser.call(this,value),null!=value&&(this._components[index]=value,this._changed())}},this)},{_class:"Color",_readIndex:!0,initialize:function Color(arg){var type,components,alpha,values,slice=Array.prototype.slice,args=arguments,read=0;Array.isArray(arg)&&(args=arg,arg=args[0]);var argType=null!=arg&&typeof arg;if("string"===argType&&arg in types&&(type=arg,arg=args[1],Array.isArray(arg)?(components=arg,alpha=args[2]):(this.__read&&(read=1),args=slice.call(args,1),argType=typeof arg)),!components){if(values="number"===argType?args:"object"===argType&&null!=arg.length?arg:null){type||(type=values.length>=3?"rgb":"gray");var length=types[type].length;alpha=values[length],this.__read&&(read+=values===arguments?length+(null!=alpha?1:0):1),values.length>length&&(values=slice.call(values,0,length))}else if("string"===argType)type="rgb",components=fromCSS(arg),4===components.length&&(alpha=components[3],components.length--);else if("object"===argType)if(arg.constructor===Color){if(type=arg._type,components=arg._components.slice(),alpha=arg._alpha,"gradient"===type)for(var i=1,l=components.length;l>i;i++){var point=components[i];point&&(components[i]=point.clone())}}else if(arg.constructor===Gradient)type="gradient",values=args;else{type="hue"in arg?"lightness"in arg?"hsl":"hsb":"gradient"in arg||"stops"in arg||"radial"in arg?"gradient":"gray"in arg?"gray":"rgb";var properties=types[type];parsers=componentParsers[type],this._components=components=[];for(var i=0,l=properties.length;l>i;i++){var value=arg[properties[i]];null==value&&0===i&&"gradient"===type&&"stops"in arg&&(value={stops:arg.stops,radial:arg.radial}),value=parsers[i].call(this,value),null!=value&&(components[i]=value)}alpha=arg.alpha}this.__read&&type&&(read=1)}if(this._type=type||"rgb","gradient"===type&&(this._id=Color._id=(Color._id||0)+1),!components){this._components=components=[];for(var parsers=componentParsers[this._type],i=0,l=parsers.length;l>i;i++){var value=parsers[i].call(this,values&&values[i]);null!=value&&(components[i]=value)}}this._components=components,this._properties=types[this._type],this._alpha=alpha,this.__read&&(this.__read=read)},_serialize:function(options,dictionary){var components=this.getComponents();return Base.serialize(/^(gray|rgb)$/.test(this._type)?components:[this._type].concat(components),options,!0,dictionary)},_changed:function(){this._canvasStyle=null,this._owner&&this._owner._changed(65)},_convert:function(type){var converter;return this._type===type?this._components.slice():(converter=converters[this._type+"-"+type])?converter.apply(this,this._components):converters["rgb-"+type].apply(this,converters[this._type+"-rgb"].apply(this,this._components))},convert:function(type){return new Color(type,this._convert(type),this._alpha)},getType:function(){return this._type},setType:function(type){this._components=this._convert(type),this._properties=types[type],this._type=type},getComponents:function(){var components=this._components.slice();return null!=this._alpha&&components.push(this._alpha),components},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(alpha){this._alpha=null==alpha?null:Math.min(Math.max(alpha,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(color){var col=Base.isPlainValue(color)?Color.read(arguments):color;return col===this||col&&this._class===col._class&&this._type===col._type&&this._alpha===col._alpha&&Base.equals(this._components,col._components)||!1},toString:function(){for(var properties=this._properties,parts=[],isGradient="gradient"===this._type,f=Formatter.instance,i=0,l=properties.length;l>i;i++){var value=this._components[i];null!=value&&parts.push(properties[i]+": "+(isGradient?value:f.number(value)))}return null!=this._alpha&&parts.push("alpha: "+f.number(this._alpha)),"{ "+parts.join(", ")+" }"},toCSS:function(hex){function convert(val){return Math.round(255*(0>val?0:val>1?1:val))}var components=this._convert("rgb"),alpha=hex||null==this._alpha?1:this._alpha;return components=[convert(components[0]),convert(components[1]),convert(components[2])],1>alpha&&components.push(0>alpha?0:alpha),hex?"#"+((1<<24)+(components[0]<<16)+(components[1]<<8)+components[2]).toString(16).slice(1):(4==components.length?"rgba(":"rgb(")+components.join(",")+")"},toCanvasStyle:function(ctx){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var canvasGradient,components=this._components,gradient=components[0],stops=gradient._stops,origin=components[1],destination=components[2];if(gradient._radial){var radius=destination.getDistance(origin),highlight=components[3];if(highlight){var vector=highlight.subtract(origin);vector.getLength()>radius&&(highlight=origin.add(vector.normalize(radius-.1)))}var start=highlight||origin;canvasGradient=ctx.createRadialGradient(start.x,start.y,0,origin.x,origin.y,radius)}else canvasGradient=ctx.createLinearGradient(origin.x,origin.y,destination.x,destination.y);for(var i=0,l=stops.length;l>i;i++){var stop=stops[i];canvasGradient.addColorStop(stop._rampPoint,stop._color.toCanvasStyle())}return this._canvasStyle=canvasGradient},transform:function(matrix){if("gradient"===this._type){for(var components=this._components,i=1,l=components.length;l>i;i++){var point=components[i];matrix._transformPoint(point,point,!0)}this._changed()}},statics:{_types:types,random:function(){var random=Math.random;return new Color(random(),random(),random())}}})},new function(){var operators={add:function(a,b){return a+b},subtract:function(a,b){return a-b},multiply:function(a,b){return a*b},divide:function(a,b){return a/b}};return Base.each(operators,function(operator,name){this[name]=function(color){color=Color.read(arguments);for(var type=this._type,components1=this._components,components2=color._convert(type),i=0,l=components1.length;l>i;i++)components2[i]=operator(components1[i],components2[i]);return new Color(type,components2,null!=this._alpha?operator(this._alpha,color.getAlpha()):null)}},{})});Base.each(Color._types,function(properties,type){var ctor=this[Base.capitalize(type)+"Color"]=function(arg){var argType=null!=arg&&typeof arg,components="object"===argType&&null!=arg.length?arg:"string"===argType?null:arguments;return components?new Color(type,components):new Color(arg)};if(3==type.length){var acronym=type.toUpperCase();Color[acronym]=this[acronym+"Color"]=ctor}},Base.exports);var Gradient=Base.extend({_class:"Gradient",initialize:function Gradient(stops,radial){this._id=Gradient._id=(Gradient._id||0)+1,stops&&this._set(stops)&&(stops=radial=null),this._stops||this.setStops(stops||["white","black"]),null==this._radial&&this.setRadial("string"==typeof radial&&"radial"===radial||radial||!1)},_serialize:function(options,dictionary){return dictionary.add(this,function(){return Base.serialize([this._stops,this._radial],options,!0,dictionary)})},_changed:function(){for(var i=0,l=this._owners&&this._owners.length;l>i;i++)this._owners[i]._changed()},_addOwner:function(color){this._owners||(this._owners=[]),this._owners.push(color)},_removeOwner:function(color){var index=this._owners?this._owners.indexOf(color):-1;-1!=index&&(this._owners.splice(index,1),0===this._owners.length&&(this._owners=undefined))},clone:function(){for(var stops=[],i=0,l=this._stops.length;l>i;i++)stops[i]=this._stops[i].clone();return new Gradient(stops)},getStops:function(){return this._stops},setStops:function(stops){if(this.stops)for(var i=0,l=this._stops.length;l>i;i++)this._stops[i]._owner=undefined;if(stops.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");this._stops=GradientStop.readAll(stops,0,{clone:!0});for(var i=0,l=this._stops.length;l>i;i++){var stop=this._stops[i];stop._owner=this,stop._defaultRamp&&stop.setRampPoint(i/(l-1))}this._changed()},getRadial:function(){return this._radial},setRadial:function(radial){this._radial=radial,this._changed()},equals:function(gradient){if(gradient===this)return!0;if(gradient&&this._class===gradient._class&&this._stops.length===gradient._stops.length){for(var i=0,l=this._stops.length;l>i;i++)if(!this._stops[i].equals(gradient._stops[i]))return!1;return!0}return!1}}),GradientStop=Base.extend({_class:"GradientStop",initialize:function(arg0,arg1){if(arg0){var color,rampPoint;arg1===undefined&&Array.isArray(arg0)?(color=arg0[0],rampPoint=arg0[1]):arg0.color?(color=arg0.color,rampPoint=arg0.rampPoint):(color=arg0,rampPoint=arg1),this.setColor(color),this.setRampPoint(rampPoint)}},clone:function(){return new GradientStop(this._color.clone(),this._rampPoint)},_serialize:function(options,dictionary){return Base.serialize([this._color,this._rampPoint],options,!0,dictionary)},_changed:function(){this._owner&&this._owner._changed(65)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(rampPoint){this._defaultRamp=null==rampPoint,this._rampPoint=rampPoint||0,this._changed()},getColor:function(){return this._color},setColor:function(color){this._color=Color.read(arguments),this._color===color&&(this._color=color.clone()),this._color._owner=this,this._changed()},equals:function(stop){return stop===this||stop&&this._class===stop._class&&this._color.equals(stop._color)&&this._rampPoint==stop._rampPoint||!1}}),Style=Base.extend(new function(){var defaults={fillColor:undefined,strokeColor:undefined,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",miterLimit:10,dashOffset:0,dashArray:[],windingRule:"nonzero",shadowColor:undefined,shadowBlur:0,shadowOffset:new Point,selectedColor:undefined,fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,font:"sans-serif",leading:null,justification:"left"},flags={strokeWidth:97,strokeCap:97,strokeJoin:97,miterLimit:97,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},item={},fields={_defaults:defaults,_textDefaults:new Base(defaults,{fillColor:new Color}),beans:!0};return Base.each(defaults,function(value,key){var isColor=/Color$/.test(key),part=Base.capitalize(key),flag=flags[key],set="set"+part,get="get"+part;fields[set]=function(value){var owner=this._owner,children=owner&&owner._children;if(children&&children.length>0&&!(owner instanceof CompoundPath))for(var i=0,l=children.length;l>i;i++)children[i]._style[set](value);else{var old=this._values[key];old!=value&&(isColor&&(old&&(old._owner=undefined),value&&value.constructor===Color&&(value._owner&&(value=value.clone()),value._owner=owner)),this._values[key]=value,owner&&owner._changed(flag||65))}},fields[get]=function(_dontMerge){var value,owner=this._owner,children=owner&&owner._children;if(!children||0===children.length||_dontMerge||owner instanceof CompoundPath){var value=this._values[key];return value===undefined?(value=this._defaults[key],value&&value.clone&&(value=value.clone()),this._values[key]=value):!isColor||value&&value.constructor===Color||(this._values[key]=value=Color.read([value],0,{readNull:!0,clone:!0}),value&&(value._owner=owner)),value}for(var i=0,l=children.length;l>i;i++){var childValue=children[i]._style[get]();if(0===i)value=childValue;else if(!Base.equals(value,childValue))return undefined}return value},item[get]=function(){return this._style[get]()},item[set]=function(value){this._style[set](value)}}),Item.inject(item),fields},{_class:"Style",initialize:function(style,_owner,_project){this._values={},this._owner=_owner,this._project=_owner&&_owner._project||_project||paper.project,_owner instanceof TextItem&&(this._defaults=this._textDefaults),style&&this.set(style)},set:function(style){var isStyle=style instanceof Style,values=isStyle?style._values:style;if(values)for(var key in values)if(key in this._defaults){var value=values[key];this[key]=value&&isStyle&&value.clone?value.clone():value}},equals:function(style){return style===this||style&&this._class===style._class&&Base.equals(this._values,style._values)||!1},hasFill:function(){return!!this.getFillColor()},hasStroke:function(){return!!this.getStrokeColor()&&this.getStrokeWidth()>0},hasShadow:function(){return!!this.getShadowColor()&&this.getShadowBlur()>0},getView:function(){return this._project.getView()},getFontStyle:function(){var fontSize=this.getFontSize();return this.getFontWeight()+" "+fontSize+(/[a-z]/i.test(fontSize+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function getLeading(){var leading=getLeading.base.call(this),fontSize=this.getFontSize();return/pt|em|%|px/.test(fontSize)&&(fontSize=this.getView().getPixelSize(fontSize)),null!=leading?leading:1.2*fontSize}}),DomElement=new function(){function create(nodes,parent){for(var res=[],i=0,l=nodes&&nodes.length;l>i;){var el=nodes[i++];if("string"==typeof el)el=document.createElement(el);else if(!el||!el.nodeType)continue;Base.isPlainObject(nodes[i])&&DomElement.set(el,nodes[i++]),Array.isArray(nodes[i])&&create(nodes[i++],el),parent&&parent.appendChild(el),res.push(el)}return res}function handlePrefix(el,name,set,value){for(var prefixes=["webkit","moz","Moz","ms","o",""],suffix=name[0].toUpperCase()+name.substring(1),i=0;6>i;i++){var prefix=prefixes[i],key=prefix?prefix+suffix:name;if(key in el){if(!set)return el[key];el[key]=value;break}}}var special=/^(checked|value|selected|disabled)$/i,translated={text:"textContent",html:"innerHTML"},unitless={lineHeight:1,zoom:1,zIndex:1,opacity:1};return{create:function(nodes,parent){var isArray=Array.isArray(nodes),res=create(isArray?nodes:arguments,isArray?parent:null);return 1==res.length?res[0]:res},find:function(selector,root){return(root||document).querySelector(selector)},findAll:function(selector,root){return(root||document).querySelectorAll(selector)},get:function(el,key){return el?special.test(key)?"value"===key||"string"!=typeof el[key]?el[key]:!0:key in translated?el[translated[key]]:el.getAttribute(key):null},set:function(el,key,value){if("string"!=typeof key)for(var name in key)key.hasOwnProperty(name)&&this.set(el,name,key[name]);else{if(!el||value===undefined)return el;special.test(key)?el[key]=value:key in translated?el[translated[key]]=value:"style"===key?this.setStyle(el,value):"events"===key?DomEvent.add(el,value):el.setAttribute(key,value)}return el},getStyles:function(el){var doc=el&&9!==el.nodeType?el.ownerDocument:el,view=doc&&doc.defaultView;return view&&view.getComputedStyle(el,"")},getStyle:function(el,key){return el&&el.style[key]||this.getStyles(el)[key]||null},setStyle:function(el,key,value){if("string"!=typeof key)for(var name in key)key.hasOwnProperty(name)&&this.setStyle(el,name,key[name]);else!/^-?[\d\.]+$/.test(value)||key in unitless||(value+="px"),el.style[key]=value;return el},hasClass:function(el,cls){return new RegExp("\\s*"+cls+"\\s*").test(el.className)},addClass:function(el,cls){el.className=(el.className+" "+cls).trim()},removeClass:function(el,cls){el.className=el.className.replace(new RegExp("\\s*"+cls+"\\s*")," ").trim()},remove:function(el){el.parentNode&&el.parentNode.removeChild(el)},removeChildren:function(el){for(;el.firstChild;)el.removeChild(el.firstChild)},getBounds:function(el,viewport){var rect,doc=el.ownerDocument,body=doc.body,html=doc.documentElement;try{rect=el.getBoundingClientRect()}catch(e){rect={left:0,top:0,width:0,height:0}}var x=rect.left-(html.clientLeft||body.clientLeft||0),y=rect.top-(html.clientTop||body.clientTop||0);
if(!viewport){var view=doc.defaultView;x+=view.pageXOffset||html.scrollLeft||body.scrollLeft,y+=view.pageYOffset||html.scrollTop||body.scrollTop}return new Rectangle(x,y,rect.width,rect.height)},getViewportBounds:function(el){var doc=el.ownerDocument,view=doc.defaultView,html=doc.documentElement;return new Rectangle(0,0,view.innerWidth||html.clientWidth,view.innerHeight||html.clientHeight)},getOffset:function(el,viewport){return this.getBounds(el,viewport).getPoint()},getSize:function(el){return this.getBounds(el,!0).getSize()},isInvisible:function(el){return this.getSize(el).equals(new Size(0,0))},isInView:function(el){return!this.isInvisible(el)&&this.getViewportBounds(el).intersects(this.getBounds(el,!0))},getPrefixed:function(el,name){return handlePrefix(el,name)},setPrefixed:function(el,name,value){if("object"==typeof name)for(var key in name)handlePrefix(el,key,!0,name[key]);else handlePrefix(el,name,!0,value)}}},DomEvent={add:function(el,events){for(var type in events)for(var func=events[type],parts=type.split(/[\s,]+/g),i=0,l=parts.length;l>i;i++)el.addEventListener(parts[i],func,!1)},remove:function(el,events){for(var type in events)for(var func=events[type],parts=type.split(/[\s,]+/g),i=0,l=parts.length;l>i;i++)el.removeEventListener(parts[i],func,!1)},getPoint:function(event){var pos=event.targetTouches?event.targetTouches.length?event.targetTouches[0]:event.changedTouches[0]:event;return new Point(pos.pageX||pos.clientX+document.documentElement.scrollLeft,pos.pageY||pos.clientY+document.documentElement.scrollTop)},getTarget:function(event){return event.target||event.srcElement},getRelatedTarget:function(event){return event.relatedTarget||event.toElement},getOffset:function(event,target){return DomEvent.getPoint(event).subtract(DomElement.getOffset(target||DomEvent.getTarget(event)))},stop:function(event){event.stopPropagation(),event.preventDefault()}};DomEvent.requestAnimationFrame=new function(){function handleCallbacks(){for(var i=callbacks.length-1;i>=0;i--){var entry=callbacks[i],func=entry[0],el=entry[1];(!el||("true"==PaperScope.getAttribute(el,"keepalive")||focused)&&DomElement.isInView(el))&&(callbacks.splice(i,1),func())}nativeRequest&&(callbacks.length?nativeRequest(handleCallbacks):requested=!1)}var timer,nativeRequest=DomElement.getPrefixed(window,"requestAnimationFrame"),requested=!1,callbacks=[],focused=!0;return DomEvent.add(window,{focus:function(){focused=!0},blur:function(){focused=!1}}),function(callback,element){callbacks.push([callback,element]),nativeRequest?requested||(nativeRequest(handleCallbacks),requested=!0):timer||(timer=setInterval(handleCallbacks,1e3/60))}};var View=Base.extend(Callback,{_class:"View",initialize:function View(project,element){this._project=project,this._scope=project._scope,this._element=element;var size;this._pixelRatio||(this._pixelRatio=window.devicePixelRatio||1),this._id=element.getAttribute("id"),null==this._id&&element.setAttribute("id",this._id="view-"+View._id++),DomEvent.add(element,this._viewEvents);var none="none";if(DomElement.setPrefixed(element.style,{userSelect:none,touchAction:none,touchCallout:none,contentZooming:none,userDrag:none,tapHighlightColor:"rgba(0,0,0,0)"}),PaperScope.hasAttribute(element,"resize")){var offset=DomElement.getOffset(element,!0),that=this;size=DomElement.getViewportBounds(element).getSize().subtract(offset),this._windowEvents={resize:function(){DomElement.isInvisible(element)||(offset=DomElement.getOffset(element,!0)),that.setViewSize(DomElement.getViewportBounds(element).getSize().subtract(offset))}},DomEvent.add(window,this._windowEvents)}else if(size=DomElement.getSize(element),size.isNaN()||size.isZero()){var getSize=function(name){return element[name]||parseInt(element.getAttribute(name),10)};size=new Size(getSize("width"),getSize("height"))}if(this._setViewSize(size),PaperScope.hasAttribute(element,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var stats=this._stats.domElement,style=stats.style,offset=DomElement.getOffset(element);style.position="absolute",style.left=offset.x+"px",style.top=offset.y+"px",document.body.appendChild(stats)}View._views.push(this),View._viewsById[this._id]=this,this._viewSize=size,(this._matrix=new Matrix)._owner=this,this._zoom=1,View._focused||(View._focused=this),this._frameItems={},this._frameItemCount=0},remove:function(){return this._project?(View._focused===this&&(View._focused=null),View._views.splice(View._views.indexOf(this),1),delete View._viewsById[this._id],this._project._view===this&&(this._project._view=null),DomEvent.remove(this._element,this._viewEvents),DomEvent.remove(window,this._windowEvents),this._element=this._project=null,this.detach("frame"),this._animate=!1,this._frameItems={},!0):!1},_events:{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}},onResize:{}},_animate:!1,_time:0,_count:0,_requestFrame:function(){var that=this;DomEvent.requestAnimationFrame(function(){that._requested=!1,that._animate&&(that._requestFrame(),that._handleFrame())},this._element),this._requested=!0},_handleFrame:function(){paper=this._scope;var now=Date.now()/1e3,delta=this._before?now-this._before:0;this._before=now,this._handlingFrame=!0,this.fire("frame",new Base({delta:delta,time:this._time+=delta,count:this._count++})),this._stats&&this._stats.update(),this._handlingFrame=!1,this.update()},_animateItem:function(item,animate){var items=this._frameItems;animate?(items[item._id]={item:item,time:0,count:0},1===++this._frameItemCount&&this.attach("frame",this._handleFrameItems)):(delete items[item._id],0===--this._frameItemCount&&this.detach("frame",this._handleFrameItems))},_handleFrameItems:function(event){for(var i in this._frameItems){var entry=this._frameItems[i];entry.item.fire("frame",new Base(event,{time:entry.time+=event.delta,count:entry.count++}))}},_update:function(){this._project._needsUpdate=!0,this._handlingFrame||(this._animate?this._handleFrame():this.update())},_changed:function(flags){1&flags&&(this._project._needsUpdate=!0)},_transform:function(matrix){this._matrix.concatenate(matrix),this._bounds=null,this._update()},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var size=this._viewSize;return new LinkedSize(size.width,size.height,this,"setViewSize")},setViewSize:function(){var size=Size.read(arguments),delta=size.subtract(this._viewSize);delta.isZero()||(this._viewSize.set(size.width,size.height),this._setViewSize(size),this._bounds=null,this.fire("resize",{size:size,delta:delta}),this._update())},_setViewSize:function(size){var element=this._element;element.width=size.width,element.height=size.height},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new Rectangle(new Point,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(center){center=Point.read(arguments),this.scrollBy(center.subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(zoom){this._transform((new Matrix).scale(zoom/this._zoom,this.getCenter())),this._zoom=zoom},isVisible:function(){return DomElement.isInView(this._element)},scrollBy:function(){this._transform((new Matrix).translate(Point.read(arguments).negate()))},play:function(){this._animate=!0,this._requested||this._requestFrame()},pause:function(){this._animate=!1},draw:function(){this.update()},projectToView:function(){return this._matrix._transformPoint(Point.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(Point.read(arguments))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(project,element){return"string"==typeof element&&(element=document.getElementById(element)),new CanvasView(project,element)}}},new function(){function getView(event){var target=DomEvent.getTarget(event);return target.getAttribute&&View._viewsById[target.getAttribute("id")]}function viewToProject(view,event){return view.viewToProject(DomEvent.getOffset(event,view._element))}function updateFocus(){if(!View._focused||!View._focused.isVisible())for(var i=0,l=View._views.length;l>i;i++){var view=View._views[i];if(view&&view.isVisible()){View._focused=tempFocus=view;break}}}function handleMouseMove(view,point,event){view._handleEvent("mousemove",point,event);var tool=view._scope.tool;return tool&&tool._handleEvent(dragging&&tool.responds("mousedrag")?"mousedrag":"mousemove",point,event),view.update(),tool}var tool,prevFocus,tempFocus,mousedown,mousemove,mouseup,dragging=!1,navigator=window.navigator;navigator.pointerEnabled||navigator.msPointerEnabled?(mousedown="pointerdown MSPointerDown",mousemove="pointermove MSPointerMove",mouseup="pointerup pointercancel MSPointerUp MSPointerCancel"):(mousedown="touchstart",mousemove="touchmove",mouseup="touchend touchcancel","ontouchstart"in window&&navigator.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(mousedown+=" mousedown",mousemove+=" mousemove",mouseup+=" mouseup"));var viewEvents={"selectstart dragstart":function(event){dragging&&event.preventDefault()}},docEvents={mouseout:function(event){var view=View._focused,target=DomEvent.getRelatedTarget(event);!view||target&&"HTML"!==target.nodeName||handleMouseMove(view,viewToProject(view,event),event)},scroll:updateFocus};return viewEvents[mousedown]=function(event){var view=View._focused=getView(event),point=viewToProject(view,event);dragging=!0,view._handleEvent("mousedown",point,event),(tool=view._scope.tool)&&tool._handleEvent("mousedown",point,event),view.update()},docEvents[mousemove]=function(event){var view=View._focused;if(!dragging){var target=getView(event);target?(view!==target&&handleMouseMove(view,viewToProject(view,event),event),prevFocus=view,view=View._focused=tempFocus=target):tempFocus&&tempFocus===view&&(view=View._focused=prevFocus,updateFocus())}if(view){var point=viewToProject(view,event);(dragging||view.getBounds().contains(point))&&(tool=handleMouseMove(view,point,event))}},docEvents[mouseup]=function(event){var view=View._focused;if(view&&dragging){var point=viewToProject(view,event);dragging=!1,view._handleEvent("mouseup",point,event),tool&&tool._handleEvent("mouseup",point,event),view.update()}},DomEvent.add(document,docEvents),DomEvent.add(window,{load:updateFocus}),{_viewEvents:viewEvents,_handleEvent:function(){},statics:{updateFocus:updateFocus}}}),CanvasView=View.extend({_class:"CanvasView",initialize:function(project,canvas){if(!(canvas instanceof HTMLCanvasElement)){var size=Size.read(arguments);if(size.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+canvas);canvas=CanvasProvider.getCanvas(size)}if(this._context=canvas.getContext("2d"),this._eventCounters={},this._pixelRatio=1,"off"!==PaperScope.getAttribute(canvas,"hidpi")){var deviceRatio=window.devicePixelRatio||1,backingStoreRatio=DomElement.getPrefixed(this._context,"backingStorePixelRatio")||1;this._pixelRatio=deviceRatio/backingStoreRatio}View.call(this,project,canvas)},_setViewSize:function(size){var width=size.width,height=size.height,pixelRatio=this._pixelRatio,element=this._element,style=element.style;element.width=width*pixelRatio,element.height=height*pixelRatio,1!==pixelRatio&&(style.width=width+"px",style.height=height+"px",this._context.scale(pixelRatio,pixelRatio))},getPixelSize:function(size){var ctx=this._context,prevFont=ctx.font;return ctx.font=size+" serif",size=parseFloat(ctx.font),ctx.font=prevFont,size},getTextWidth:function(font,lines){var ctx=this._context,prevFont=ctx.font,width=0;ctx.font=font;for(var i=0,l=lines.length;l>i;i++)width=Math.max(width,ctx.measureText(lines[i]).width);return ctx.font=prevFont,width},update:function(){var project=this._project;if(!project||!project._needsUpdate)return!1;var ctx=this._context,size=this._viewSize;return ctx.clearRect(0,0,size.width+1,size.height+1),project.draw(ctx,this._matrix,this._pixelRatio),project._needsUpdate=!1,!0}},new function(){function callEvent(view,type,event,point,target,lastPoint){function call(obj){return obj.responds(type)&&(mouseEvent||(mouseEvent=new MouseEvent(type,event,point,target,lastPoint?point.subtract(lastPoint):null)),obj.fire(type,mouseEvent)&&mouseEvent.isStopped)?(event.preventDefault(),!0):void 0}for(var mouseEvent,item=target;item;){if(call(item))return!0;item=item.getParent()}return call(view)?!0:!1}var downPoint,lastPoint,overPoint,downItem,lastItem,overItem,dragItem,dblClick,clickTime;return{_handleEvent:function(type,point,event){if(this._eventCounters[type]){var project=this._project,hit=project.hitTest(point,{tolerance:this._scope.settings.hitTolerance,fill:!0,stroke:!0}),item=hit&&hit.item,stopped=!1;switch(type){case"mousedown":for(stopped=callEvent(this,type,event,point,item),dblClick=lastItem==item&&Date.now()-clickTime<300,downItem=lastItem=item,downPoint=lastPoint=overPoint=point,dragItem=!stopped&&item;dragItem&&!dragItem.responds("mousedrag");)dragItem=dragItem._parent;break;case"mouseup":stopped=callEvent(this,type,event,point,item,downPoint),dragItem&&(lastPoint&&!lastPoint.equals(point)&&callEvent(this,"mousedrag",event,point,dragItem,lastPoint),item!==dragItem&&(overPoint=point,callEvent(this,"mousemove",event,point,item,overPoint))),!stopped&&item&&item===downItem&&(clickTime=Date.now(),callEvent(this,dblClick&&downItem.responds("doubleclick")?"doubleclick":"click",event,downPoint,item),dblClick=!1),downItem=dragItem=null;break;case"mousemove":dragItem&&(stopped=callEvent(this,"mousedrag",event,point,dragItem,lastPoint)),stopped||(item!==overItem&&(overPoint=point),stopped=callEvent(this,type,event,point,item,overPoint)),lastPoint=overPoint=point,item!==overItem&&(callEvent(this,"mouseleave",event,point,overItem),overItem=item,callEvent(this,"mouseenter",event,point,item))}return stopped}}}}),Event=Base.extend({_class:"Event",initialize:function(event){this.event=event},isPrevented:!1,isStopped:!1,preventDefault:function(){this.isPrevented=!0,this.event.preventDefault()},stopPropagation:function(){this.isStopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getModifiers:function(){return Key.modifiers}}),KeyEvent=Event.extend({_class:"KeyEvent",initialize:function(down,key,character,event){Event.call(this,event),this.type=down?"keydown":"keyup",this.key=key,this.character=character},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Key=new function(){function handleKey(down,keyCode,charCode,event){var name,character=charCode?String.fromCharCode(charCode):"",specialKey=specialKeys[keyCode],key=specialKey||character.toLowerCase(),type=down?"keydown":"keyup",view=View._focused,scope=view&&view.isVisible()&&view._scope,tool=scope&&scope.tool;keyMap[key]=down,specialKey&&(name=Base.camelize(specialKey))in modifiers&&(modifiers[name]=down),down?charCodeMap[keyCode]=charCode:delete charCodeMap[keyCode],tool&&tool.responds(type)&&(paper=scope,tool.fire(type,new KeyEvent(down,key,character,event)),view&&view.update())}var downCode,specialKeys={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},specialChars={9:!0,13:!0,32:!0},modifiers=new Base({shift:!1,control:!1,option:!1,command:!1,capsLock:!1,space:!1}),charCodeMap={},keyMap={};return DomEvent.add(document,{keydown:function(event){var code=event.which||event.keyCode;code in specialKeys||modifiers.command?handleKey(!0,code,code in specialChars||modifiers.command?code:0,event):downCode=code},keypress:function(event){null!=downCode&&(handleKey(!0,downCode,event.which||event.keyCode,event),downCode=null)},keyup:function(event){var code=event.which||event.keyCode;code in charCodeMap&&handleKey(!1,code,charCodeMap[code],event)}}),DomEvent.add(window,{blur:function(event){for(var code in charCodeMap)handleKey(!1,code,charCodeMap[code],event)}}),{modifiers:modifiers,isDown:function(key){return!!keyMap[key]}}},MouseEvent=Event.extend({_class:"MouseEvent",initialize:function(type,event,point,target,delta){Event.call(this,event),this.type=type,this.point=point,this.target=target,this.delta=delta},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}});Base.extend(Callback,{_class:"Palette",_events:["onChange"],initialize:function(title,components,values){var parent=DomElement.find(".palettejs-panel")||DomElement.find("body").appendChild(DomElement.create("div",{"class":"palettejs-panel"}));this._element=parent.appendChild(DomElement.create("table",{"class":"palettejs-pane"})),this._title=title,values||(values={});for(var name in this.components=components){var component=components[name];component instanceof Component||(null==component.value&&(component.value=values[name]),component.name=name,component=components[name]=new Component(component)),this._element.appendChild(component._element),component._palette=this,values[name]===undefined&&(values[name]=component.value)}this.values=Base.each(values,function(value,name){var component=components[name];component&&Base.define(values,name,{enumerable:!0,configurable:!0,get:function(){return component._value},set:function(val){component.setValue(val)}})}),window.paper&&paper.palettes.push(this)},reset:function(){for(var i in this.components)this.components[i].reset()},remove:function(){DomElement.remove(this._element)}});var Component=Base.extend(Callback,{_class:"Component",_events:["onChange","onClick"],_types:{"boolean":{type:"checkbox",value:"checked"},string:{type:"text"},number:{type:"number",number:!0},button:{type:"button"},text:{tag:"div",value:"text"},slider:{type:"range",number:!0},list:{tag:"select",setOptions:function(){DomElement.removeChildren(this._input),DomElement.create(Base.each(this._options,function(option){this.push("option",{value:option,text:option})},[]),this._input)}},color:{type:"color",getValue:function(value){return new Color(value)},setValue:function(value){return new Color(value).toCSS("color"===DomElement.get(this._input,"type"))}}},initialize:function Component(obj){this._id=Component._id=(Component._id||0)+1,this._type=obj.type in this._types?obj.type:"options"in obj?"list":"onClick"in obj?"button":typeof obj.value,this._meta=this._types[this._type]||{type:this._type};var that=this,id="component-"+this._id;this._dontFire=!0,this._input=DomElement.create(this._meta.tag||"input",{id:id,type:this._meta.type,events:{change:function(){that.setValue(DomElement.get(this,that._meta.value||"value"))},click:function(){that.fire("click")}}}),this.attach("change",function(value){this._dontFire||this._palette.fire("change",this,this.name,value)}),this._element=DomElement.create("tr",["td",[this._label=DomElement.create("label",{"for":id})],"td",[this._input]]),Base.each(obj,function(value,key){this[key]=value},this),this._defaultValue=this._value,this._dontFire=!1},getType:function(){return this._type},getLabel:function(){return this.__label},setLabel:function(label){this.__label=label,DomElement.set(this._label,"text",label+":")},getOptions:function(){return this._options},setOptions:function(options){this._options=options;var setOptions=this._meta.setOptions;setOptions&&setOptions.call(this)},getValue:function(){var value=this._value,getValue=this._meta.getValue;return getValue?getValue.call(this,value):value},setValue:function(value){var key=this._meta.value||"value",setValue=this._meta.setValue;setValue&&(value=setValue.call(this,value)),DomElement.set(this._input,key,value),value=DomElement.get(this._input,key),this._meta.number&&(value=parseFloat(value,10)),this._value!==value&&(this._value=value,this._dontFire||this.fire("change",this.getValue()))},getRange:function(){return[parseFloat(DomElement.get(this._input,"min")),parseFloat(DomElement.get(this._input,"max"))]},setRange:function(min,max){var range=Array.isArray(min)?min:[min,max];DomElement.set(this._input,{min:range[0],max:range[1]})},getMin:function(){return this.getRange()[0]},setMin:function(min){this.setRange(min,this.getMax())},getMax:function(){return this.getRange()[1]},setMax:function(max){this.setRange(this.getMin(),max)},getStep:function(){return parseFloat(DomElement.get(this._input,"step"))},setStep:function(step){DomElement.set(this._input,"step",step)},reset:function(){this.setValue(this._defaultValue)}}),ToolEvent=Event.extend({_class:"ToolEvent",_item:null,initialize:function(tool,type,event){this.tool=tool,this.type=type,this.event=event},_choosePoint:function(point,toolPoint){return point?point:toolPoint?toolPoint.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(point){this._point=point},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(lastPoint){this._lastPoint=lastPoint},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(downPoint){this._downPoint=downPoint},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(middlePoint){this._middlePoint=middlePoint},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(delta){this._delta=delta},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(count){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=count},getItem:function(){if(!this._item){var result=this.tool._scope.project.hitTest(this.getPoint());if(result){for(var item=result.item,parent=item._parent;/^(Group|CompoundPath)$/.test(parent._class);)item=parent,parent=parent._parent;this._item=item}}return this._item},setItem:function(item){this._item=item},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Tool=PaperScopeItem.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(props){PaperScopeItem.call(this),this._firstMove=!0,this._count=0,this._downCount=0,this._set(props)},getMinDistance:function(){return this._minDistance},setMinDistance:function(minDistance){this._minDistance=minDistance,null!=this._minDistance&&null!=this._maxDistance&&this._minDistance>this._maxDistance&&(this._maxDistance=this._minDistance)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(maxDistance){this._maxDistance=maxDistance,null!=this._minDistance&&null!=this._maxDistance&&this._maxDistance<this._minDistance&&(this._minDistance=maxDistance)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(distance){this._minDistance=distance,this._maxDistance=distance},_updateEvent:function(type,point,minDistance,maxDistance,start,needsChange,matchMaxDistance){if(!start){if(null!=minDistance||null!=maxDistance){var minDist=null!=minDistance?minDistance:0,vector=point.subtract(this._point),distance=vector.getLength();if(minDist>distance)return!1;var maxDist=null!=maxDistance?maxDistance:0;if(0!=maxDist)if(distance>maxDist)point=this._point.add(vector.normalize(maxDist));else if(matchMaxDistance)return!1}if(needsChange&&point.equals(this._point))return!1}switch(this._lastPoint=start&&"mousemove"==type?point:this._point,this._point=point,type){case"mousedown":this._lastPoint=this._downPoint,this._downPoint=this._point,this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint}return this._count=start?0:this._count+1,!0},_fireEvent:function(type,event){var sets=paper.project._removeSets;if(sets){"mouseup"===type&&(sets.mousedrag=null);var set=sets[type];if(set){for(var id in set){var item=set[id];for(var key in sets){var other=sets[key];other&&other!=set&&delete other[item._id]}item.remove()}sets[type]=null}}return this.responds(type)&&this.fire(type,new ToolEvent(this,type,event))},_handleEvent:function(type,point,event){paper=this._scope;var called=!1;switch(type){case"mousedown":this._updateEvent(type,point,null,null,!0,!1,!1),called=this._fireEvent(type,event);break;case"mousedrag":for(var needsChange=!1,matchMaxDistance=!1;this._updateEvent(type,point,this.minDistance,this.maxDistance,!1,needsChange,matchMaxDistance);)called=this._fireEvent(type,event)||called,needsChange=!0,matchMaxDistance=!0;break;case"mouseup":!point.equals(this._point)&&this._updateEvent("mousedrag",point,this.minDistance,this.maxDistance,!1,!1,!1)&&(called=this._fireEvent("mousedrag",event)),this._updateEvent(type,point,null,this.maxDistance,!1,!1,!1),called=this._fireEvent(type,event)||called,this._updateEvent(type,point,null,null,!0,!1,!1),this._firstMove=!0;break;case"mousemove":for(;this._updateEvent(type,point,this.minDistance,this.maxDistance,this._firstMove,!0,!1);)called=this._fireEvent(type,event)||called,this._firstMove=!1}return called&&event.preventDefault(),called}}),Http={request:function(method,url,callback){var xhr=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");return xhr.open(method.toUpperCase(),url,!0),"overrideMimeType"in xhr&&xhr.overrideMimeType("text/plain"),xhr.onreadystatechange=function(){if(4===xhr.readyState){var status=xhr.status;if(0!==status&&200!==status)throw new Error("Could not load "+url+" (Error "+status+")");callback.call(xhr,xhr.responseText)}},xhr.send(null)}},CanvasProvider={canvases:[],getCanvas:function(width,height,pixelRatio){var canvas,init=!0;"object"==typeof width&&(pixelRatio=height,height=width.height,width=width.width),pixelRatio?1!==pixelRatio&&(width*=pixelRatio,height*=pixelRatio):pixelRatio=1,canvas=this.canvases.length?this.canvases.pop():document.createElement("canvas");var ctx=canvas.getContext("2d");return canvas.width===width&&canvas.height===height?init&&ctx.clearRect(0,0,width+1,height+1):(canvas.width=width,canvas.height=height),ctx.save(),1!==pixelRatio&&ctx.scale(pixelRatio,pixelRatio),canvas},getContext:function(width,height,pixelRatio){return this.getCanvas(width,height,pixelRatio).getContext("2d")},release:function(obj){var canvas=obj.canvas?obj.canvas:obj;canvas.getContext("2d").restore(),this.canvases.push(canvas)}},BlendMode=new function(){function getLum(r,g,b){return.2989*r+.587*g+.114*b}function setLum(r,g,b,l){var d=l-getLum(r,g,b);dr=r+d,dg=g+d,db=b+d;var l=getLum(dr,dg,db),mn=min(dr,dg,db),mx=max(dr,dg,db);if(0>mn){var lmn=l-mn;dr=l+(dr-l)*l/lmn,dg=l+(dg-l)*l/lmn,db=l+(db-l)*l/lmn}if(mx>255){var ln=255-l,mxl=mx-l;dr=l+(dr-l)*ln/mxl,dg=l+(dg-l)*ln/mxl,db=l+(db-l)*ln/mxl}}function getSat(r,g,b){return max(r,g,b)-min(r,g,b)}function setSat(r,g,b,s){var md,col=[r,g,b],mx=max(r,g,b),mn=min(r,g,b);mn=mn===r?0:mn===g?1:2,mx=mx===r?0:mx===g?1:2,md=0===min(mn,mx)?1===max(mn,mx)?2:1:0,col[mx]>col[mn]?(col[md]=(col[md]-col[mn])*s/(col[mx]-col[mn]),col[mx]=s):col[md]=col[mx]=0,col[mn]=0,dr=col[0],dg=col[1],db=col[2]}var sr,sg,sb,sa,br,bg,bb,ba,dr,dg,db,min=Math.min,max=Math.max,abs=Math.abs,modes={multiply:function(){dr=br*sr/255,dg=bg*sg/255,db=bb*sb/255},screen:function(){dr=br+sr-br*sr/255,dg=bg+sg-bg*sg/255,db=bb+sb-bb*sb/255},overlay:function(){dr=128>br?2*br*sr/255:255-2*(255-br)*(255-sr)/255,dg=128>bg?2*bg*sg/255:255-2*(255-bg)*(255-sg)/255,db=128>bb?2*bb*sb/255:255-2*(255-bb)*(255-sb)/255},"soft-light":function(){var t=sr*br/255;dr=t+br*(255-(255-br)*(255-sr)/255-t)/255,t=sg*bg/255,dg=t+bg*(255-(255-bg)*(255-sg)/255-t)/255,t=sb*bb/255,db=t+bb*(255-(255-bb)*(255-sb)/255-t)/255},"hard-light":function(){dr=128>sr?2*sr*br/255:255-2*(255-sr)*(255-br)/255,dg=128>sg?2*sg*bg/255:255-2*(255-sg)*(255-bg)/255,db=128>sb?2*sb*bb/255:255-2*(255-sb)*(255-bb)/255},"color-dodge":function(){dr=0===br?0:255===sr?255:min(255,255*br/(255-sr)),dg=0===bg?0:255===sg?255:min(255,255*bg/(255-sg)),db=0===bb?0:255===sb?255:min(255,255*bb/(255-sb))},"color-burn":function(){dr=255===br?255:0===sr?0:max(0,255-255*(255-br)/sr),dg=255===bg?255:0===sg?0:max(0,255-255*(255-bg)/sg),db=255===bb?255:0===sb?0:max(0,255-255*(255-bb)/sb)},darken:function(){dr=sr>br?br:sr,dg=sg>bg?bg:sg,db=sb>bb?bb:sb},lighten:function(){dr=br>sr?br:sr,dg=bg>sg?bg:sg,db=bb>sb?bb:sb},difference:function(){dr=br-sr,0>dr&&(dr=-dr),dg=bg-sg,0>dg&&(dg=-dg),db=bb-sb,0>db&&(db=-db)},exclusion:function(){dr=br+sr*(255-br-br)/255,dg=bg+sg*(255-bg-bg)/255,db=bb+sb*(255-bb-bb)/255},hue:function(){setSat(sr,sg,sb,getSat(br,bg,bb)),setLum(dr,dg,db,getLum(br,bg,bb))},saturation:function(){setSat(br,bg,bb,getSat(sr,sg,sb)),setLum(dr,dg,db,getLum(br,bg,bb))},luminosity:function(){setLum(br,bg,bb,getLum(sr,sg,sb))},color:function(){setLum(sr,sg,sb,getLum(br,bg,bb))},add:function(){dr=min(br+sr,255),dg=min(bg+sg,255),db=min(bb+sb,255)},subtract:function(){dr=max(br-sr,0),dg=max(bg-sg,0),db=max(bb-sb,0)},average:function(){dr=(br+sr)/2,dg=(bg+sg)/2,db=(bb+sb)/2},negation:function(){dr=255-abs(255-sr-br),dg=255-abs(255-sg-bg),db=255-abs(255-sb-bb)}},nativeModes=this.nativeModes=Base.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(mode){this[mode]=!0},{}),ctx=CanvasProvider.getContext(1,1);Base.each(modes,function(func,mode){var darken="darken"===mode,ok=!1;ctx.save();try{ctx.fillStyle=darken?"#300":"#a00",ctx.fillRect(0,0,1,1),ctx.globalCompositeOperation=mode,ctx.globalCompositeOperation===mode&&(ctx.fillStyle=darken?"#a00":"#300",ctx.fillRect(0,0,1,1),ok=ctx.getImageData(0,0,1,1).data[0]!==darken?170:51)}catch(e){}ctx.restore(),nativeModes[mode]=ok}),CanvasProvider.release(ctx),this.process=function(mode,srcContext,dstContext,alpha,offset){var srcCanvas=srcContext.canvas,normal="normal"===mode;if(normal||nativeModes[mode])dstContext.save(),dstContext.setTransform(1,0,0,1,0,0),dstContext.globalAlpha=alpha,normal||(dstContext.globalCompositeOperation=mode),dstContext.drawImage(srcCanvas,offset.x,offset.y),dstContext.restore();else{var process=modes[mode];if(!process)return;for(var dstData=dstContext.getImageData(offset.x,offset.y,srcCanvas.width,srcCanvas.height),dst=dstData.data,src=srcContext.getImageData(0,0,srcCanvas.width,srcCanvas.height).data,i=0,l=dst.length;l>i;i+=4){sr=src[i],br=dst[i],sg=src[i+1],bg=dst[i+1],sb=src[i+2],bb=dst[i+2],sa=src[i+3],ba=dst[i+3],process();var a1=sa*alpha/255,a2=1-a1;dst[i]=a1*dr+a2*br,dst[i+1]=a1*dg+a2*bg,dst[i+2]=a1*db+a2*bb,dst[i+3]=sa*alpha+a2*ba}dstContext.putImageData(dstData,offset.x,offset.y)}}},SVGStyles=Base.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","string"]},function(entry,key){var part=Base.capitalize(key),lookup=entry[2];this[key]={type:entry[1],property:key,attribute:entry[0],toSVG:lookup,fromSVG:lookup&&Base.each(lookup,function(value,name){this[value]=name},{}),get:"get"+part,set:"set"+part}},{}),SVGNamespaces={href:"http://www.w3.org/1999/xlink",xlink:"http://www.w3.org/2000/xmlns"};return new function(){function setAttributes(node,attrs){for(var key in attrs){var val=attrs[key],namespace=SVGNamespaces[key];
"number"==typeof val&&(val=formatter.number(val)),namespace?node.setAttributeNS(namespace,key,val):node.setAttribute(key,val)}return node}function createElement(tag,attrs){return setAttributes(document.createElementNS("http://www.w3.org/2000/svg",tag),attrs)}function getTransform(item,coordinates,center){var matrix=item._matrix,trans=matrix.getTranslation(),attrs={};if(coordinates){matrix=matrix.shiftless();var point=matrix._inverseTransform(trans);attrs[center?"cx":"x"]=point.x,attrs[center?"cy":"y"]=point.y,trans=null}if(!matrix.isIdentity()){var decomposed=matrix.decompose();if(decomposed&&!decomposed.shearing){var parts=[],angle=decomposed.rotation,scale=decomposed.scaling;trans&&!trans.isZero()&&parts.push("translate("+formatter.point(trans)+")"),angle&&parts.push("rotate("+formatter.number(angle)+")"),Numerical.isZero(scale.x-1)&&Numerical.isZero(scale.y-1)||parts.push("scale("+formatter.point(scale)+")"),attrs.transform=parts.join(" ")}else attrs.transform="matrix("+matrix.getValues().join(",")+")"}return attrs}function exportGroup(item,options){for(var attrs=getTransform(item),children=item._children,node=createElement("g",attrs),i=0,l=children.length;l>i;i++){var child=children[i],childNode=exportSVG(child,options);if(childNode)if(child.isClipMask()){var clip=createElement("clipPath");clip.appendChild(childNode),setDefinition(child,clip,"clip"),setAttributes(node,{"clip-path":"url(#"+clip.id+")"})}else node.appendChild(childNode)}return node}function exportRaster(item){var attrs=getTransform(item,!0),size=item.getSize();return attrs.x-=size.width/2,attrs.y-=size.height/2,attrs.width=size.width,attrs.height=size.height,attrs.href=item.toDataURL(),createElement("image",attrs)}function exportPath(item,options){if(options.matchShapes){var shape=item.toShape(!1);if(shape)return exportShape(shape,options)}var type,attrs,segments=item._segments;if(0===segments.length)return null;if(item.isPolygon())if(segments.length>=3){type=item._closed?"polygon":"polyline";var parts=[];for(i=0,l=segments.length;l>i;i++)parts.push(formatter.point(segments[i]._point));attrs={points:parts.join(" ")}}else{type="line";var first=segments[0]._point,last=segments[segments.length-1]._point;attrs={x1:first.x,y1:first.y,x2:last.x,y2:last.y}}else{type="path";var data=item.getPathData();attrs=data&&{d:data}}return createElement(type,attrs)}function exportShape(item){var type=item._type,radius=item._radius,attrs=getTransform(item,!0,"rectangle"!==type);if("rectangle"===type){type="rect";var size=item._size,width=size.width,height=size.height;attrs.x-=width/2,attrs.y-=height/2,attrs.width=width,attrs.height=height,radius.isZero()&&(radius=null)}return radius&&("circle"===type?attrs.r=radius:(attrs.rx=radius.width,attrs.ry=radius.height)),createElement(type,attrs)}function exportCompoundPath(item){var attrs=getTransform(item,!0),data=item.getPathData();return data&&(attrs.d=data),createElement("path",attrs)}function exportPlacedSymbol(item,options){var attrs=getTransform(item,!0),symbol=item.getSymbol(),symbolNode=getDefinition(symbol,"symbol"),definition=symbol.getDefinition(),bounds=definition.getBounds();return symbolNode||(symbolNode=createElement("symbol",{viewBox:formatter.rectangle(bounds)}),symbolNode.appendChild(exportSVG(definition,options)),setDefinition(symbol,symbolNode,"symbol")),attrs.href="#"+symbolNode.id,attrs.x+=bounds.x,attrs.y+=bounds.y,attrs.width=formatter.number(bounds.width),attrs.height=formatter.number(bounds.height),createElement("use",attrs)}function exportGradient(color){var gradientNode=getDefinition(color,"color");if(!gradientNode){var attrs,gradient=color.getGradient(),radial=gradient._radial,origin=color.getOrigin().transform(),destination=color.getDestination().transform();if(radial){attrs={cx:origin.x,cy:origin.y,r:origin.getDistance(destination)};var highlight=color.getHighlight();highlight&&(highlight=highlight.transform(),attrs.fx=highlight.x,attrs.fy=highlight.y)}else attrs={x1:origin.x,y1:origin.y,x2:destination.x,y2:destination.y};attrs.gradientUnits="userSpaceOnUse",gradientNode=createElement((radial?"radial":"linear")+"Gradient",attrs);for(var stops=gradient._stops,i=0,l=stops.length;l>i;i++){var stop=stops[i],stopColor=stop._color,alpha=stopColor.getAlpha();attrs={offset:stop._rampPoint,"stop-color":stopColor.toCSS(!0)},1>alpha&&(attrs["stop-opacity"]=alpha),gradientNode.appendChild(createElement("stop",attrs))}setDefinition(color,gradientNode,"color")}return"url(#"+gradientNode.id+")"}function exportText(item){var node=createElement("text",getTransform(item,!0));return node.textContent=item._content,node}function applyStyle(item,node){var attrs={},parent=item.getParent();return null!=item._name&&(attrs.id=item._name),Base.each(SVGStyles,function(entry){var get=entry.get,type=entry.type,value=item[get]();if(!parent||!Base.equals(parent[get](),value)){if("color"===type&&null!=value){var alpha=value.getAlpha();1>alpha&&(attrs[entry.attribute+"-opacity"]=alpha)}attrs[entry.attribute]=null==value?"none":"number"===type?formatter.number(value):"color"===type?value.gradient?exportGradient(value,item):value.toCSS(!0):"array"===type?value.join(","):"lookup"===type?entry.toSVG[value]:value}}),1===attrs.opacity&&delete attrs.opacity,null==item._visibility||item._visibility||(attrs.visibility="hidden"),setAttributes(node,attrs)}function getDefinition(item,type){return definitions||(definitions={ids:{},svgs:{}}),item&&definitions.svgs[type+"-"+item._id]}function setDefinition(item,node,type){definitions||getDefinition();var id=definitions.ids[type]=(definitions.ids[type]||0)+1;node.id=type+"-"+id,definitions.svgs[type+"-"+item._id]=node}function exportDefinitions(node,options){var svg=node,defs=null;if(definitions){svg="svg"===node.nodeName.toLowerCase()&&node;for(var i in definitions.svgs)defs||(svg||(svg=createElement("svg"),svg.appendChild(node)),defs=svg.insertBefore(createElement("defs"),svg.firstChild)),defs.appendChild(definitions.svgs[i]);definitions=null}return options.asString?(new XMLSerializer).serializeToString(svg):svg}function exportSVG(item,options){var exporter=exporters[item._class],node=exporter&&exporter(item,options);if(node&&item._data){var data=JSON.stringify(item._data);"{}"!==data&&node.setAttribute("data-paper-data",data)}return node&&applyStyle(item,node)}function setOptions(options){return options||(options={}),formatter=new Formatter(options.precision),options}var formatter,definitions,exporters={Group:exportGroup,Layer:exportGroup,Raster:exportRaster,Path:exportPath,Shape:exportShape,CompoundPath:exportCompoundPath,PlacedSymbol:exportPlacedSymbol,PointText:exportText};Item.inject({exportSVG:function(options){return options=setOptions(options),exportDefinitions(exportSVG(this,options),options)}}),Project.inject({exportSVG:function(options){options=setOptions(options);for(var layers=this.layers,size=this.getView().getSize(),node=createElement("svg",{x:0,y:0,width:size.width,height:size.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),i=0,l=layers.length;l>i;i++)node.appendChild(exportSVG(layers[i],options));return exportDefinitions(node,options)}})},new function(){function getValue(node,name,isString,allowNull){var namespace=SVGNamespaces[name],value=namespace?node.getAttributeNS(namespace,name):node.getAttribute(name);return"null"===value&&(value=null),null==value?allowNull?null:isString?"":0:isString?value:parseFloat(value)}function getPoint(node,x,y,allowNull){return x=getValue(node,x,!1,allowNull),y=getValue(node,y,!1,allowNull),!allowNull||null!=x&&null!=y?new Point(x,y):null}function getSize(node,w,h,allowNull){return w=getValue(node,w,!1,allowNull),h=getValue(node,h,!1,allowNull),!allowNull||null!=w&&null!=h?new Size(w,h):null}function convertValue(value,type,lookup){return"none"===value?null:"number"===type?parseFloat(value):"array"===type?value?value.split(/[\s,]+/g).map(parseFloat):[]:"color"===type?getDefinition(value)||value:"lookup"===type?lookup[value]:value}function importGroup(node,type,isRoot,options){var nodes=node.childNodes,isClip="clippath"===type,item=new Group,project=item._project,currentStyle=project._currentStyle,children=[];isClip||(item=applyAttributes(item,node,isRoot),project._currentStyle=item._style.clone());for(var i=0,l=nodes.length;l>i;i++){var child,childNode=nodes[i];1!==childNode.nodeType||!(child=importSVG(childNode,!1,options))||child instanceof Symbol||children.push(child)}return item.addChildren(children),isClip&&(item=applyAttributes(item.reduce(),node,isRoot)),project._currentStyle=currentStyle,(isClip||"defs"===type)&&(item.remove(),item=null),item}function importPoly(node,type){for(var coords=node.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),points=[],i=0,l=coords.length;l>i;i+=2)points.push(new Point(parseFloat(coords[i]),parseFloat(coords[i+1])));var path=new Path(points);return"polygon"===type&&path.closePath(),path}function importPath(node){var data=node.getAttribute("d"),param={pathData:data};return data.match(/m/gi).length>1||/z\S+/i.test(data)?new CompoundPath(param):new Path(param)}function importGradient(node,type){var gradient,id=(getValue(node,"href",!0)||"").substring(1),isRadial="radialgradient"===type;if(id)gradient=definitions[id].getGradient();else{for(var nodes=node.childNodes,stops=[],i=0,l=nodes.length;l>i;i++){var child=nodes[i];1===child.nodeType&&stops.push(applyAttributes(new GradientStop,child))}gradient=new Gradient(stops,isRadial)}var origin,destination,highlight;return isRadial?(origin=getPoint(node,"cx","cy"),destination=origin.add(getValue(node,"r"),0),highlight=getPoint(node,"fx","fy",!0)):(origin=getPoint(node,"x1","y1"),destination=getPoint(node,"x2","y2")),applyAttributes(new Color(gradient,origin,destination,highlight),node),null}function applyTransform(item,value,name,node){for(var transforms=(node.getAttribute(name)||"").split(/\)\s*/g),matrix=new Matrix,i=0,l=transforms.length;l>i;i++){var transform=transforms[i];if(!transform)break;for(var parts=transform.split("("),command=parts[0],v=parts[1].split(/[\s,]+/g),j=0,m=v.length;m>j;j++)v[j]=parseFloat(v[j]);switch(command){case"matrix":matrix.concatenate(new Matrix(v[0],v[1],v[2],v[3],v[4],v[5]));break;case"rotate":matrix.rotate(v[0],v[1],v[2]);break;case"translate":matrix.translate(v[0],v[1]);break;case"scale":matrix.scale(v);break;case"skewX":matrix.skew(v[0],0);break;case"skewY":matrix.skew(0,v[0])}}item.transform(matrix)}function applyOpacity(item,value,name){var color=item["fill-opacity"===name?"getFillColor":"getStrokeColor"]();color&&color.setAlpha(parseFloat(value))}function getAttribute(node,name,styles){var attr=node.attributes[name],value=attr&&attr.value;if(!value){var style=Base.camelize(name);value=node.style[style],value||styles.node[style]===styles.parent[style]||(value=styles.node[style])}return value?"none"===value?null:value:undefined}function applyAttributes(item,node,isRoot){var styles={node:DomElement.getStyles(node)||{},parent:!isRoot&&DomElement.getStyles(node.parentNode)||{}};return Base.each(attributes,function(apply,name){var value=getAttribute(node,name,styles);value!==undefined&&(item=Base.pick(apply(item,value,name,node,styles),item))}),item}function getDefinition(value){var match=value&&value.match(/\((?:#|)([^)']+)/);return match&&definitions[match[1]]}function importSVG(source,isRoot,options){function onLoadCallback(svg){paper=scope;var item=importSVG(svg,isRoot,options),onLoad=options.onLoad,view=scope.project&&scope.getView();onLoad&&onLoad.call(this,item),view.update()}if(!source)return null;options?"function"==typeof options&&(options={onLoad:options}):options={};var node=source,scope=paper;if(isRoot)if("string"!=typeof source||/^.*</.test(source)){if("undefined"!=typeof File&&source instanceof File){var reader=new FileReader;return reader.onload=function(){onLoadCallback(reader.result)},reader.readAsText(source)}}else{if(node=document.getElementById(source),!node)return Http.request("get",source,onLoadCallback);source=null}if("string"==typeof source&&(node=(new DOMParser).parseFromString(source,"image/svg+xml")),!node.nodeName)throw new Error("Unsupported SVG source: "+source);var item,type=node.nodeName.toLowerCase(),importer=importers[type],data=node.getAttribute&&node.getAttribute("data-paper-data"),settings=scope.settings,prevApplyMatrix=settings.applyMatrix;return settings.applyMatrix=!1,item=importer&&importer(node,type,isRoot,options)||null,settings.applyMatrix=prevApplyMatrix,item&&(item instanceof Group||(item=applyAttributes(item,node,isRoot)),options.expandShapes&&item instanceof Shape&&(item.remove(),item=item.toPath()),data&&(item._data=JSON.parse(data))),isRoot&&(definitions={}),item}var importers={"#document":function(node,type,isRoot,options){for(var nodes=node.childNodes,i=0,l=nodes.length;l>i;i++){var child=nodes[i];if(1===child.nodeType){var next=child.nextSibling;document.body.appendChild(child);var item=importSVG(child,isRoot,options);return next?node.insertBefore(child,next):node.appendChild(child),item}}},g:importGroup,svg:importGroup,clippath:importGroup,polygon:importPoly,polyline:importPoly,path:importPath,lineargradient:importGradient,radialgradient:importGradient,image:function(node){var raster=new Raster(getValue(node,"href",!0));return raster.attach("load",function(){var size=getSize(node,"width","height");this.setSize(size);var center=this._matrix._transformPoint(getPoint(node,"x","y").add(size.divide(2)));this.translate(center)}),raster},symbol:function(node,type,isRoot,options){return new Symbol(importGroup(node,type,isRoot,options),!0)},defs:importGroup,use:function(node){var id=(getValue(node,"href",!0)||"").substring(1),definition=definitions[id],point=getPoint(node,"x","y");return definition?definition instanceof Symbol?definition.place(point):definition.clone().translate(point):null},circle:function(node){return new Shape.Circle(getPoint(node,"cx","cy"),getValue(node,"r"))},ellipse:function(node){return new Shape.Ellipse({center:getPoint(node,"cx","cy"),radius:getSize(node,"rx","ry")})},rect:function(node){var point=getPoint(node,"x","y"),size=getSize(node,"width","height"),radius=getSize(node,"rx","ry");return new Shape.Rectangle(new Rectangle(point,size),radius)},line:function(node){return new Path.Line(getPoint(node,"x1","y1"),getPoint(node,"x2","y2"))},text:function(node){var text=new PointText(getPoint(node,"x","y").add(getPoint(node,"dx","dy")));return text.setContent(node.textContent.trim()||""),text}},attributes=Base.each(SVGStyles,function(entry){this[entry.attribute]=function(item,value){if(item[entry.set](convertValue(value,entry.type,entry.fromSVG)),"color"===entry.type&&item instanceof Shape){var color=item[entry.get]();color&&color.transform((new Matrix).translate(item.getPosition(!0).negate()))}}},{id:function(item,value){definitions[value]=item,item.setName&&item.setName(value)},"clip-path":function(item,value){var clip=getDefinition(value);if(clip){if(clip=clip.clone(),clip.setClipMask(!0),!(item instanceof Group))return new Group(clip,item);item.insertChild(0,clip)}},gradientTransform:applyTransform,transform:applyTransform,"fill-opacity":applyOpacity,"stroke-opacity":applyOpacity,visibility:function(item,value){item.setVisible("visible"===value)},"stop-color":function(item,value){item.setColor&&item.setColor(value)},"stop-opacity":function(item,value){item._color&&item._color.setAlpha(parseFloat(value))},offset:function(item,value){var percentage=value.match(/(.*)%$/);item.setRampPoint(percentage?percentage[1]/100:parseFloat(value))},viewBox:function(item,value,name,node,styles){var rect=new Rectangle(convertValue(value,"array")),size=getSize(node,"width","height",!0);if(item instanceof Group){var scale=size?rect.getSize().divide(size):1,matrix=(new Matrix).translate(rect.getPoint()).scale(scale);item.transform(matrix.inverted())}else if(item instanceof Symbol){size&&rect.setSize(size);var clip="visible"!=getAttribute(node,"overflow",styles),group=item._definition;clip&&!rect.contains(group.getBounds())&&(clip=new Shape.Rectangle(rect).transform(group._matrix),clip.setClipMask(!0),group.addChild(clip))}}}),definitions={};Item.inject({importSVG:function(node,options){return this.addChild(importSVG(node,!0,options))}}),Project.inject({importSVG:function(node,options){return this.activate(),importSVG(node,!0,options)}})},Base.exports.PaperScript=function(){function _$_(left,operator,right){var handler=binaryOperators[operator];if(left&&left[handler]){var res=left[handler](right);return"!="===operator?!res:res}switch(operator){case"+":return left+right;case"-":return left-right;case"*":return left*right;case"/":return left/right;case"%":return left%right;case"==":return left==right;case"!=":return left!=right}}function $_(operator,value){var handler=unaryOperators[operator];if(handler&&value&&value[handler])return value[handler]();switch(operator){case"+":return+value;case"-":return-value}}function compile(code){function getOffset(offset){for(var i=0,l=insertions.length;l>i;i++){var insertion=insertions[i];if(insertion[0]>=offset)break;offset+=insertion[1]}return offset}function getCode(node){return code.substring(getOffset(node.range[0]),getOffset(node.range[1]))}function replaceCode(node,str){for(var start=getOffset(node.range[0]),end=getOffset(node.range[1]),insert=0,i=insertions.length-1;i>=0;i--)if(start>insertions[i][0]){insert=i+1;break}insertions.splice(insert,0,[start,str.length-end+start]),code=code.substring(0,start)+str+code.substring(end)}function walkAST(node,parent){if(node){for(var key in node)if("range"!==key){var value=node[key];if(Array.isArray(value))for(var i=0,l=value.length;l>i;i++)walkAST(value[i],node);else value&&"object"==typeof value&&walkAST(value,node)}switch(node&&node.type){case"UnaryExpression":if(node.operator in unaryOperators&&"Literal"!==node.argument.type){var arg=getCode(node.argument);replaceCode(node,'$_("'+node.operator+'", '+arg+")")}break;case"BinaryExpression":if(node.operator in binaryOperators&&"Literal"!==node.left.type){var left=getCode(node.left),right=getCode(node.right);replaceCode(node,"_$_("+left+', "'+node.operator+'", '+right+")")}break;case"UpdateExpression":case"AssignmentExpression":if(!parent||!("ForStatement"===parent.type||"BinaryExpression"===parent.type&&/^[=!<>]/.test(parent.operator)||"MemberExpression"===parent.type&&parent.computed))if("UpdateExpression"===node.type){if(!node.prefix){var arg=getCode(node.argument);replaceCode(node,arg+" = _$_("+arg+', "'+node.operator[0]+'", 1)')}}else if(/^.=$/.test(node.operator)&&"Literal"!==node.left.type){var left=getCode(node.left),right=getCode(node.right);replaceCode(node,left+" = _$_("+left+', "'+node.operator[0]+'", '+right+")")}}}}var insertions=[];return walkAST(scope.acorn.parse(code,{ranges:!0})),code}function execute(code,scope){function expose(scope,hidden){for(var key in scope)!hidden&&/^_/.test(key)||!new RegExp("\\b"+key.replace(/\$/g,"\\$")+"\\b").test(code)||(params.push(key),args.push(scope[key]))}paper=scope;var func,view=scope.getView(),tool=/\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(code)?new Tool:null,toolHandlers=tool?tool._events:[],handlers=["onFrame","onResize"].concat(toolHandlers),params=[],args=[];code=compile(code),expose({_$_:_$_,$_:$_,view:view,tool:tool},!0),expose(scope),handlers=Base.each(handlers,function(key){new RegExp("\\s+"+key+"\\b").test(code)&&(params.push(key),this.push(key+": "+key))},[]).join(", "),handlers&&(code+="\nreturn { "+handlers+" };");var firefox=window.InstallTrigger;if(firefox||window.chrome){var script=document.createElement("script"),head=document.head;firefox&&(code="\n"+code),script.appendChild(document.createTextNode("paper._execute = function("+params+") {"+code+"\n}")),head.appendChild(script),func=paper._execute,delete paper._execute,head.removeChild(script)}else func=Function(params,code);var res=func.apply(scope,args)||{};Base.each(toolHandlers,function(key){var value=res[key];value&&(tool[key]=value)}),view&&(res.onResize&&view.setOnResize(res.onResize),view.fire("resize",{size:view.size,delta:new Point}),res.onFrame&&view.setOnFrame(res.onFrame),view.update())}function load(){Base.each(document.getElementsByTagName("script"),function(script){if(/^text\/(?:x-|)paperscript$/.test(script.type)&&!script.getAttribute("data-paper-ignore")){var canvas=PaperScope.getAttribute(script,"canvas"),scope=PaperScope.get(canvas)||new PaperScope(script).setup(canvas),src=script.src;src?Http.request("get",src,function(code){execute(code,scope)}):execute(script.innerHTML,scope),script.setAttribute("data-paper-ignore",!0)}},this)}var exports,define,scope=this;!function(e,r){return"object"==typeof exports&&"object"==typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):void r(e.acorn||(e.acorn={}))}(this,function(e){"use strict";function r(e){fr=e||{};for(var r in hr)Object.prototype.hasOwnProperty.call(fr,r)||(fr[r]=hr[r]);mr=fr.sourceFile||null}function t(e,r){var t=vr(pr,e);r+=" ("+t.line+":"+t.column+")";var n=new SyntaxError(r);throw n.pos=e,n.loc=t,n.raisedAt=br,n}function n(e){function r(e){if(1==e.length)return t+="return str === "+JSON.stringify(e[0])+";";t+="switch(str){";for(var r=0;r<e.length;++r)t+="case "+JSON.stringify(e[r])+":";t+="return true}return false;"}e=e.split(" ");var t="",n=[];e:for(var a=0;a<e.length;++a){for(var o=0;o<n.length;++o)if(n[o][0].length==e[a].length){n[o].push(e[a]);continue e}n.push([e[a]])}if(n.length>3){n.sort(function(e,r){return r.length-e.length}),t+="switch(str.length){";for(var a=0;a<n.length;++a){var i=n[a];t+="case "+i[0].length+":",r(i)}t+="}"}else r(e);return new Function("str",t)}function a(){this.line=Ar,this.column=br-Sr}function o(){Ar=1,br=Sr=0,Er=!0,u()}function i(e,r){gr=br,fr.locations&&(kr=new a),wr=e,u(),Cr=r,Er=e.beforeExpr}function s(){var e=fr.onComment&&fr.locations&&new a,r=br,n=pr.indexOf("*/",br+=2);if(-1===n&&t(br-2,"Unterminated comment"),br=n+2,fr.locations){Kt.lastIndex=r;for(var o;(o=Kt.exec(pr))&&o.index<br;)++Ar,Sr=o.index+o[0].length}fr.onComment&&fr.onComment(!0,pr.slice(r+2,n),r,br,e,fr.locations&&new a)}function c(){for(var e=br,r=fr.onComment&&fr.locations&&new a,t=pr.charCodeAt(br+=2);dr>br&&10!==t&&13!==t&&8232!==t&&8329!==t;)++br,t=pr.charCodeAt(br);fr.onComment&&fr.onComment(!1,pr.slice(e+2,br),e,br,r,fr.locations&&new a)}function u(){for(;dr>br;){var e=pr.charCodeAt(br);if(32===e)++br;else if(13===e){++br;var r=pr.charCodeAt(br);10===r&&++br,fr.locations&&(++Ar,Sr=br)}else if(10===e)++br,++Ar,Sr=br;else if(14>e&&e>8)++br;else if(47===e){var r=pr.charCodeAt(br+1);if(42===r)s();else{if(47!==r)break;c()}}else if(160===e)++br;else{if(!(e>=5760&&Jt.test(String.fromCharCode(e))))break;++br}}}function l(){var e=pr.charCodeAt(br+1);return e>=48&&57>=e?E(!0):(++br,i(xt))}function f(){var e=pr.charCodeAt(br+1);return Er?(++br,k()):61===e?x(Et,2):x(wt,1)}function p(){var e=pr.charCodeAt(br+1);return 61===e?x(Et,2):x(Ft,1)}function d(e){var r=pr.charCodeAt(br+1);return r===e?x(124===e?Lt:Ut,2):61===r?x(Et,2):x(124===e?Rt:Vt,1)}function m(){var e=pr.charCodeAt(br+1);return 61===e?x(Et,2):x(Tt,1)}function h(e){var r=pr.charCodeAt(br+1);return r===e?x(St,2):61===r?x(Et,2):x(At,1)}function v(e){var r=pr.charCodeAt(br+1),t=1;return r===e?(t=62===e&&62===pr.charCodeAt(br+2)?3:2,61===pr.charCodeAt(br+t)?x(Et,t+1):x(jt,t)):(61===r&&(t=61===pr.charCodeAt(br+2)?3:2),x(Ot,t))}function b(e){var r=pr.charCodeAt(br+1);return 61===r?x(qt,61===pr.charCodeAt(br+2)?3:2):x(61===e?Ct:It,1)}function y(e){switch(e){case 46:return l();case 40:return++br,i(ht);case 41:return++br,i(vt);case 59:return++br,i(yt);case 44:return++br,i(bt);case 91:return++br,i(ft);case 93:return++br,i(pt);case 123:return++br,i(dt);case 125:return++br,i(mt);case 58:return++br,i(gt);case 63:return++br,i(kt);case 48:var r=pr.charCodeAt(br+1);if(120===r||88===r)return C();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return E(!1);case 34:case 39:return A(e);case 47:return f(e);case 37:case 42:return p();case 124:case 38:return d(e);case 94:return m();case 43:case 45:return h(e);case 60:case 62:return v(e);case 61:case 33:return b(e);case 126:return x(It,1)}return!1}function g(e){if(e?br=yr+1:yr=br,fr.locations&&(xr=new a),e)return k();if(br>=dr)return i(Br);var r=pr.charCodeAt(br);if(Qt(r)||92===r)return L();var n=y(r);if(n===!1){var o=String.fromCharCode(r);if("\\"===o||$t.test(o))return L();t(br,"Unexpected character '"+o+"'")}return n}function x(e,r){var t=pr.slice(br,br+r);br+=r,i(e,t)}function k(){for(var e,r,n="",a=br;;){br>=dr&&t(a,"Unterminated regular expression");var o=pr.charAt(br);if(Gt.test(o)&&t(a,"Unterminated regular expression"),e)e=!1;else{if("["===o)r=!0;else if("]"===o&&r)r=!1;else if("/"===o&&!r)break;e="\\"===o}++br}var n=pr.slice(a,br);++br;var s=I();return s&&!/^[gmsiy]*$/.test(s)&&t(a,"Invalid regexp flag"),i(jr,new RegExp(n,s))}function w(e,r){for(var t=br,n=0,a=0,o=null==r?1/0:r;o>a;++a){var i,s=pr.charCodeAt(br);if(i=s>=97?s-97+10:s>=65?s-65+10:s>=48&&57>=s?s-48:1/0,i>=e)break;++br,n=n*e+i}return br===t||null!=r&&br-t!==r?null:n}function C(){br+=2;var e=w(16);return null==e&&t(yr+2,"Expected hexadecimal number"),Qt(pr.charCodeAt(br))&&t(br,"Identifier directly after number"),i(Or,e)}function E(e){var r=br,n=!1,a=48===pr.charCodeAt(br);e||null!==w(10)||t(r,"Invalid number"),46===pr.charCodeAt(br)&&(++br,w(10),n=!0);var o=pr.charCodeAt(br);(69===o||101===o)&&(o=pr.charCodeAt(++br),(43===o||45===o)&&++br,null===w(10)&&t(r,"Invalid number"),n=!0),Qt(pr.charCodeAt(br))&&t(br,"Identifier directly after number");var s,c=pr.slice(r,br);return n?s=parseFloat(c):a&&1!==c.length?/[89]/.test(c)||Vr?t(r,"Invalid number"):s=parseInt(c,8):s=parseInt(c,10),i(Or,s)}function A(e){br++;for(var r="";;){br>=dr&&t(yr,"Unterminated string constant");var n=pr.charCodeAt(br);if(n===e)return++br,i(Fr,r);if(92===n){n=pr.charCodeAt(++br);var a=/^[0-7]+/.exec(pr.slice(br,br+3));for(a&&(a=a[0]);a&&parseInt(a,8)>255;)a=a.slice(0,a.length-1);if("0"===a&&(a=null),++br,a)Vr&&t(br-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(a,8)),br+=a.length-1;else switch(n){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(S(2));break;case 117:r+=String.fromCharCode(S(4));break;case 85:r+=String.fromCharCode(S(8));break;case 116:r+="	";break;case 98:r+="\b";break;case 118:r+="";break;case 102:r+="\f";break;case 48:r+="\x00";break;case 13:10===pr.charCodeAt(br)&&++br;case 10:fr.locations&&(Sr=br,++Ar);break;default:r+=String.fromCharCode(n)}}else(13===n||10===n||8232===n||8329===n)&&t(yr,"Unterminated string constant"),r+=String.fromCharCode(n),++br}}function S(e){var r=w(16,e);return null===r&&t(yr,"Bad character escape sequence"),r}function I(){Bt=!1;for(var e,r=!0,n=br;;){var a=pr.charCodeAt(br);if(Yt(a))Bt&&(e+=pr.charAt(br)),++br;else{if(92!==a)break;Bt||(e=pr.slice(n,br)),Bt=!0,117!=pr.charCodeAt(++br)&&t(br,"Expecting Unicode escape sequence \\uXXXX"),++br;var o=S(4),i=String.fromCharCode(o);i||t(br-1,"Invalid Unicode escape"),(r?Qt(o):Yt(o))||t(br-4,"Invalid Unicode escape"),e+=i}r=!1}return Bt?e:pr.slice(n,br)}function L(){var e=I(),r=Dr;return Bt||(Wt(e)?r=lt[e]:(fr.forbidReserved&&(3===fr.ecmaVersion?Mt:zt)(e)||Vr&&Xt(e))&&t(yr,"The keyword '"+e+"' is reserved")),i(r,e)}function U(){Ir=yr,Lr=gr,Ur=kr,g()}function R(e){for(Vr=e,br=Lr;Sr>br;)Sr=pr.lastIndexOf("\n",Sr-2)+1,--Ar;u(),g()}function T(){this.type=null,this.start=yr,this.end=null}function V(){this.start=xr,this.end=null,null!==mr&&(this.source=mr)}function q(){var e=new T;return fr.locations&&(e.loc=new V),fr.ranges&&(e.range=[yr,0]),e}function O(e){var r=new T;return r.start=e.start,fr.locations&&(r.loc=new V,r.loc.start=e.loc.start),fr.ranges&&(r.range=[e.range[0],0]),r}function j(e,r){return e.type=r,e.end=Lr,fr.locations&&(e.loc.end=Ur),fr.ranges&&(e.range[1]=Lr),e}function F(e){return fr.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function D(e){return wr===e?(U(),!0):void 0}function B(){return!fr.strictSemicolons&&(wr===Br||wr===mt||Gt.test(pr.slice(Lr,yr)))}function M(){D(yt)||B()||X()}function z(e){wr===e?U():X()}function X(){t(yr,"Unexpected token")}function N(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&t(e.start,"Assigning to rvalue"),Vr&&"Identifier"===e.type&&Nt(e.name)&&t(e.start,"Assigning to "+e.name+" in strict mode")}function W(e){Ir=Lr=br,fr.locations&&(Ur=new a),Rr=Vr=null,Tr=[],g();var r=e||q(),t=!0;for(e||(r.body=[]);wr!==Br;){var n=J();r.body.push(n),t&&F(n)&&R(!0),t=!1}return j(r,"Program")}function J(){wr===wt&&g(!0);var e=wr,r=q();switch(e){case Mr:case Nr:U();var n=e===Mr;D(yt)||B()?r.label=null:wr!==Dr?X():(r.label=lr(),M());for(var a=0;a<Tr.length;++a){var o=Tr[a];if(null==r.label||o.name===r.label.name){if(null!=o.kind&&(n||"loop"===o.kind))break;if(r.label&&n)break}}return a===Tr.length&&t(r.start,"Unsyntactic "+e.keyword),j(r,n?"BreakStatement":"ContinueStatement");case Wr:return U(),M(),j(r,"DebuggerStatement");case Pr:return U(),Tr.push(Zt),r.body=J(),Tr.pop(),z(tt),r.test=P(),M(),j(r,"DoWhileStatement");case _r:if(U(),Tr.push(Zt),z(ht),wr===yt)return $(r,null);if(wr===rt){var i=q();return U(),G(i,!0),1===i.declarations.length&&D(ut)?_(r,i):$(r,i)}var i=K(!1,!0);return D(ut)?(N(i),_(r,i)):$(r,i);case Gr:return U(),cr(r,!0);case Kr:return U(),r.test=P(),r.consequent=J(),r.alternate=D(Hr)?J():null,j(r,"IfStatement");case Qr:return Rr||t(yr,"'return' outside of function"),U(),D(yt)||B()?r.argument=null:(r.argument=K(),M()),j(r,"ReturnStatement");case Yr:U(),r.discriminant=P(),r.cases=[],z(dt),Tr.push(en);for(var s,c;wr!=mt;)if(wr===zr||wr===Jr){var u=wr===zr;s&&j(s,"SwitchCase"),r.cases.push(s=q()),s.consequent=[],U(),u?s.test=K():(c&&t(Ir,"Multiple default clauses"),c=!0,s.test=null),z(gt)}else s||X(),s.consequent.push(J());return s&&j(s,"SwitchCase"),U(),Tr.pop(),j(r,"SwitchStatement");case Zr:return U(),Gt.test(pr.slice(Lr,yr))&&t(Lr,"Illegal newline after throw"),r.argument=K(),M(),j(r,"ThrowStatement");case et:if(U(),r.block=H(),r.handler=null,wr===Xr){var l=q();U(),z(ht),l.param=lr(),Vr&&Nt(l.param.name)&&t(l.param.start,"Binding "+l.param.name+" in strict mode"),z(vt),l.guard=null,l.body=H(),r.handler=j(l,"CatchClause")}return r.guardedHandlers=qr,r.finalizer=D($r)?H():null,r.handler||r.finalizer||t(r.start,"Missing catch or finally clause"),j(r,"TryStatement");case rt:return U(),r=G(r),M(),r;case tt:return U(),r.test=P(),Tr.push(Zt),r.body=J(),Tr.pop(),j(r,"WhileStatement");case nt:return Vr&&t(yr,"'with' in strict mode"),U(),r.object=P(),r.body=J(),j(r,"WithStatement");case dt:return H();case yt:return U(),j(r,"EmptyStatement");default:var f=Cr,p=K();if(e===Dr&&"Identifier"===p.type&&D(gt)){for(var a=0;a<Tr.length;++a)Tr[a].name===f&&t(p.start,"Label '"+f+"' is already declared");var d=wr.isLoop?"loop":wr===Yr?"switch":null;return Tr.push({name:f,kind:d}),r.body=J(),Tr.pop(),r.label=p,j(r,"LabeledStatement")}return r.expression=p,M(),j(r,"ExpressionStatement")}}function P(){z(ht);var e=K();return z(vt),e}function H(e){var r,t=q(),n=!0,a=!1;for(t.body=[],z(dt);!D(mt);){var o=J();t.body.push(o),n&&e&&F(o)&&(r=a,R(a=!0)),n=!1}return a&&!r&&R(!1),j(t,"BlockStatement")}function $(e,r){return e.init=r,z(yt),e.test=wr===yt?null:K(),z(yt),e.update=wr===vt?null:K(),z(vt),e.body=J(),Tr.pop(),j(e,"ForStatement")}function _(e,r){return e.left=r,e.right=K(),z(vt),e.body=J(),Tr.pop(),j(e,"ForInStatement")}function G(e,r){for(e.declarations=[],e.kind="var";;){var n=q();if(n.id=lr(),Vr&&Nt(n.id.name)&&t(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=D(Ct)?K(!0,r):null,e.declarations.push(j(n,"VariableDeclarator")),!D(bt))break}return j(e,"VariableDeclaration")}function K(e,r){var t=Q(r);if(!e&&wr===bt){var n=O(t);for(n.expressions=[t];D(bt);)n.expressions.push(Q(r));return j(n,"SequenceExpression")}return t}function Q(e){var r=Y(e);if(wr.isAssign){var t=O(r);return t.operator=Cr,t.left=r,U(),t.right=Q(e),N(r),j(t,"AssignmentExpression")
}return r}function Y(e){var r=Z(e);if(D(kt)){var t=O(r);return t.test=r,t.consequent=K(!0),z(gt),t.alternate=K(!0,e),j(t,"ConditionalExpression")}return r}function Z(e){return er(rr(),-1,e)}function er(e,r,t){var n=wr.binop;if(null!=n&&(!t||wr!==ut)&&n>r){var a=O(e);a.left=e,a.operator=Cr,U(),a.right=er(rr(),n,t);var a=j(a,/&&|\|\|/.test(a.operator)?"LogicalExpression":"BinaryExpression");return er(a,r,t)}return e}function rr(){if(wr.prefix){var e=q(),r=wr.isUpdate;return e.operator=Cr,e.prefix=!0,U(),e.argument=rr(),r?N(e.argument):Vr&&"delete"===e.operator&&"Identifier"===e.argument.type&&t(e.start,"Deleting local variable in strict mode"),j(e,r?"UpdateExpression":"UnaryExpression")}for(var n=tr();wr.postfix&&!B();){var e=O(n);e.operator=Cr,e.prefix=!1,e.argument=n,N(n),U(),n=j(e,"UpdateExpression")}return n}function tr(){return nr(ar())}function nr(e,r){if(D(xt)){var t=O(e);return t.object=e,t.property=lr(!0),t.computed=!1,nr(j(t,"MemberExpression"),r)}if(D(ft)){var t=O(e);return t.object=e,t.property=K(),t.computed=!0,z(pt),nr(j(t,"MemberExpression"),r)}if(!r&&D(ht)){var t=O(e);return t.callee=e,t.arguments=ur(vt,!1),nr(j(t,"CallExpression"),r)}return e}function ar(){switch(wr){case ot:var e=q();return U(),j(e,"ThisExpression");case Dr:return lr();case Or:case Fr:case jr:var e=q();return e.value=Cr,e.raw=pr.slice(yr,gr),U(),j(e,"Literal");case it:case st:case ct:var e=q();return e.value=wr.atomValue,e.raw=wr.keyword,U(),j(e,"Literal");case ht:var r=xr,t=yr;U();var n=K();return n.start=t,n.end=gr,fr.locations&&(n.loc.start=r,n.loc.end=kr),fr.ranges&&(n.range=[t,gr]),z(vt),n;case ft:var e=q();return U(),e.elements=ur(pt,!0,!0),j(e,"ArrayExpression");case dt:return ir();case Gr:var e=q();return U(),cr(e,!1);case at:return or();default:X()}}function or(){var e=q();return U(),e.callee=nr(ar(),!0),e.arguments=D(ht)?ur(vt,!1):qr,j(e,"NewExpression")}function ir(){var e=q(),r=!0,n=!1;for(e.properties=[],U();!D(mt);){if(r)r=!1;else if(z(bt),fr.allowTrailingCommas&&D(mt))break;var a,o={key:sr()},i=!1;if(D(gt)?(o.value=K(!0),a=o.kind="init"):fr.ecmaVersion>=5&&"Identifier"===o.key.type&&("get"===o.key.name||"set"===o.key.name)?(i=n=!0,a=o.kind=o.key.name,o.key=sr(),wr!==ht&&X(),o.value=cr(q(),!1)):X(),"Identifier"===o.key.type&&(Vr||n))for(var s=0;s<e.properties.length;++s){var c=e.properties[s];if(c.key.name===o.key.name){var u=a==c.kind||i&&"init"===c.kind||"init"===a&&("get"===c.kind||"set"===c.kind);u&&!Vr&&"init"===a&&"init"===c.kind&&(u=!1),u&&t(o.key.start,"Redefinition of property")}}e.properties.push(o)}return j(e,"ObjectExpression")}function sr(){return wr===Or||wr===Fr?ar():lr(!0)}function cr(e,r){wr===Dr?e.id=lr():r?X():e.id=null,e.params=[];var n=!0;for(z(ht);!D(vt);)n?n=!1:z(bt),e.params.push(lr());var a=Rr,o=Tr;if(Rr=!0,Tr=[],e.body=H(!0),Rr=a,Tr=o,Vr||e.body.body.length&&F(e.body.body[0]))for(var i=e.id?-1:0;i<e.params.length;++i){var s=0>i?e.id:e.params[i];if((Xt(s.name)||Nt(s.name))&&t(s.start,"Defining '"+s.name+"' in strict mode"),i>=0)for(var c=0;i>c;++c)s.name===e.params[c].name&&t(s.start,"Argument name clash in strict mode")}return j(e,r?"FunctionDeclaration":"FunctionExpression")}function ur(e,r,t){for(var n=[],a=!0;!D(e);){if(a)a=!1;else if(z(bt),r&&fr.allowTrailingCommas&&D(e))break;n.push(t&&wr===bt?null:K(!0))}return n}function lr(e){var r=q();return r.name=wr===Dr?Cr:e&&!fr.forbidReserved&&wr.keyword||X(),U(),j(r,"Identifier")}e.version="0.3.2";var fr,pr,dr,mr;e.parse=function(e,t){return pr=String(e),dr=pr.length,r(t),o(),W(fr.program)};var hr=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},vr=e.getLineInfo=function(e,r){for(var t=1,n=0;;){Kt.lastIndex=n;var a=Kt.exec(e);if(!(a&&a.index<r))break;++t,n=a.index+a[0].length}return{line:t,column:r-n}};e.tokenize=function(e,t){function n(e){return g(e),a.start=yr,a.end=gr,a.startLoc=xr,a.endLoc=kr,a.type=wr,a.value=Cr,a}pr=String(e),dr=pr.length,r(t),o();var a={};return n.jumpTo=function(e,r){if(br=e,fr.locations){Ar=1,Sr=Kt.lastIndex=0;for(var t;(t=Kt.exec(pr))&&t.index<e;)++Ar,Sr=t.index+t[0].length}Er=r,u()},n};var br,yr,gr,xr,kr,wr,Cr,Er,Ar,Sr,Ir,Lr,Ur,Rr,Tr,Vr,qr=[],Or={type:"num"},jr={type:"regexp"},Fr={type:"string"},Dr={type:"name"},Br={type:"eof"},Mr={keyword:"break"},zr={keyword:"case",beforeExpr:!0},Xr={keyword:"catch"},Nr={keyword:"continue"},Wr={keyword:"debugger"},Jr={keyword:"default"},Pr={keyword:"do",isLoop:!0},Hr={keyword:"else",beforeExpr:!0},$r={keyword:"finally"},_r={keyword:"for",isLoop:!0},Gr={keyword:"function"},Kr={keyword:"if"},Qr={keyword:"return",beforeExpr:!0},Yr={keyword:"switch"},Zr={keyword:"throw",beforeExpr:!0},et={keyword:"try"},rt={keyword:"var"},tt={keyword:"while",isLoop:!0},nt={keyword:"with"},at={keyword:"new",beforeExpr:!0},ot={keyword:"this"},it={keyword:"null",atomValue:null},st={keyword:"true",atomValue:!0},ct={keyword:"false",atomValue:!1},ut={keyword:"in",binop:7,beforeExpr:!0},lt={"break":Mr,"case":zr,"catch":Xr,"continue":Nr,"debugger":Wr,"default":Jr,"do":Pr,"else":Hr,"finally":$r,"for":_r,"function":Gr,"if":Kr,"return":Qr,"switch":Yr,"throw":Zr,"try":et,"var":rt,"while":tt,"with":nt,"null":it,"true":st,"false":ct,"new":at,"in":ut,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":ot,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},ft={type:"[",beforeExpr:!0},pt={type:"]"},dt={type:"{",beforeExpr:!0},mt={type:"}"},ht={type:"(",beforeExpr:!0},vt={type:")"},bt={type:",",beforeExpr:!0},yt={type:";",beforeExpr:!0},gt={type:":",beforeExpr:!0},xt={type:"."},kt={type:"?",beforeExpr:!0},wt={binop:10,beforeExpr:!0},Ct={isAssign:!0,beforeExpr:!0},Et={isAssign:!0,beforeExpr:!0},At={binop:9,prefix:!0,beforeExpr:!0},St={postfix:!0,prefix:!0,isUpdate:!0},It={prefix:!0,beforeExpr:!0},Lt={binop:1,beforeExpr:!0},Ut={binop:2,beforeExpr:!0},Rt={binop:3,beforeExpr:!0},Tt={binop:4,beforeExpr:!0},Vt={binop:5,beforeExpr:!0},qt={binop:6,beforeExpr:!0},Ot={binop:7,beforeExpr:!0},jt={binop:8,beforeExpr:!0},Ft={binop:10,beforeExpr:!0};e.tokTypes={bracketL:ft,bracketR:pt,braceL:dt,braceR:mt,parenL:ht,parenR:vt,comma:bt,semi:yt,colon:gt,dot:xt,question:kt,slash:wt,eq:Ct,name:Dr,eof:Br,num:Or,regexp:jr,string:Fr};for(var Dt in lt)e.tokTypes["_"+Dt]=lt[Dt];var Bt,Mt=n("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),zt=n("class enum extends super const export import"),Xt=n("implements interface let package private protected public static yield"),Nt=n("eval arguments"),Wt=n("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Jt=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,Pt="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Ht="------------------------------------------------------------------------------------------------------------------------------------------",$t=new RegExp("["+Pt+"]"),_t=new RegExp("["+Pt+Ht+"]"),Gt=/[\n\r\u2028\u2029]/,Kt=/\r\n|[\n\r\u2028\u2029]/g,Qt=e.isIdentifierStart=function(e){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&$t.test(String.fromCharCode(e))},Yt=e.isIdentifierChar=function(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&_t.test(String.fromCharCode(e))},Zt={kind:"loop"},en={kind:"switch"}});var binaryOperators={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"equals","!=":"equals"},unaryOperators={"-":"__negate","+":null},fields=Base.each(["add","subtract","multiply","divide","modulo","negate"],function(name){this["__"+name]="#"+name},{});return Point.inject(fields),Size.inject(fields),Color.inject(fields),"complete"===document.readyState?setTimeout(load):DomEvent.add(window,{load:load}),{compile:compile,execute:execute,load:load,lineNumberBase:0}}.call(this),paper=new(PaperScope.inject(Base.exports,{enumerable:!0,Base:Base,Numerical:Numerical,DomElement:DomElement,DomEvent:DomEvent,Http:Http,Key:Key})),"function"==typeof define&&define.amd?define("paper",paper):"object"==typeof exports&&(module.exports=paper),paper}},{}],2:[function(require,module){var Backbone,GroupCollection,GroupModel,async,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),GroupModel=require("../models/group"),async=require("async"),GroupCollection=function(_super){function GroupCollection(){return GroupCollection.__super__.constructor.apply(this,arguments)}return __extends(GroupCollection,_super),GroupCollection.prototype.model=GroupModel,GroupCollection.prototype.comparator="position",GroupCollection.prototype.url="/groups",GroupCollection.prototype.belongsTo="recipes",GroupCollection.prototype.initialize=function(attrs,options){return null==attrs&&(attrs={}),null==options&&(options={}),this.app=options.app,options},GroupCollection.prototype.fetchRecursive=function(app,parent,parentCallback){return this.app=app,this.parent=parent,this.fetch({url:"/"+this.belongsTo+"/"+this.parent.get("id")+this.url,success:function(_this){return function(){var fetchTasks;return fetchTasks=[],_this.each(function(model){return fetchTasks.push(function(callback){return model.sounds.fetchRecursive(_this.app,model,callback)}),fetchTasks.push(function(callback2){return model.patterns.fetchRecursive(_this.app,model,callback2)})}),async.parallel(fetchTasks,parentCallback)}}(this)},{reset:!0})},GroupCollection}(Backbone.Collection),module.exports=GroupCollection},{"../models/group":7,async:27,backbone:31,underscore:34}],3:[function(require,module){var Backbone,PatternCollection,PatternModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),PatternModel=require("../models/pattern"),PatternCollection=function(_super){function PatternCollection(){return PatternCollection.__super__.constructor.apply(this,arguments)}return __extends(PatternCollection,_super),PatternCollection.prototype.initialize=function(models,options){return null==models&&(models={}),null==options&&(options={}),this.group=options.group,options},PatternCollection.prototype.comparator="position",PatternCollection.prototype.model=PatternModel,PatternCollection.prototype.belongsTo="groups",PatternCollection.prototype.url="/patterns",PatternCollection.prototype.fetchRecursive=function(app,parent,parentCallback){return this.app=app,this.parent=parent,this.fetch({url:"/"+this.belongsTo+"/"+this.parent.get("id")+this.url,success:function(_this){return function(collection,models){return parentCallback.call(_this,null,models)}}(this),group:this.parent},app,this.app,{reset:!0})},PatternCollection}(Backbone.Collection),module.exports=PatternCollection},{"../models/pattern":8,backbone:31,underscore:34}],4:[function(require,module){var Backbone,SoundCollection,SoundModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),SoundModel=require("../models/sound"),SoundCollection=function(_super){function SoundCollection(){return SoundCollection.__super__.constructor.apply(this,arguments)}return __extends(SoundCollection,_super),SoundCollection.prototype.initialize=function(models,options){return null==options&&(options={}),this.group=options.group,options},SoundCollection.prototype.model=SoundModel,SoundCollection.prototype.belongsTo="groups",SoundCollection.prototype.url="/sounds",SoundCollection.prototype.fetchRecursive=function(app,parent,parentCallback){return this.app=app,this.parent=parent,this.fetch({url:"/"+this.belongsTo+"/"+this.parent.get("id")+this.url,success:function(_this){return function(collection,models){return parentCallback.call(_this,null,models)}}(this)},{group:this.parent},app,this.app,{reset:!0})},SoundCollection}(Backbone.Collection),module.exports=SoundCollection},{"../models/sound":10,backbone:31,underscore:34}],5:[function(require){"use strict";window.Beet=window.Beet||require("./views/app")},{"./views/app":18}],6:[function(require,module){var Backbone,DisplayModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),DisplayModel=function(_super){function DisplayModel(){return DisplayModel.__super__.constructor.apply(this,arguments)}return __extends(DisplayModel,_super),DisplayModel.prototype.defaults={one:"Welcome",time:0},DisplayModel.prototype.initialize=function(){},DisplayModel}(Backbone.Model),module.exports=DisplayModel},{backbone:31,underscore:34}],7:[function(require,module){var Backbone,GroupModel,PatternCollection,SoundCollection,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),Backbone.NestedModel=require("backbone-nested").NestedModel,_=require("underscore"),SoundCollection=require("../collections/sound"),PatternCollection=require("../collections/pattern"),GroupModel=function(_super){function GroupModel(){return GroupModel.__super__.constructor.apply(this,arguments)}return __extends(GroupModel,_super),GroupModel.prototype.initialize=function(attrs,options){var _ref;return null==attrs&&(attrs={}),null==options&&(options={}),_ref=options.collection,this.app=_ref.app,this.pads=_ref.pads,this.sounds=new SoundCollection(attrs.sounds||[{pad:1}],{group:this}),this.patterns=new PatternCollection(attrs.patterns||[{position:1}],{group:this})},GroupModel.prototype.url=function(){return this.isNew()&&this.get("recipe_id")?"/recipes/"+this.get("recipe_id")+"/groups":this.isNew()?"/groups":"/groups/"+this.get("id")},GroupModel}(Backbone.NestedModel),module.exports=GroupModel},{"../collections/pattern":3,"../collections/sound":4,backbone:31,"backbone-nested":30,jquery:33,underscore:34}],8:[function(require,module){var $,Backbone,PatternGridView,PatternModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.NestedModel=require("backbone-nested").NestedModel,_=require("underscore"),$=require("jquery"),PatternGridView=require("../views/pattern.grid"),PatternModel=function(_super){function PatternModel(){return PatternModel.__super__.constructor.apply(this,arguments)}return __extends(PatternModel,_super),PatternModel.prototype.defaults=function(){var attrs;return attrs={triggers:{},len:4,position:1,zoom:2,step:64}},PatternModel.prototype.url=function(){return this.isNew()&&this.get("groupId")?"/groups/"+this.get("groupId")+"/patterns":this.isNew()?"/patterns":"/patterns/"+this.get("id")},PatternModel.prototype.initialize=function(attrs,options){return null==attrs&&(attrs={}),null==options&&(options={}),this.view=new PatternGridView({model:this})},PatternModel.prototype.toJSON=function(){var attrs;return attrs=$.extend({},this.attributes),attrs.zoom=parseInt(attrs.zoom,10)||2,attrs.step=parseInt(attrs.step,10)||64,attrs},PatternModel}(Backbone.NestedModel),module.exports=PatternModel},{"../views/pattern.grid":23,backbone:31,"backbone-nested":30,jquery:33,underscore:34}],9:[function(require,module){var Backbone,BackboneNested,RecipeModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),BackboneNested=require("backbone-nested"),_=require("underscore"),RecipeModel=function(_super){function RecipeModel(){return RecipeModel.__super__.constructor.apply(this,arguments)}return __extends(RecipeModel,_super),RecipeModel.prototype.defaults={name:"New Recipe"},RecipeModel.prototype.urlRoot="/recipes",RecipeModel}(Backbone.NestedModel),module.exports=RecipeModel},{backbone:31,"backbone-nested":30,underscore:34}],10:[function(require,module){var Backbone,SoundModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.NestedModel=require("backbone-nested").NestedModel,_=require("underscore"),SoundModel=function(_super){function SoundModel(){return SoundModel.__super__.constructor.apply(this,arguments)}return __extends(SoundModel,_super),SoundModel.prototype.url=function(){return this.isNew()&&this.get("groupId")?"/groups/"+this.get("groupId")+"/sounds":this.isNew()?"/sounds":"/sounds/"+this.get("id")},SoundModel.prototype.initialize=function(attrs,options){var _ref,_ref1;return null==attrs&&(attrs={}),null==options&&(options={}),_.bindAll(this,"loadSrc"),null!=(null!=(_ref=this.collection)?_ref.group.app.pads:void 0)&&null!=(_ref1=this.collection.group.app.pads.pads[this.get("pad")-1])&&_ref1.bootstrapWithModel(this),this.on("change:src",this.loadSrc),this.on("change:fx:*",function(_this){return function(){return _this.timbreContextAttached=!1,_this.rendered=!1}}(this))},SoundModel.prototype.play=function(){var sound,_ref;return this.rendered?(null!=(_ref=this.T.rendered)?_ref.playbackState:void 0)?this.T.rendered.currentTime=0:$(this.T.rendered.bang()).one("ended",this.onEnded):(sound=this.renderEffects(),this.timbreContextAttached?sound.bang():(this.timbreContextAttached=!0,$(sound.play()).one("ended",this.onEnded))),this},SoundModel.prototype.onEnded=function(){return this.pause()},SoundModel.prototype.renderEffects=function(){var sound;return sound=null,this.T&&delete this.T.rendered,this.T.rendered=this.T.raw.clone(),_.each(this.get("fx"),function(_this){return function(params,fx){return sound=T(fx,params,sound||_this.T.rendered)}}(this)),this.rendered=!0,sound||this.T.rendered},SoundModel.prototype.loadSrc=function(model,src,options,cb){var _this;return _this=this,src||this.get("src")?(this.loaded=!1,T("audio").load(src||this.get("src"),function(){return _this.T={raw:this},_this.loaded=!0,_this.trigger("loaded"),cb?cb.call(_this,this):void 0})):void 0},SoundModel}(Backbone.NestedModel),module.exports=SoundModel},{backbone:31,"backbone-nested":30,underscore:34}],11:[function(require,module){var Backbone,TransportModel,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),TransportModel=function(_super){function TransportModel(){return TransportModel.__super__.constructor.apply(this,arguments)}return __extends(TransportModel,_super),TransportModel.prototype.initialize=function(attrs){return null==attrs&&(attrs={}),null!=attrs.bpm&&attrs.step&&this.setInterval(attrs.bpm,attrs.step),this.on("change:interval",this.setInterval),this.on("change:bpm",this.setInterval),this.on("change:step",this.setInterval)},TransportModel.prototype.setInterval=function(bpm,step){var interval;return interval=6e4/parseInt(bpm||this.get("bpm"),10)/parseInt(step||this.get("step"),10),this.set("interval",interval)},TransportModel}(Backbone.Model),module.exports=TransportModel},{backbone:31,underscore:34}],12:[function(require,module){var AppRouter,Backbone,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),_=require("underscore"),AppRouter=function(_super){function AppRouter(){return AppRouter.__super__.constructor.apply(this,arguments)}return __extends(AppRouter,_super),AppRouter.prototype.routes={"":"main","pad/:num":"soundEditor","beet/:id":"open"},AppRouter.prototype.initialize=function(options){return this.app=options.app,options},AppRouter.prototype.main=function(){},AppRouter.prototype.soundEditor=function(){},AppRouter.prototype.open=function(id){return console.log("open "+id)},AppRouter}(Backbone.Router),module.exports=AppRouter},{backbone:31,underscore:34}],13:[function(require,module,exports){require("underscore");module.exports=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="row">\n	<div class="col-xs-12">\n		<pre class="tiny">\n _               _                        _     _            \n| |__   ___  ___| |_ _ __ ___   __ _  ___| |__ (_)_ __   ___ \n| \'_ \\ / _ \\/ _ \\ __| \'_ ` _ \\ / _` |/ __| \'_ \\| | \'_ \\ / _ \\\n| |_) |  __/  __/ |_| | | | | | (_| | (__| | | | | | | |  __/\n|_.__/ \\___|\\___|\\__|_| |_| |_|\\__,_|\\___|_| |_|_|_| |_|\\___|\n		</pre>\n		<span lg-bind="one">'+(null==(__t=one)?"":__t)+'</span>\n	</div>\n</div>\n<div class="row">\n	<div class="col-xs-6">\n		<span class="" style="font-family:Courier" lg-bind="left">00:00:00:00</span>\n	</div>\n	<div class="col-xs-6" lg-bind="right">\n	</div>\n</div>';return __p}},{underscore:34}],14:[function(require,module,exports){require("underscore");module.exports=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<a href="javascript:void(0)" class="close right" data-dismiss="modal" aria-hidden="true">&times;</a>\n			<h4 class="modal-title">Sound Editor: <span data-bind="name"></span></h4>\n		</div>\n		<div class="modal-body">\n			<form class="form-horizontal" onsubmit="return false">\n				<div class="form-group">\n					<div class="col-xs-12">\n						<label>Name</label>\n						<input class="form-control" type="text" placeholder="" data-bind="name" />\n					</div>\n				</div>\n				<div class="form-group">\n					<div class="col-xs-12">\n						<label>Source</label>\n						<input class="form-control readonly" readonly type="text" placeholder="" data-bind="src" />\n					</div>\n				</div>\n				<div class="row">\n					<div class="col-xs-12">\n						<canvas width="558" height="100" class="waveform" alt="Click to preview">No Pad or Not Rendered Yet</canvas>\n					</div>\n				</div>\n				<div class="form-group">\n					<div class="col-xs-6">\n						<label>Key Trigger:</label>\n						<input class="form-control" type="text" placeholder="" data-bind="keyCode" />\n					</div>\n					<div class="col-xs-6">\n						<div class="row collapse">\n							<label>Effects</label>\n							<div class="col-xs-9">\n								<input class="form-control" type="text" placeholder="" />\n							</div>\n						</div>\n					</div>\n				</div>\n				<div class="form-group">\n					<div class="col-xs-12">\n						<div class="btn-group btn-group-justified">\n							<a class="btn btn-squishy btn-sm active" href="#editor/'+(null==(__t=data.pad)?"":__t)+'-eq" data-behavior="tab" data-tab=".eq">EQ</a>\n							<a class="btn btn-squishy btn-sm" href="#editor/'+(null==(__t=data.pad)?"":__t)+'-reverb" data-behavior="tab" data-tab=".reverb">Reverb</a>\n							<a class="btn btn-squishy btn-sm" href="#editor/'+(null==(__t=data.pad)?"":__t)+'-delay" data-behavior="tab" data-tab=".delay">Delay</a>\n							<a class="btn btn-squishy btn-sm" href="#editor/'+(null==(__t=data.pad)?"":__t)+'-chorus" data-behavior="tab" data-tab=".chorus">Chorus</a>\n						</div>\n						<div class="tab-content">\n							<div class="tab-pane eq" '+(null==(__t=view.show?"":"lg")?"":__t)+'>\n								<canvas style="width:100%;height:100px;" class="eqform"></canvas>\n								<div class="form-group">\n									<div class="col-xs-12">\n											<label>hpf</label>\n											<input type="range" class="eq" data-param="hpf" min="-20" max="20" step="0.5">\n											<label>lf</label>\n											<input type="range" class="eq" data-param="lf" min="-20" max="20" step="0.5">\n											<label>lmf</label>\n											<input type="range" class="eq" data-param="lmf" min="-20" max="20" step="0.5">\n											<label>mf</label>\n											<input type="range" class="eq" data-param="mf" min="-20" max="20" step="0.5">\n											<label>hmf</label>\n											<input type="range" class="eq" data-param="hmf" min="-20" max="20" step="0.5">\n											<label>hf</label>\n											<input type="range" class="eq" data-param="hf" min="-20" max="20" step="0.5">\n											<label>lpf</label>\n											<input type="range" class="eq" data-param="lpf" min="-20" max="20" step="0.5">\n										</div>\n								</div>\n							</div>\n							<div class="tab-pane reverb" '+(null==(__t="reverb"===view.show?"":"hidden")?"":__t)+">\n								",__p+=data.fx&&data.fx.reverb?'\n									<div class="form-group">\n										<div class="col-xs-12 text-right">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="reverb">Disable Reverb</a>\n										</div>\n									</div>\n									<div class="form-group">\n										<div class="col-xs-4">\n											<label>Room <span class="label label-default" data-bind="fx.reverb.room">'+(null==(__t=data.fx.reverb.room)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.reverb.room" min="0" max="2" step="0.1">\n										</div>\n										<div class="col-xs-4">\n											<label>Wet/Dry <span class="label label-default" data-bind="fx.reverb.damp">'+(null==(__t=data.fx.reverb.damp)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.reverb.damp" min="0" max="1" step="0.1">\n										</div>\n										<div class="col-xs-4">\n											<label>Mix <span class="label label-default" data-bind="fx.reverb.mix">'+(null==(__t=data.fx.reverb.mix)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.reverb.mix" min="0" max="1" step="0.01">\n										</div>\n									</div>\n								':'\n									<div class="form-group">\n										<div class="col-xs-12">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="reverb">Enable Reverb</a>\n										</div>\n									</div>\n								',__p+='\n							</div>\n							<div class="tab-pane delay" '+(null==(__t="delay"===view.show?"":"hidden")?"":__t)+">\n								",__p+=data.fx&&data.fx.delay?'\n									<div class="form-group">\n										<div class="col-xs-12 text-right">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="delay">Disable Delay</a>\n										</div>\n									</div>\n									<div class="form-group">\n										<div class="col-xs-4">\n											<label>Time <span class="label label-default" data-bind="fx.delay.time">'+(null==(__t=data.fx.delay.time)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.delay.time" min="10" max="1250" step="10">\n										</div>\n										<div class="col-xs-4">\n											<label>Feedback <span class="label label-default" data-bind="fx.delay.fb">'+(null==(__t=data.fx.delay.fb)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.delay.fb" min="-1" max="1" step="0.1">\n										</div>\n										<div class="col-xs-1">\n											<label>Cross Delay <span class="label label-default" data-bind="fx.delay.cross">'+(null==(__t=data.fx.delay.cross)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.delay.cross" min="0" max="1" step="0.01">\n										</div>\n										<div class="col-xs-3">\n											<label>Mix <span class="label label-default" data-bind="fx.delay.mix">'+(null==(__t=data.fx.delay.mix)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.delay.mix" min="0" max="1" step="0.01">\n										</div>\n									</div>\n									':'\n									<div class="form-group">\n										<div class="col-xs-12">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="delay">Enable Delay</a>\n										</div>\n									</div>\n									',__p+='\n							</div>\n							<div class="tab-pane chorus" '+(null==(__t="chorus"===view.show?"":"hidden")?"":__t)+">\n							",__p+=data.fx&&data.fx.chorus?'\n									<div class="form-group">\n										<div class="col-xs-12 text-right">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="chorus">Disable Chorus</a>\n										</div>\n									</div>\n									<label>Type <span class="label label-default" data-bind="fx.chorus.type">'+(null==(__t=data.fx.chorus.type)?"":__t)+'</span></label>\n											<select data-bind="fx.chorus.type" class="form-control">\n												<option value="sin">Sin</option>\n												<option value="tri">Tri</option>\n											</select>\n									<div class="form-group">\n										<div class="col-xs-4">\n											<label>Delay <span class="label label-default" data-bind="fx.chorus.delay">'+(null==(__t=data.fx.chorus.delay)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.delay" min="0.5" max="80" step="0.5">\n										</div>\n										<div class="col-xs-4">\n											<label>Rate <span class="label label-default" data-bind="fx.chorus.rate">'+(null==(__t=data.fx.chorus.rate)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.rate" min="0" max="10" step="0.5">\n										</div>\n										<div class="col-xs-4">\n											<label>Depth <span class="label label-default" data-bind="fx.chorus.depth">'+(null==(__t=data.fx.chorus.depth)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.depth" min="0" max="100" step="1">\n										</div>\n									</div>\n									<div class="form-group">\n										<div class="col-xs-4">\n											<label>Feedback <span class="label label-default" data-bind="fx.chorus.fb">'+(null==(__t=data.fx.chorus.fb)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.fb" min="-1" max="1" step="0.1">\n										</div>\n										<div class="col-xs-4">\n											<label>Wet <span class="label label-default" data-bind="fx.chorus.wet">'+(null==(__t=data.fx.chorus.wet)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.wet" min="0" max="1" step="0.01">\n										</div>\n										<div class="col-xs-4">\n											<label>Mix <span class="label label-default" data-bind="fx.chorus.mix">'+(null==(__t=data.fx.chorus.mix)?"":__t)+'</span></label>\n											<input type="range" data-bind="fx.chorus.mix" min="0" max="1" step="0.01">\n										</div>\n									</div>\n									':'\n									<div class="form-group">\n										<div class="col-xs-12">\n												<a class="btn btn-squishy btn-sm" data-behavior="toggleEffect" data-effect="chorus">Enable Chorus</a>\n										</div>\n									</div>\n									',__p+='\n							</div>\n						</div>\n					</div>\n				</div>\n				<div class="form-group">\n					<div class="col-xs-12">\n						<textarea class="form-control" placeholder=""></textarea>\n					</div>\n				</div>\n			</form>\n		</div>\n		<div class="modal-footer">\n			<a data-dismiss="modal" data-behavior="close" class="btn btn-sm btn-squishy">Cancel</a>\n			<a data-dismiss="modal" data-behavior="save" class="btn btn-sm btn-squishy">Save</a>\n		</div>\n	</div>\n</div>';
return __p}},{underscore:34}],15:[function(require,module,exports){var _=require("underscore");module.exports=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="pad-label">\n	<small lg-bind="name">'+(null==(__t=name)?"":_.escape(__t))+'</small>\n</div>\n<div class="pad btn btn-squishy">&nbsp;</div>';return __p}},{underscore:34}],16:[function(require,module,exports){require("underscore");module.exports=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+="\n\n";return __p}},{underscore:34}],17:[function(require,module,exports){require("underscore");module.exports=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="btn-group btn-group-justified">\n	<a href="javascript:void(0)" data-behavior="play" class="btn btn-squishy btn-sm">\n		<span class="glyphicon glyphicon-play"></span><span class="glyphicon glyphicon-pause"></span> Play\n	</a>\n	<a href="javascript:void(0)" data-behavior="record" class="btn btn-squishy btn-sm">\n		<span class="glyphicon glyphicon-record"></span> Record\n	</a>\n	<a href="javascript:void(0)" data-behavior="stop" class="btn btn-squishy btn-sm">\n		<span class="glyphicon glyphicon-stop"></span> Stop\n	</a>\n</div>\n<div class="btn-group btn-group-justified">\n	<a href="javascript:void(0)" data-behavior="restart" class="btn btn-squishy btn-sm">\n		<span class="glyphicon glyphicon-step-backward"></span>\n	</a>\n	<a href="javascript:void(0)" data-behavior="end" class="btn btn-squishy btn-sm">\n		<span class="glyphicon glyphicon-step-forward"></span>\n	</a>\n</div>';return __p}},{underscore:34}],18:[function(require,module){var $,APP_EL_SELECTOR,AppView,Backbone,DEFAULT_KEYCODES,Display,GroupCollection,PLAYPAUSE_CHAR,Pads,PatternUIView,RECORD_CHAR,RecipeModel,Router,Sequence,Transport,async,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=$=require("jquery"),Backbone.NestedModel=require("backbone-nested").NestedModel,_=require("underscore"),async=require("async"),Router=require("../routes/app"),Pads=require("./pads"),Display=require("./display"),Transport=require("./transport"),Sequence=require("./sequence"),PatternUIView=require("./pattern.ui"),RecipeModel=require("../models/recipe"),GroupCollection=require("../collections/group"),DEFAULT_KEYCODES=[54,55,56,57,89,85,73,79,72,74,75,76,78,77,188,190],RECORD_CHAR=82,PLAYPAUSE_CHAR=32,APP_EL_SELECTOR="body",AppView=function(_super){function AppView(){return AppView.__super__.constructor.apply(this,arguments)}return __extends(AppView,_super),AppView.prototype.el=APP_EL_SELECTOR,AppView.prototype.initialize=function(){var i,keyCode,_i,_len;for(Backbone.history.start({pushState:!0}),this.current={},this.keyMap={},this.recipe=new RecipeModel,this.router=new Router({app:this}),(this.display=new Display({app:this})).log("Please Wait..."),this.transport=new Transport({app:this}),this.pattern=new PatternUIView({app:this}),this.groups=new GroupCollection({position:1},{app:this}),this.pads=new Pads({app:this}),this.sequence=new Sequence({app:this}),this.UIModel=new(Backbone.NestedModel.extend()),async.series([function(_this){return function(callback){return _this.recipe.get("id")?_this.open(_this.recipe,function(){return callback(null,!0)}):callback(null,!1)}}(this)],function(_this){return function(){return _this._selectGroupAt(0),_this.pattern._selectPatternAt(0)}}(this)),i=_i=0,_len=DEFAULT_KEYCODES.length;_len>_i;i=++_i)keyCode=DEFAULT_KEYCODES[i],this.keyMap[keyCode]=i;return this.display.log("Ready")},AppView.prototype.events={"click [data-behavior]":"delegateBehavior",keypress:"keyPressDelegate",keydown:"keyDownDelegate",keyup:"keyUpDelegate"},AppView.prototype.delegateBehavior=function(e){var behavior,meta;return behavior=$(e.currentTarget).data("behavior"),meta=$(e.currentTarget).data("meta"),null!=behavior&&_.isFunction(this[behavior])?this[behavior].call(this,e,meta):void 0},AppView.prototype.selectGroup=function(e,number){return this._selectGroup(number)},AppView.prototype._selectGroupAt=function(){return this._selectGroup(this.groups.at(0).get("position"))},AppView.prototype._selectGroup=function(groupNumber){return this.current.group=this.groups.findWhere({position:groupNumber}),this.pads.render(groupNumber)},AppView.prototype.open=function(recipe,callback){var _this;return _this=this,this.display.log("Loading "+this.recipe.get("name")+"..."),this.groups.fetchRecursive(this,this.recipe,function(_this){return function(){return callback.call(_this),_this.display.log('Recipe "'+_this.recipe.get("name")+'" Loaded')}}(this))},AppView.prototype.save=function(){var _this;return _this=this,async.waterfall([function(_this){return function(recipeSavedCallback){return _this.recipe.save({},{success:function(savedRecipe){return async.each(_this.groups.models,function(group,eachGroupSavedCallback){return group.save({recipe_id:savedRecipe.id},{success:function(){return function(){return async.parallel([function(cbSound){return async.each(group.sounds.models,function(sound,eachSoundSavedCallback){return sound.save({groupId:group.id},{success:function(savedSound){return eachSoundSavedCallback(null,savedSound)},error:function(err){return eachSoundSavedCallback(err)}})},function(err){return err&&cbSound(err),cbSound(null)})},function(cbPattern){return async.each(group.patterns.models,function(pattern,eachPatternSavedCallback){return pattern.save({groupId:group.id},{success:function(savedPattern){return eachPatternSavedCallback(null,savedPattern)},error:function(err){return eachPatternSavedCallback(err)}})},function(err){return err&&cbPattern(err),cbPattern(null)})}],function(err){return err&&eachGroupSavedCallback(err),eachGroupSavedCallback(null)})}}(this)})},function(){return recipeSavedCallback(null)})},error:function(err){return recipeSavedCallback(err)}})}}(this)],function(_this){return function(err){if(err)throw new Error(err);return _this.router.navigate("recipe/"+_this.recipe.get("id"),{silent:!0}),_this.display.log('Recipe "'+_this.recipe.get("name")+'" Saved')}}(this))},AppView.prototype.toJSON=function(){var recipe;return recipe=this.recipe.toJSON(),recipe.groups=[],this.groups.each(function(){return function(group){var groupAttributes;return groupAttributes=group.toJSON(),groupAttributes.sounds=[],group.sounds.each(function(sound){return groupAttributes.sounds.push(sound.toJSON())}),groupAttributes.patterns=[],group.patterns.each(function(pattern){return groupAttributes.patterns.push(pattern.toJSON())}),recipe.groups.push(groupAttributes)}}(this)),console.log(recipe)},AppView.prototype.keyDownDelegate=function(e){var char,prevent;return char=String.fromCharCode(e.keyCode),char===RECORD_CHAR&&e.ctrlKey?(this.transport.record(),prevent=!0):char===PLAYPAUSE_CHAR?(this.transport.play(),prevent=!0):_.indexOf([1,"1","2","3","4","5","6","7","8"],char)>0&&e.ctrlKey&&(prevent=!0,this.pads.render(char)),prevent?e.preventDefault():void 0},AppView.prototype.keyPressDelegate=function(e){var pad,_ref;return null!=this.keyMap[e.which]?(this.pressing=e.which,pad=null!=(_ref=this.current.pads[this.keyMap[e.which]])?_ref.trigger("press"):void 0):void 0},AppView.prototype.keyUpDelegate=function(e){var pad,_ref;return e.which===this.pressing?pad=null!=(_ref=this.current.pads[this.keyMap[e.which]])?_ref.trigger("release"):void 0:void 0},AppView}(Backbone.View),module.exports=new AppView},{"../collections/group":2,"../models/recipe":9,"../routes/app":12,"./display":19,"./pads":22,"./pattern.ui":24,"./sequence":25,"./transport":26,async:27,backbone:31,"backbone-nested":30,jquery:33,underscore:34}],19:[function(require,module){var Backbone,DisplayModel,DisplayView,Ligament,displayTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),Ligament=require("backbone-ligaments"),_=require("underscore"),DisplayModel=require("../models/display"),displayTemplate=require("../templates/display.tpl"),DisplayView=function(_super){function DisplayView(){return DisplayView.__super__.constructor.apply(this,arguments)}return __extends(DisplayView,_super),DisplayView.prototype.el=".display",DisplayView.prototype.template=displayTemplate,DisplayView.prototype.initialize=function(options){return this.app=options.app,this.model=new DisplayModel,this.render(),this.$canvas=this.$("#waveform"),new Ligament({model:this.model,view:this})},DisplayView.prototype.log=function(options){var message;return message="string"==typeof options?options:options.message,this.model.set("one",message),this.render()},DisplayView.prototype.render=function(){return this.el.innerHTML=this.template(this.model.toJSON())},DisplayView}(Backbone.View),module.exports=DisplayView},{"../models/display":6,"../templates/display.tpl":13,backbone:31,"backbone-ligaments":28,jquery:33,underscore:34}],20:[function(require,module){var Backbone,Display,EditorView,Ligament,ORANGE,editorTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),Ligament=require("backbone-ligaments"),_=require("underscore"),Display=require("./display"),editorTemplate=require("../templates/editor.tpl"),ORANGE="#f08a24",EditorView=function(_super){function EditorView(){return EditorView.__super__.constructor.apply(this,arguments)}return __extends(EditorView,_super),EditorView.prototype.template=editorTemplate,EditorView.prototype.attributes={"class":"modal fade"},EditorView.prototype.initialize=function(options){return this.viewVars={},this.model=options.model,this.pad=options.pad,_.bindAll(this,"redrawCanvas"),this.render(),new Ligament({model:this.model,view:this}),this.listenTo(this.model,"change",this.redrawCanvas)},EditorView.prototype.events={"click [data-behavior]":"delegateBehavior","click canvas":"play","change input.eq":"eq"},EditorView.prototype.delegateBehavior=function(e){var behavior;return behavior=$(e.currentTarget).data("behavior"),null!=behavior&&_.isFunction(this[behavior])?this[behavior].call(this,e):void 0},EditorView.prototype.save=function(){return this.pad.model.save()},EditorView.prototype.eq=function(e){var freq,param;return param=e.currentTarget.getAttribute("data-param"),freq=this.model.get("fx.eq.params."+param),freq[2]=parseInt($(e.currentTarget).val(),10),this.model.set("fx.eq.params."+param,freq),console.log(freq)},EditorView.prototype.tab=function(e){var tabClass;return tabClass=$(e.currentTarget).data("tab"),$(e.currentTarget).addClass("active").siblings().removeClass("active"),this.$(".tab-pane").hide(),this.$(".tab-pane"+tabClass).show()},EditorView.prototype.toggleEffect=function(e){var effect;return effect=$(e.currentTarget).data("effect"),this.model.get("fx."+effect)?(delete this.viewVars.show,this.removeEffect(effect)):(this.viewVars.show=effect,this.addEffect(effect))},EditorView.prototype.addEffect=function(effect){var fx;switch(effect){case"reverb":fx={room:0,damp:0,mix:.5};break;case"delay":fx={time:100,fb:.2,mix:.33};break;case"chorus":fx={type:"sin",delay:20,rate:4,depth:20,fb:.2,wet:.33}}return this.model.set("fx."+effect,fx),this.redrawCanvas()},EditorView.prototype.removeEffect=function(effect){return this.model.unset("fx."+effect),this.redrawCanvas()},EditorView.prototype.play=function(e){return e.preventDefault(),this.pad.trigger("press")},EditorView.prototype.show=function(){return this.redrawCanvas(),this.$el.modal("show")},EditorView.prototype.hide=function(){return this.$el.modal("hide")},EditorView.prototype.render=function(){return this.el.innerHTML=this.template({data:this.model.toJSON(),view:this.viewVars}),this.redrawCanvas()},EditorView.prototype.redrawCanvas=function(){var _ref,_ref1;return this.$canvas||(this.$canvas=this.$(".waveform")),(null!=(_ref=this.pad.model)&&null!=(_ref1=_ref.T)?_ref1.rendered:void 0)?this.pad.model.T.rendered.plot({width:558,height:100,target:this.$canvas.get(0),lineWidth:.5,background:"#222",foreground:ORANGE}):void 0},EditorView}(Backbone.View),module.exports=EditorView},{"../templates/editor.tpl":14,"./display":19,backbone:31,"backbone-ligaments":28,jquery:33,underscore:34}],21:[function(require,module){var Backbone,Ligament,PAD_CLASSES,PAD_RELEASE_TIMEOUT,PadView,SoundEditor,SoundModel,padTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),Ligament=require("backbone-ligaments"),_=require("underscore"),SoundModel=require("../models/sound"),SoundEditor=require("./editor"),padTemplate=require("../templates/pad.tpl"),PAD_CLASSES="small-3 columns pad-container",PAD_RELEASE_TIMEOUT=50,PadView=function(_super){function PadView(){return PadView.__super__.constructor.apply(this,arguments)}return __extends(PadView,_super),PadView.prototype.attributes={"class":PAD_CLASSES},PadView.prototype.template=padTemplate,PadView.prototype.initialize=function(options){return this.parent=options.parent,this.name=options.name,this.number=options.number,_.bindAll(this,"listenToModelEvents","press"),this.on("press",this.press),this.render()},PadView.prototype.events={"contextmenu .pad":"edit","mousedown .pad":"press","mouseup .pad":"release",dragover:"prevent",dragenter:"prevent",drop:"uploadSample"},PadView.prototype.listenToModelEvents=function(){return this.stopListening(this.model,"press"),this.listenTo(this.model,"press",this.press),this.stopListening(this.model,"loaded"),this.listenTo(this.model,"loaded",function(_this){return function(){return _this.$(".pad").addClass("mapped"),_this.parent.app.display.log((_this.model.get("name")||_this.name)+" loaded")}}(this))},PadView.prototype.bootstrapWithModel=function(soundModel){var keyCode;if(!soundModel&&!soundModel instanceof SoundModel)throw new Error("Must provide a SoundModel instance when mapping a pad.");return(this.model=soundModel).pad=this,this.listenToModelEvents(),(keyCode=this.model.get("keyCode"))&&this.model.set("key",keyCode),new Ligament({model:this.model,view:this})},PadView.prototype.prevent=function(e){return e.preventDefault(),e.stopPropagation()},PadView.prototype.press=function(e){var _ref;return null==e&&(e={}),null!=e&&2===e.button?!0:(this.$(".pad").addClass("active"),setTimeout(function(_this){return function(){return _this.$(".pad").removeClass("active")}}(this),PAD_RELEASE_TIMEOUT),(null!=(_ref=this.model)?_ref.loaded:void 0)?(e.silent||this.parent.trigger("press",this),this.model.play()):void 0)},PadView.prototype.release=function(){},PadView.prototype.createOrFindModel=function(attrs){return null==attrs&&(attrs={}),(this.model=this.parent.app.groups.findWhere({position:this.groupNumber}).sounds.findWhere({pad:this.number}))||(this.model=new SoundModel(_.extend({pad:this.$el.index()+1},attrs)),this.parent.app.current.group.sounds.add(this.model),this.bootstrapWithModel(this.model)),this.model},PadView.prototype.uploadSample=function(e){var objectUrl,_ref,_ref1,_ref2;return e=e.originalEvent,e.preventDefault(),e.stopPropagation(),this.model||this.createOrFindModel(),objectUrl=null!=(_ref=window.URL)&&"function"==typeof _ref.createObjectURL?_ref.createObjectURL(null!=(_ref1=e.dataTransfer)&&null!=(_ref2=_ref1.files)?_ref2[0]:void 0):void 0,this.model.set("src",objectUrl),this.parent.app.display.log("File: "+e.dataTransfer.files[0].name+" uploaded on pad "+this.name)},PadView.prototype.edit=function(e){return e.preventDefault(),this.editor||(this.editor=new SoundEditor({model:this.model||this.createOrFindModel(),pad:this})),this.editor.show()},PadView.prototype.render=function(){return this.el.innerHTML=this.template({name:this.name})},PadView}(Backbone.View),module.exports=PadView},{"../models/sound":10,"../templates/pad.tpl":15,"./editor":20,backbone:31,"backbone-ligaments":28,jquery:33,underscore:34}],22:[function(require,module){var Backbone,PADLABEL_PREFIX,PadView,PadsView,padsTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),_=require("underscore"),PadView=require("./pad"),padsTemplate=require("../templates/pad.tpl"),PADLABEL_PREFIX="c",PadsView=function(_super){function PadsView(){return PadsView.__super__.constructor.apply(this,arguments)}return __extends(PadsView,_super),PadsView.prototype.el=".pads",PadsView.prototype.template=padsTemplate,PadsView.prototype.colorMap={1:"#ADD5FF",2:"#FF8D8D",3:"#BBBBD4",4:"#EBECF2",5:"#FFE97F"},PadsView.prototype.initialize=function(options){return this.app=options.app,this.createPads(),this.render(),this.listenTo(this.app.groups,"fetch",function(_this){return function(collection){return collection.each(function(model){return _this.bootstrapGroupPads(model)}),_this.render()}}(this)),this.listenTo(this.app.groups,"add",function(_this){return function(model){return _this.bootstrapGroupPads(model)}}(this))},PadsView.prototype.createPads=function(){var i,options,padView,z,_i,_results;for(this.pads=[],z=0,_results=[],i=_i=1;128>=_i;i=++_i)options={name:""+(PADLABEL_PREFIX+(i-16*z)),parent:this,number:i-16*z},this.pads.push(padView=new PadView(options)),padView.groupNumber=z+1,_results.push(i%16===0?z++:void 0);return _results},PadsView.prototype.bootstrapGroupPads=function(group){var i,pad,pads,pos,_i,_len,_results;if(pos=group.get("position")-1>-1?group.get("position")-1:0,pads=this.pads.slice(16*pos,16*pos+16),null!=group.sounds.at(i)){for(_results=[],i=_i=0,_len=pads.length;_len>_i;i=++_i)pad=pads[i],_results.push(pad.bootstrapWithModel(group.sounds.at(i)));return _results}},PadsView.prototype.toggleGroupSelectButtons=function(group){return this.app.$('[data-behavior="selectGroup"]').removeClass("active").filter('[data-meta="'+group+'"]').addClass("active")},PadsView.prototype.render=function(groupNumber){var zeroedIndex,_ref;return null==groupNumber&&(groupNumber=1),this.$(".pad-container").detach(),groupNumber=1*groupNumber,this.toggleGroupSelectButtons(groupNumber),zeroedIndex=groupNumber-1,this.app.current.group=this.app.groups.findWhere({position:groupNumber}),this.app.current.group||(this.app.groups.add({position:groupNumber}),this.app.current.group=this.app.groups.findWhere({position:groupNumber})),this.app.$(".patterns .grid").hide(),this.app.pattern._selectPattern((null!=(_ref=this.app.current.group.lastActivePattern)?_ref.get("position"):void 0)||1),this.app.current.pads=this.pads.slice(16*zeroedIndex,16*zeroedIndex+16),this.app.display.model.set("right","Group "+groupNumber),this.$el.append(_.pluck(this.app.current.pads,"el"))},PadsView}(Backbone.View),module.exports=PadsView},{"../templates/pad.tpl":15,"./pad":21,backbone:31,jquery:33,underscore:34}],23:[function(require,module){var $,Backbone,HAS_TRIGGER_CLASS,PATTERN_LENGTH,PatternCollection,PatternGridView,paper,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Backbone=require("backbone"),Backbone.$=$=require("jquery"),_=require("underscore"),PatternCollection=require("../collections/pattern"),paper=require("../bower_components/paper/dist/paper-full"),HAS_TRIGGER_CLASS="has-trigger",PATTERN_LENGTH="4",PatternGridView=function(_super){function PatternGridView(){return PatternGridView.__super__.constructor.apply(this,arguments)}return __extends(PatternGridView,_super),PatternGridView.prototype.attributes={"class":"grid",style:"display:none;"},PatternGridView.prototype.initialize=function(options){return null==options&&(options={}),this.model=options.model,_.bindAll(this,"drawGrid","addTrigger","removeTrigger","onTick"),this.app=this.model.collection.group.app,this.ui=this.app.pattern,this.ui.$(".patterns").append(this.$el),this.model.get("len")||this.model.set("len",PATTERN_LENGTH),this.render(),this.listenTo(this.model,"change:len",this.drawGrid),this.listenTo(this.model,"change:zoom",this.drawGrid),this.listenTo(this.model,"change:step",this.drawGrid),this.listenTo(this.model,"remove",this.remove),this.listenTo(this.ui,"tick",this.onTick)},PatternGridView.prototype.events={"contextmenu .trigger":"clickDeleteTrigger",dblclick:"clickAddTrigger"},PatternGridView.prototype.clickAddTrigger=function(e){return e.preventDefault(),this.addTrigger(this.offsetToPadNumber(e.offsetY),this.offsetToTick(e.offsetX))},PatternGridView.prototype.clickDeleteTrigger=function(e){var data;return e.preventDefault(),data=$(e.target).data(),this.removeTrigger(data.padNumber,data.tick),$(e.target).remove()},PatternGridView.prototype.onTick=function(tick){var normalizedTick,triggers;return normalizedTick=this.getNormalizedTick(tick),this.app.transport._playing&&(triggers=this.model.get("triggers."+normalizedTick))?_.each(triggers,function(_this){return function(padNumber){var _ref;return null!=(_ref=_this.model.collection.group.sounds.findWhere({pad:padNumber}))?_ref.trigger("press",{silent:!0}):void 0}}(this)):void 0},PatternGridView.prototype.drawTriggers=function(){var padNumber,tick,triggers,_ref,_results;_ref=this.model.get("triggers"),_results=[];for(tick in _ref)__hasProp.call(_ref,tick)&&(triggers=_ref[tick],_results.push(function(){var _i,_len,_results1;for(_results1=[],_i=0,_len=triggers.length;_len>_i;_i++)padNumber=triggers[_i],_results1.push(this.drawTrigger(padNumber,tick));return _results1}.call(this)));return _results},PatternGridView.prototype.drawTrigger=function(padNumber,tick){var $trigger,left,totalTicks;return totalTicks=this.getTotalTicks(),left=100/this.getTotalTicks()*this.getNormalizedTick(tick),$trigger=$('<div class="trigger">').css({top:(padNumber-1)*this.ui.$(".slot").eq(0).outerHeight()+"px",height:""+this.ui.$(".slot").eq(0).outerHeight()+"px",width:""+this.w/totalTicks/this.w*100+"%",left:""+left+"%"}).data("tick",tick).data("padNumber",padNumber),this.$el.append($trigger)},PatternGridView.prototype.removeTrigger=function(padNumber,normalizedTick){var removed,triggers;return(triggers=this.model.get("triggers."+normalizedTick))?(this.app.current.pattern.view.drawTrigger(normalizedTick,padNumber),removed=triggers.splice(_.indexOf(triggers,padNumber),1),this.model.set("triggers."+normalizedTick,triggers),removed):!1},PatternGridView.prototype.addTrigger=function(padNumber,normalizedTick){var triggers;return triggers=this.model.get("triggers."+normalizedTick)||[],triggers.indexOf(padNumber)>-1||(triggers.push(padNumber),this.app.current.pattern.view.drawTrigger(padNumber,normalizedTick),this.model.set("triggers."+normalizedTick,triggers)),padNumber},PatternGridView.prototype.getTotalTicks=function(){var totalTicks;return totalTicks=this.model.get("len")*this.model.get("step")},PatternGridView.prototype.getNormalizedTick=function(tick,asPercentage){var normal,totalTicks;return null==asPercentage&&(asPercentage=!1),tick||(tick=this.app.transport.getTick()),totalTicks=this.getTotalTicks(),normal=totalTicks>=tick?tick:tick%this.getTotalTicks(),asPercentage?100/totalTicks*normal:normal},PatternGridView.prototype.offsetToPadNumber=function(offset,isPercentage){var padNumber;return null==isPercentage&&(isPercentage=!1),isPercentage||(offset/=this.$el.outerHeight()),padNumber=Math.ceil(16*offset)},PatternGridView.prototype.offsetToTick=function(offset,isPercentage){var tick;return null==isPercentage&&(isPercentage=!1),isPercentage||(offset/=this.w),tick=Math.floor(this.getTotalTicks()*offset)},PatternGridView.prototype.tickToOffset=function(){},PatternGridView.prototype.drawGrid=function(){var $patternWindow,bar,bars,currentTick,h,i,len,path,slotHeight,step,totalTicks,w,x,xInterval,y,zoom,_i,_j,_ref;for(zoom=this.model.get("zoom")||2,$patternWindow=this.ui.$(".patterns"),w=this.w=$patternWindow.width()*this.model.get("zoom")*.9,h=310,this.$el.width(w),this.$el.height(h),len=parseInt(this.model.get("len"),10),step=parseInt(this.model.get("step"),10),totalTicks=step*len,xInterval=w/totalTicks,currentTick=0,bar=Math.ceil(totalTicks/len),i=_i=0,_ref=len+1;_ref>=0?_ref>=_i:_i>=_ref;i=_ref>=0?++_i:--_i)(bars||(bars=[])).push(i*bar||0);for(this.paper=paper.setup(this.$canvas.get(0)),this.paper.view.viewSize=new this.paper.Size(w,h),path=new this.paper.Path;totalTicks>=currentTick;)x=currentTick*xInterval,path=new this.paper.Path,path.strokeWidth=1,path.strokeColor=__indexOf.call(bars,currentTick)>=0?"#ddd":"#444",path.moveTo(new this.paper.Point(x-.5,0)),path.lineTo(new this.paper.Point(x-.5,h)),currentTick++;for(slotHeight=this.ui.$(".slot").eq(0).outerHeight(),i=_j=0;16>=_j;i=++_j)x=w,y=i*slotHeight,path=new this.paper.Path,path.strokeWidth=.2,path.strokeColor="#aaa",path.moveTo(0,y),path.lineTo(x,y);return this.paper.view.draw(),this.$el.find(".trigger").remove(),this.drawTriggers()},PatternGridView.prototype.render=function(){return this.$el.empty(),this.$canvas=$("<canvas>").appendTo(this.$el),this.$playHead=$('<div class="playHead">').appendTo(this.$el),this.drawGrid()},PatternGridView}(Backbone.View),module.exports=PatternGridView},{"../bower_components/paper/dist/paper-full":1,"../collections/pattern":3,backbone:31,jquery:33,underscore:34}],24:[function(require,module){var Backbone,Ligament,PatternCollection,PatternUIView,TRIGGER_CLASS,Transport,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=require("jquery"),Backbone.NestedModel=require("backbone-nested").NestedModel,Ligament=require("backbone-ligaments"),_=require("underscore"),PatternCollection=require("../collections/pattern"),Transport=require("./transport"),TRIGGER_CLASS="trigger",PatternUIView=function(_super){function PatternUIView(){return PatternUIView.__super__.constructor.apply(this,arguments)}return __extends(PatternUIView,_super),PatternUIView.prototype.el=".pattern",PatternUIView.prototype.initialize=function(options){return null==options&&(options={}),this.app=options.app,_.bindAll(this,"updatePlayHead","recordTrigger"),this.UIModel=new(Backbone.NestedModel.extend({})),this.ligament=new Ligament({model:this.UIModel,view:this,bindings:{"pattern.zoom":{cast:[parseFloat,10]},"pattern.len":{cast:[parseInt,10]},"pattern.step":{cast:[parseInt,10]}}}),this.listenTo(this.UIModel,"change:pattern.*",function(_this){return function(model,changed){return _this.app.current.pattern.set(changed)}}(this)),this.app.transport.on("tick",this.updatePlayHead),this.waitForPads=setInterval(function(_this){return function(){return clearTimeout(_this.waitForPads),_this.app.pads?_this.app.pads.on("press",_this.recordTrigger):void 0}}(this),100)},PatternUIView.prototype.events={"click [data-behavior]":"delegateBehavior"},PatternUIView.prototype.delegateBehavior=function(e){var behavior,delegate,meta;return behavior=$(e.target).data("behavior"),behavior&&(delegate=this[behavior])?(meta=$(e.target).data("meta"),delegate.call(this,e,meta)):void 0},PatternUIView.prototype.updatePlayHead=function(tick){var playHeadPosition;return tick||(tick=this.app.transport.getTick()),playHeadPosition=this.app.current.pattern.view.getNormalizedTick(tick,!0),this.app.current.pattern.view.$playHead.css({left:""+playHeadPosition+"%"}),this.trigger("tick",tick),playHeadPosition},PatternUIView.prototype.engagePlayHeadScrub=function(){return null},PatternUIView.prototype.disengagePlayHeadScrub=function(){return null},PatternUIView.prototype.recordTrigger=function(pad){var normalizedTick;return this.app.transport._recording?(normalizedTick=this.app.current.pattern.view.getNormalizedTick(),this.app.current.pattern.view.addTrigger(pad.number,normalizedTick)):void 0},PatternUIView.prototype.togglePatternSelectButtons=function(patternNumber){return this.$('[data-behavior="selectPattern"]').removeClass("active").filter('[data-meta="'+patternNumber+'"]').addClass("active")},PatternUIView.prototype.selectPattern=function(e,number){return this._selectPattern(number)},PatternUIView.prototype._selectPatternAt=function(){return this._selectPattern(this.app.current.group.patterns.at(0).get("position"))},PatternUIView.prototype._selectPattern=function(patternNumber){var left;return this.app.current.group.patterns.findWhere({position:patternNumber})||this.app.current.group.patterns.add({position:patternNumber}),this.app.current.pattern=this.app.current.group.patterns.findWhere({position:patternNumber}),this.app.current.group.lastActivePattern=this.app.current.pattern,this.togglePatternSelectButtons(patternNumber),this.$(".grid").hide(),this.app.current.pattern.view.$el.show(),this.UIModel.set("pattern.zoom",this.app.current.pattern.get("zoom")),left=this.updatePlayHead(),this.$(".patterns").prop("scrollLeft",left/95*this.app.current.pattern.view.$el.width()),this.trigger("changePattern",this.app.current.pattern)},PatternUIView}(Backbone.View),module.exports=PatternUIView},{"../collections/pattern":3,"./transport":26,backbone:31,"backbone-ligaments":28,"backbone-nested":30,jquery:33,underscore:34}],25:[function(require,module){var $,Backbone,SLOT_CLASSES,SLOT_COL_CLASSES,SLOT_LABEL_CLASSES,SequenceView,sequenceTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=$=require("jquery"),_=require("underscore"),sequenceTemplate=require("../templates/sequence.tpl"),SLOT_LABEL_CLASSES="slot slot-label",SLOT_COL_CLASSES="col col-1",SLOT_CLASSES="slot",SequenceView=function(_super){function SequenceView(){return SequenceView.__super__.constructor.apply(this,arguments)}return __extends(SequenceView,_super),SequenceView.prototype.template=sequenceTemplate,SequenceView.prototype.el=".sequence",SequenceView.prototype.initialize=function(options){return this.app=options.app,this.buildSequence()},SequenceView.prototype.buildSequence=function(){var cols,column,html,row,rows;for(column=0,cols=[];13>column;){for(row=0,cols[column]=$('<div class="'+SLOT_COL_CLASSES+'">'),rows=[];8>row;)html=0===column?'<div class="'+SLOT_CLASSES+'">Group '+(row+1)+"</div>":'<div class="'+SLOT_CLASSES+'">&nbsp;</div>',rows.push($(html)),row++;cols[column].append(rows),column++}return this.$el.append(cols)},SequenceView}(Backbone.View),module.exports=SequenceView},{"../templates/sequence.tpl":16,backbone:31,jquery:33,underscore:34}],26:[function(require,module){var $,Backbone,TransportModel,TransportView,transportTemplate,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);
return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Backbone=require("backbone"),Backbone.$=$=require("jquery"),_=require("underscore"),TransportModel=require("../models/transport"),transportTemplate=require("../templates/transport.tpl"),TransportView=function(_super){function TransportView(){return TransportView.__super__.constructor.apply(this,arguments)}return __extends(TransportView,_super),TransportView.prototype.el=".transport",TransportView.prototype.template=transportTemplate,TransportView.prototype.initialize=function(options){return null==options&&(options={}),this.app=options.app,_.bindAll(this,"_start","_stop","_tick","recalculate"),this.model=new TransportModel({bpm:80,step:64}),this._currentTime=this._currentTick=0,this._playing=this._recording=!1,this.render()},TransportView.prototype.events={"click [data-behavior]":"delegateAction"},TransportView.prototype.render=function(){return this.el.innerHTML=this.template()},TransportView.prototype.delegateAction=function(e){var behavior;return behavior=$(e.currentTarget).data("behavior"),this[behavior]?(e.preventDefault(),this[behavior].call(this,e)):void 0},TransportView.prototype.stop=function(){return this._stop(),this.$('[data-behavior="record"], [data-behavior="play"]').removeClass("active")},TransportView.prototype.play=function(){return this._playing?this._stop():this._start()},TransportView.prototype.record=function(){return this._playing||this._start(),this._recording=!this._recording,this.$('[data-behavior="record"]').toggleClass("active")},TransportView.prototype.restart=function(){return this.setTick(0)},TransportView.prototype.end=function(){},TransportView.prototype._start=function(){return this._playing=!0,this.clock=setInterval(this._tick,parseInt(this.model.get("interval"),10)),this.$('[data-behavior="play"]').addClass("active")},TransportView.prototype._stop=function(){return clearInterval(this.clock),this._recording=!1,this._playing=!1,this.$('[data-behavior="play"], [data-behavior="record"]').removeClass("active")},TransportView.prototype._tick=function(){return this.setTick(this._currentTick+1)},TransportView.prototype.getTick=function(){return this._currentTick},TransportView.prototype.getTime=function(humanReadable){var formatted,time;if(null==humanReadable&&(humanReadable=!1),humanReadable){for(time=(""+this._currentTime/1e3*100).split(".")[0],formatted="";time.length<8;)time="0"+time;for(time=time.split("");;)if(formatted+=time.splice(0,2).join(""),time.length>=2&&(formatted+=":"),!time.length)break;return formatted}return this._currentTime},TransportView.prototype.setTick=function(value){return this.trigger("tick",value),this._currentTick=value,this._currentTime=value*parseInt(this.model.get("interval"),10),this.app.display.model.set("left",this.getTime(!0))},TransportView.prototype.setTime=function(value){return this._currentTime=value,this._currentTick=value/this.model.get("interval"),this.app.display.model.set("left",this.getTime(!0))},TransportView.prototype.recalculate=function(model,changed){return changed.bpm&&this.model.set("interval",this.calculateInterval(changed.bpm)),this._stop(),this._start()},TransportView}(Backbone.View),module.exports=TransportView},{"../models/transport":11,"../templates/transport.tpl":17,backbone:31,jquery:33,underscore:34}],27:[function(require,module){(function(process){!function(){function only_once(fn){var called=!1;return function(){if(called)throw new Error("Callback was already called.");called=!0,fn.apply(root,arguments)}}var root,previous_async,async={};root=this,null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _each=function(arr,iterator){if(arr.forEach)return arr.forEach(iterator);for(var i=0;i<arr.length;i+=1)iterator(arr[i],i,arr)},_map=function(arr,iterator){if(arr.map)return arr.map(iterator);var results=[];return _each(arr,function(x,i,a){results.push(iterator(x,i,a))}),results},_reduce=function(arr,iterator,memo){return arr.reduce?arr.reduce(iterator,memo):(_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo)},_keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys};"undefined"!=typeof process&&process.nextTick?(async.nextTick=process.nextTick,async.setImmediate="undefined"!=typeof setImmediate?function(fn){setImmediate(fn)}:async.nextTick):"function"==typeof setImmediate?(async.nextTick=function(fn){setImmediate(fn)},async.setImmediate=async.nextTick):(async.nextTick=function(fn){setTimeout(fn,0)},async.setImmediate=async.nextTick),async.each=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length&&callback(null))}))})},async.forEach=async.each,async.eachSeries=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0,iterate=function(){iterator(arr[completed],function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length?callback(null):iterate())})};iterate()},async.forEachSeries=async.eachSeries,async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])},async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){if(callback=callback||function(){},!arr.length||0>=limit)return callback();var completed=0,started=0,running=0;!function replenish(){if(completed>=arr.length)return callback();for(;limit>running&&started<arr.length;)started+=1,running+=1,iterator(arr[started-1],function(err){err?(callback(err),callback=function(){}):(completed+=1,running-=1,completed>=arr.length?callback():replenish())})}()}},doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}},doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}},doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}},_asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v,callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.inject=async.reduce,async.foldl=async.reduce,async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)},async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v&&results.push(x),callback()})},function(){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter),async.filterSeries=doSeries(_filter),async.select=async.filter,async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v||results.push(x),callback()})},function(){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject),async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){result?(main_callback(x),main_callback=function(){}):callback()})},function(){main_callback()})};async.detect=doParallel(_detect),async.detectSeries=doSeries(_detect),async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v&&(main_callback(!0),main_callback=function(){}),callback()})},function(){main_callback(!1)})},async.any=async.some,async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v||(main_callback(!1),main_callback=function(){}),callback()})},function(){main_callback(!0)})},async.all=async.every,async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){if(err)return callback(err);var fn=function(left,right){var a=left.criteria,b=right.criteria;return b>a?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))})},async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length)return callback(null);var results={},listeners=[],addListener=function(fn){listeners.unshift(fn)},removeListener=function(fn){for(var i=0;i<listeners.length;i+=1)if(listeners[i]===fn)return void listeners.splice(i,1)},taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){_keys(results).length===keys.length&&(callback(null,results),callback=function(){})}),_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k],taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1&&(args=args[0]),err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]}),safeResults[k]=args,callback(err,safeResults),callback=function(){}}else results[k]=args,async.setImmediate(taskComplete)},requires=task.slice(0,Math.abs(task.length-1))||[],ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},!0)&&!results.hasOwnProperty(k)};if(ready())task[task.length-1](taskCallback,results);else{var listener=function(){ready()&&(removeListener(listener),task[task.length-1](taskCallback,results))};addListener(listener)}})},async.waterfall=function(tasks,callback){if(callback=callback||function(){},tasks.constructor!==Array){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}if(!tasks.length)return callback();var wrapIterator=function(iterator){return function(err){if(err)callback.apply(null,arguments),callback=function(){};else{var args=Array.prototype.slice.call(arguments,1),next=iterator.next();args.push(next?wrapIterator(next):callback),async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){if(callback=callback||function(){},tasks.constructor===Array)eachfn.map(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)},async.series=function(tasks,callback){if(callback=callback||function(){},tasks.constructor===Array)async.mapSeries(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()};return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn};return makeCallback(0)},async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]),cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){test()?iterator(function(err){return err?callback(err):void async.whilst(test,iterator,callback)}):callback()},async.doWhilst=function(iterator,test,callback){iterator(function(err){return err?callback(err):void(test()?async.doWhilst(iterator,test,callback):callback())})},async.until=function(test,iterator,callback){test()?callback():iterator(function(err){return err?callback(err):void async.until(test,iterator,callback)})},async.doUntil=function(iterator,test,callback){iterator(function(err){return err?callback(err):void(test()?callback():async.doUntil(iterator,test,callback))})},async.queue=function(worker,concurrency){function _insert(q,data,pos,callback){data.constructor!==Array&&(data=[data]),_each(data,function(task){var item={data:task,callback:"function"==typeof callback?callback:null};pos?q.tasks.unshift(item):q.tasks.push(item),q.saturated&&q.tasks.length===concurrency&&q.saturated(),async.setImmediate(q.process)})}void 0===concurrency&&(concurrency=1);var workers=0,q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,!1,callback)},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();q.empty&&0===q.tasks.length&&q.empty(),workers+=1;var next=function(){workers-=1,task.callback&&task.callback.apply(task,arguments),q.drain&&q.tasks.length+workers===0&&q.drain(),q.process()},cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers}};return q},async.cargo=function(worker,payload){var working=!1,tasks=[],cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){data.constructor!==Array&&(data=[data]),_each(data,function(task){tasks.push({data:task,callback:"function"==typeof callback?callback:null}),cargo.saturated&&tasks.length===payload&&cargo.saturated()}),async.setImmediate(cargo.process)},process:function process(){if(!working){if(0===tasks.length)return void(cargo.drain&&cargo.drain());var ts="number"==typeof payload?tasks.splice(0,payload):tasks.splice(0),ds=_map(ts,function(task){return task.data});cargo.empty&&cargo.empty(),working=!0,worker(ds,function(){working=!1;var args=arguments;_each(ts,function(data){data.callback&&data.callback.apply(null,args)}),process()})}},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(err?console.error&&console.error(err):console[name]&&_each(args,function(x){console[name](x)}))}]))}};async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments),callback=args.pop(),key=hasher.apply(null,args);key in memo?callback.apply(null,memo[key]):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;l>i;i++)q[i].apply(null,arguments)}])))};return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.map(counter,iterator,callback)},async.timesSeries=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.mapSeries(counter,iterator,callback)},async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0],nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};var _applyEach=function(eachfn,fns){var go=function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}return go};async.applyEach=doParallel(_applyEach),async.applyEachSeries=doSeries(_applyEach),async.forever=function(fn,callback){function next(err){if(err){if(callback)return callback(err);throw err}fn(next)}next()},"undefined"!=typeof define&&define.amd?define([],function(){return async}):"undefined"!=typeof module&&module.exports?module.exports=async:root.async=async}()}).call(this,require("/Users/josh/code/beetmachine/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/josh/code/beetmachine/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":32}],28:[function(require,module){module.exports=require("./src/ligaments")},{"./src/ligaments":29}],29:[function(require,module,exports){(function(){var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty,__slice=[].slice;!function(factory){return"function"==typeof define&&define.amd?define(["underscore"],factory):factory("undefined"!=typeof exports&&null!==exports&&"undefined"!=typeof module&&null!==module?require("underscore"):_)}(function(_){var Ligaments;return Ligaments=function(){function Ligaments(options){return null==options&&(options={}),this.cid=_.uniqueId("ligament"),this.ensureArguments.apply(this,arguments),this.view=options.view,this.model=options.model,this.readOnly=options.readOnly,this.bindings=options.bindings,this.blacklist=options.blacklist,this.whitelist=options.whitelist,this.createBindings(),options.inject!==!1&&this.bootstrapView(),!this.readOnly&&options.ingest&&this.model.set(this.parseModel(),{silent:!0}),this}return Ligaments.prototype.createBindings=function(){return _.bindAll(this,"ingest","inject"),this.view.listenTo(this.model,"change",this.inject),this.readOnly?void 0:(_.extend(this.view.events||(this.view.events={}),{"change *[name]:not([lg-bind])":this.ingest,"input *[name]:not([lg-bind])":this.ingest,"change *[lg-bind]":this.ingest,"input *[lg-bind]":this.ingest}),this.view.delegateEvents(this.view.events))},Ligaments.prototype.ensureArguments=function(){var args;return args=[].slice.call(arguments),args.length||args[0].view||args[0].model?void 0:console.warn("You must provide an instance of a Backbone View and Model")},Ligaments.prototype.ingest=function(e){var $input,data,path,value,_ref,_this;if(_this=this,!this.readOnly&&!(this.blacklist&&(_ref=!path,__indexOf.call(this.blacklist,_ref)>=0)||null!=this.whitelist&&__indexOf.call(this.whitelist,path)>=0)){if($input=$(this.target=e.currentTarget),path=$input.attr("lg-bind")||$input.attr("name"),path&&path.indexOf(!1)&&(path=path.replace(/\[\]/g,function(_this){return function(){return"["+_this.view.$("[name]").filter('[name="'+path+'"]').index($input)+"]"}}(this)),path=this.dotToBracketNotation(path,!0)),value=this.getVal($input,path),"inject"===$input.attr("lg-method"))return null;$input.is("select[multiple]")&&this.model.unset(path),(data={})[path]=value,data=this.expand(data),this.parse&&_.isFunction(this.model.parse)&&this.model.parse(data),null==value?this.model.unset(path):this.model.set(data)}return delete this.target},Ligaments.prototype.bootstrapView=function(){return this.inject(this.model,{bootstrapData:this.model.toJSON()})},Ligaments.prototype.inject=function(model,options){var $bound,$boundTarget,data,path,value,_ref;if(data=options.bootstrapData||model.changedAttributes(),this.lockBinding)return this;data=this.flatten(data),_.isFunction(this.view.beforeInject)&&this.view.beforeInject(model,data);for(path in data)if(__hasProp.call(data,path)&&(value=data[path],!(null!=this.blacklist&&(_ref=!path,__indexOf.call(this.blacklist,_ref)>=0)||null!=this.whitelist&&__indexOf.call(this.whitelist,path)>=0)&&($bound=this.getBound(path),$bound.length))){if("ingest"===$bound.attr("lg-method"))return null;$bound.is(":input")?$bound.is(":checkbox")||$bound.is(":radio")?($boundTarget=$bound.length>1?$bound.prop("checked",!1).filter('[value="'+value+'"]'):$bound,$boundTarget.prop("checked",function(){var lowerCaseString;return lowerCaseString=value.toString().toLowerCase(),value&&"off"!==lowerCaseString&&"false"!==lowerCaseString&&"no"!==lowerCaseString})):$bound.val($bound.is("select[multiple]")?this.model.get(path):value):$bound.is("img, svg")?$bound.attr("src",value):$bound.html(value)}},Ligaments.prototype.parseModel=function(){var $bound,flat;return $bound=this.view.$("[lg-bind], [name]"),flat={},$bound.each(function(_this){return function(idx,el){var $el,path,value;return $el=$(el),path=$el.attr("lg-bind")||$el.attr("name"),path=path.replace(/\[\]/g,function(){return"["+$bound.filter('[lg-bind="'+path+'"], [name="'+path+'"]').index($el)+"]"}),null!=(value=_this.getVal($el,path))?flat[path]=value:void 0}}(this)),this.expand(flat)},Ligaments.prototype.getBound=function(path){var eqNameSelector,nameAttribute,nameSelectors;return/[0-9]+/.test(path.split("").pop())&&(path=path.split("."),path.pop(),path=path.join(".")),nameAttribute=this.dotToBracketNotation(path),eqNameSelector=nameAttribute.replace(/(.*\[)([0-9]+)?(\].*)/g,'[name="$1$3"]:eq($2)'),nameSelectors='[lg-bind="'+path+'"], [name="'+path+'"] '+eqNameSelector+', [name="'+nameAttribute+'"]',this.view.$(nameSelectors).not(this.target)},Ligaments.prototype.getVal=function(input,path){var $input,args,castOptions,caster,value,_ref,_ref1;if(null==path&&(path="*"),$input=$(input),value=$input.is(":input")?!$input.is(":checkbox")&&!$input.is(":radio")||$input.prop("checked")?$input.val():void 0:$input.text(),null!=(null!=(_ref=this.bindings)&&null!=(_ref1=_ref[path])?_ref1.cast:void 0)){if(castOptions=this.bindings[path].cast,_.isFunction(this.bindings[path].cast)?(args=[],caster=castOptions):_.isArray(this.bindings[path].cast)&&(args=castOptions.slice(1),caster=castOptions[0]),!args||"function"!=typeof caster)throw new Error("options.bindings[path].cast is expected to be a function or function + arguments array ex: {cast: [parseInt, 10]}");args.unshift(value),value=caster.apply(this.model,args)||value}return value},Ligaments.prototype.matchToken=function(key,token){return"{n}"===token&&Number(key)%1===0,parseInt(token,10)%1===0&&key===parseInt(token,10),key===token},Ligaments.prototype.expand=function(flat){var child,out,parent,path,set,token,tokens,value,_i,_j,_len,_len1;for(flat.constructor!==Array&&(flat=[flat]),_i=0,_len=flat.length;_len>_i;_i++){set=flat[_i];for(path in set)if(__hasProp.call(set,path)){for(value=set[path],tokens=this.tokenize(path).reverse(),value=_.result(set,path),"{n}"!==tokens[0]&&isNaN(Number(tokens[0]))?(child={})[tokens[0]]=value:(child=[])[tokens[0]]=value,tokens.shift(),_j=0,_len1=tokens.length;_len1>_j;_j++)token=tokens[_j],isNaN(Number(token))?(parent={})[token]=child:(parent=[])[parseInt(token,10)]=child,child=parent;this.merge(out=out||(out={}),child)}}return out},Ligaments.prototype.flatten=function(data,separator,depthLimit){var curr,el,key,out,path,stack;for(null==separator&&(separator="."),null==depthLimit&&(depthLimit=!1),data=this.merge({},data),path="",stack=[],out={};_.keys(data).length>0;)_.isArray(data)&&data.length>0?(key=data.length-1,el=data.pop()):(key=_.keys(data)[0],el=data[key],delete data[key]),null==el||path.split(separator).length===depthLimit||"object"!=typeof el||el.nodeType||"object"==typeof el&&(el.constructor===Date||el.constructor===RegExp||el.constructor===Function)?out[path+key]=el:(_.keys(data).length>0&&stack.push([data,path]),data=el,path+=key+separator),0===_.keys(data).length&&stack.length>0&&(curr=stack.pop(),data=curr[0],path=curr[1]);return out},Ligaments.prototype.merge=function(){var key,object,objects,out,value,_i,_len;for(objects=1<=arguments.length?__slice.call(arguments,0):[],out=objects.shift(),_i=0,_len=objects.length;_len>_i;_i++){object=objects[_i];for(key in object)__hasProp.call(object,key)&&(value=object[key],out[key]=out[key]&&value&&(_.isObject(out[key])&&_.isObject(value)||out[key].constructor===Array)?this.merge(out[key],value):value)}return out},Ligaments.prototype.dotToBracketNotation=function(path,reverse){if(null==reverse&&(reverse=!1),!path)throw new TypeError("Not Enough Arguments");return reverse?path.replace(/\]/g,"").split("[").join("."):path.replace(/([\w]+)\.?/g,"[$1]").replace(/^\[(\w+)\]/,"$1")},Ligaments.prototype.tokenize=function(path){return-1===path.indexOf("[")?path.split("."):_.map(path.split("["),function(v){return v=v.replace(/\]/,""),""===v?"{n}":v})},Ligaments}(),"undefined"!=typeof window&&null!==window&&null!=window.Backbone?Backbone.Ligament=Backbone.Ligaments=Ligaments:"object"==typeof exports?module.exports=Ligaments:Ligaments})}).call(this)},{underscore:34}],30:[function(require,module,exports){!function(root,factory){"undefined"!=typeof exports?module.exports=factory(require("jquery"),require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define(["jquery","underscore","backbone"],factory):factory(root.$,root._,root.Backbone)}(this,function($,_,Backbone){"use strict";var nestedChanges,_delayedTriggers=[];return Backbone.NestedModel=Backbone.Model.extend({get:function(attrStrOrPath){var result,attrPath=Backbone.NestedModel.attrPath(attrStrOrPath);return Backbone.NestedModel.walkPath(this.attributes,attrPath,function(val,path){var attr=_.last(path);path.length===attrPath.length&&(result=val[attr])}),result},has:function(attr){var result=this.get(attr);return!(null===result||_.isUndefined(result))},set:function(key,value,opts){var attrPath,unsetObj,validated,newAttrs=Backbone.NestedModel.deepClone(this.attributes);if(_.isString(key)?attrPath=Backbone.NestedModel.attrPath(key):_.isArray(key)&&(attrPath=key),attrPath)opts=opts||{},this._setAttr(newAttrs,attrPath,value,opts);else{opts=value||{};var attrs=key;for(var _attrStr in attrs)attrs.hasOwnProperty(_attrStr)&&this._setAttr(newAttrs,Backbone.NestedModel.attrPath(_attrStr),opts.unset?void 0:attrs[_attrStr],opts)}return nestedChanges=Backbone.NestedModel.__super__.changedAttributes.call(this),opts.unset&&attrPath&&1===attrPath.length?(unsetObj={},unsetObj[key]=void 0,nestedChanges=_.omit(nestedChanges,_.keys(unsetObj)),validated=Backbone.NestedModel.__super__.set.call(this,unsetObj,opts)):(unsetObj=newAttrs,opts.unset&&attrPath?(opts=_.extend({},opts),delete opts.unset):opts.unset&&_.isObject(key)&&(unsetObj=key),nestedChanges=_.omit(nestedChanges,_.keys(unsetObj)),validated=Backbone.NestedModel.__super__.set.call(this,unsetObj,opts)),validated?(this._runDelayedTriggers(),this):(this.changed={},nestedChanges={},!1)},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){nestedChanges={},options=options||{};var attrs=_.clone(this.attributes);if(!options.silent&&this.validate&&!this.validate(attrs,options))return!1;var changed=this.changed={},model=this,setChanged=function(obj,prefix,options){_.each(obj,function(val,attr){var changedPath=prefix;_.isArray(obj)?changedPath+="["+attr+"]":prefix?changedPath+="."+attr:changedPath=attr,val=obj[attr],_.isObject(val)&&setChanged(val,changedPath,options),options.silent||model._delayedChange(changedPath,null,options),changed[changedPath]=null})};return setChanged(this.attributes,"",options),this.attributes={},options.silent||this._delayedTrigger("change"),this._runDelayedTriggers(),this},add:function(attrStr,value,opts){var current=this.get(attrStr);if(!_.isArray(current))throw new Error("current value is not an array");return this.set(attrStr+"["+current.length+"]",value,opts)},remove:function(attrStr,opts){opts=opts||{};var attrPath=Backbone.NestedModel.attrPath(attrStr),aryPath=_.initial(attrPath),val=this.get(aryPath),i=_.last(attrPath);if(!_.isArray(val))throw new Error("remove() must be called on a nested array");var trigger=!opts.silent&&val.length>=i+1,oldEl=val[i];if(val.splice(i,1),opts.silent=!0,this.set(aryPath,val,opts),trigger){attrStr=Backbone.NestedModel.createAttrStr(aryPath),this.trigger("remove:"+attrStr,this,oldEl);for(var aryCount=aryPath.length;aryCount>=1;aryCount--)attrStr=Backbone.NestedModel.createAttrStr(_.first(aryPath,aryCount)),this.trigger("change:"+attrStr,this,oldEl);this.trigger("change",this,oldEl)}return this},changedAttributes:function(diff){var backboneChanged=Backbone.NestedModel.__super__.changedAttributes.call(this,diff);return _.isObject(backboneChanged)?_.extend({},nestedChanges,backboneChanged):!1},toJSON:function(){return Backbone.NestedModel.deepClone(this.attributes)},_delayedTrigger:function(){_delayedTriggers.push(arguments)},_delayedChange:function(attrStr,newVal,options){this._delayedTrigger("change:"+attrStr,this,newVal,options),this.changed||(this.changed={}),this.changed[attrStr]=newVal},_runDelayedTriggers:function(){for(;_delayedTriggers.length>0;)this.trigger.apply(this,_delayedTriggers.shift())},_setAttr:function(newAttrs,attrPath,newValue,opts){opts=opts||{};var fullPathLength=attrPath.length,model=this;Backbone.NestedModel.walkPath(newAttrs,attrPath,function(val,path,next){var attr=_.last(path),attrStr=Backbone.NestedModel.createAttrStr(path),isNewValue=!_.isEqual(val[attr],newValue);if(path.length===fullPathLength){if(opts.unset){if(delete val[attr],_.isArray(val)){var parentPath=Backbone.NestedModel.createAttrStr(_.initial(attrPath));model._delayedTrigger("remove:"+parentPath,model,val[attr])}}else val[attr]=newValue;if(!opts.silent&&_.isObject(newValue)&&isNewValue){var visited=[],checkChanges=function(obj,prefix){if(!(_.indexOf(visited,obj)>-1)){visited.push(obj);var nestedAttr,nestedVal;for(var a in obj)obj.hasOwnProperty(a)&&(nestedAttr=prefix+"."+a,nestedVal=obj[a],_.isEqual(model.get(nestedAttr),nestedVal)||model._delayedChange(nestedAttr,nestedVal,opts),_.isObject(nestedVal)&&checkChanges(nestedVal,nestedAttr))}};checkChanges(newValue,attrStr)}}else val[attr]||(val[attr]=_.isNumber(next)?[]:{});opts.silent||(path.length>1&&isNewValue&&model._delayedChange(attrStr,val[attr],opts),_.isArray(val[attr])&&model._delayedTrigger("add:"+attrStr,model,val[attr]))})}},{attrPath:function(attrStrOrPath){var path;return _.isString(attrStrOrPath)?(path=""===attrStrOrPath?[""]:attrStrOrPath.match(/[^\.\[\]]+/g),path=_.map(path,function(val){return val.match(/^\d+$/)?parseInt(val,10):val})):path=attrStrOrPath,path},createAttrStr:function(attrPath){var attrStr=attrPath[0];return _.each(_.rest(attrPath),function(attr){attrStr+=_.isNumber(attr)?"["+attr+"]":"."+attr
}),attrStr},deepClone:function(obj){return $.extend(!0,{},obj)},walkPath:function(obj,attrPath,callback,scope){for(var childAttr,val=obj,i=0;i<attrPath.length&&(callback.call(scope||this,val,attrPath.slice(0,i+1),attrPath[i+1]),childAttr=attrPath[i],val=val[childAttr],val);i++);}}),Backbone})},{backbone:31,jquery:33,underscore:34}],31:[function(require,module,exports){!function(root,factory){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(_,$,exports){root.Backbone=factory(root,exports,_,$)});else if("undefined"!=typeof exports){var _=require("underscore");factory(root,exports,_)}else root.Backbone=factory(root,{},root._,root.jQuery||root.Zepto||root.ender||root.$)}(this,function(root,Backbone,_,$){{var previousBackbone=root.Backbone,array=[],slice=(array.push,array.slice);array.splice}Backbone.VERSION="1.1.2",Backbone.$=$,Backbone.noConflict=function(){return root.Backbone=previousBackbone,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);return events.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context)return this._events=void 0,this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;l>i;i++)if(name=names[i],events=this._events[name]){if(this._events[name]=retain=[],callback||context)for(j=0,k=events.length;k>j;j++)ev=events[j],(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context)&&retain.push(ev);retain.length||delete this._events[name]}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(events,args),allEvents&&triggerEvents(allEvents,arguments),this},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;callback||"object"!=typeof name||(callback=this),obj&&((listeningTo={})[obj._listenId]=obj);for(var id in listeningTo)obj=listeningTo[id],obj.off(name,callback,this),(remove||_.isEmpty(obj._events))&&delete this._listeningTo[id];return this}},eventSplitter=/\s+/,eventsApi=function(obj,action,name,rest){if(!name)return!0;if("object"==typeof name){for(var key in name)obj[action].apply(obj,[key,name[key]].concat(rest));return!1}if(eventSplitter.test(name)){for(var names=name.split(eventSplitter),i=0,l=names.length;l>i;i++)obj[action].apply(obj,[names[i]].concat(rest));return!1}return!0},triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args);return}},listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={}),id=obj._listenId||(obj._listenId=_.uniqueId("l"));return listeningTo[id]=obj,callback||"object"!=typeof name||(callback=this),obj[implementation](name,callback,this),this}}),Events.bind=Events.on,Events.unbind=Events.off,_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={}),this.cid=_.uniqueId("c"),this.attributes={},options.collection&&(this.collection=options.collection),options.parse&&(attrs=this.parse(attrs,options)||{}),attrs=_.defaults({},attrs,_.result(this,"defaults")),this.set(attrs,options),this.changed={},this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return null!=this.get(attr)},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(null==key)return this;if("object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options||(options={}),!this._validate(attrs,options))return!1;unset=options.unset,silent=options.silent,changes=[],changing=this._changing,this._changing=!0,changing||(this._previousAttributes=_.clone(this.attributes),this.changed={}),current=this.attributes,prev=this._previousAttributes,this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);for(attr in attrs)val=attrs[attr],_.isEqual(current[attr],val)||changes.push(attr),_.isEqual(prev[attr],val)?delete this.changed[attr]:this.changed[attr]=val,unset?delete current[attr]:current[attr]=val;if(!silent){changes.length&&(this._pending=options);for(var i=0,l=changes.length;l>i;i++)this.trigger("change:"+changes[i],this,current[changes[i]],options)}if(changing)return this;if(!silent)for(;this._pending;)options=this._pending,this._pending=!1,this.trigger("change",this,options);return this._pending=!1,this._changing=!1,this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:!0}))},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):_.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):!1;var val,changed=!1,old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff)_.isEqual(old[attr],val=diff[attr])||((changed||(changed={}))[attr]=val);return changed},previous:function(attr){return null!=attr&&this._previousAttributes?this._previousAttributes[attr]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){return model.set(model.parse(resp,options),options)?(success&&success(model,resp,options),void model.trigger("sync",model,resp,options)):!1},wrapError(this,options),this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(null==key||"object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options=_.extend({validate:!0},options),attrs&&!options.wait){if(!this.set(attrs,options))return!1}else if(!this._validate(attrs,options))return!1;attrs&&options.wait&&(this.attributes=_.extend({},attributes,attrs)),void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);return options.wait&&(serverAttrs=_.extend(attrs||{},serverAttrs)),_.isObject(serverAttrs)&&!model.set(serverAttrs,options)?!1:(success&&success(model,resp,options),void model.trigger("sync",model,resp,options))},wrapError(this,options),method=this.isNew()?"create":options.patch?"patch":"update","patch"===method&&(options.attrs=attrs),xhr=this.sync(method,this,options),attrs&&options.wait&&(this.attributes=attributes),xhr},destroy:function(options){options=options?_.clone(options):{};var model=this,success=options.success,destroy=function(){model.trigger("destroy",model,model.collection,options)};if(options.success=function(resp){(options.wait||model.isNew())&&destroy(),success&&success(model,resp,options),model.isNew()||model.trigger("sync",model,resp,options)},this.isNew())return options.success(),!1;wrapError(this,options);var xhr=this.sync("delete",this,options);return options.wait||destroy(),xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?base:base.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(resp){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(options){return this._validate({},_.extend(options||{},{validate:!0}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return!0;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;return error?(this.trigger("invalid",this,error,_.extend(options,{validationError:error})),!1):!0}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.attributes),_[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={}),options.model&&(this.model=options.model),void 0!==options.comparator&&(this.comparator=options.comparator),this._reset(),this.initialize.apply(this,arguments),models&&this.reset(models,_.extend({silent:!0},options))},setOptions={add:!0,remove:!0,merge:!0},addOptions={add:!0,remove:!1};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:!1},options,addOptions))},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models),options||(options={});var i,l,index,model;for(i=0,l=models.length;l>i;i++)model=models[i]=this.get(models[i]),model&&(delete this._byId[model.id],delete this._byId[model.cid],index=this.indexOf(model),this.models.splice(index,1),this.length--,options.silent||(options.index=index,model.trigger("remove",model,this,options)),this._removeReference(model,options));return singular?models[0]:models},set:function(models,options){options=_.defaults({},options,setOptions),options.parse&&(models=this.parse(models,options));var singular=!_.isArray(models);models=singular?models?[models]:[]:_.clone(models);var i,l,id,model,attrs,existing,sort,at=options.at,targetModel=this.model,sortable=this.comparator&&null==at&&options.sort!==!1,sortAttr=_.isString(this.comparator)?this.comparator:null,toAdd=[],toRemove=[],modelMap={},add=options.add,merge=options.merge,remove=options.remove,order=!sortable&&add&&remove?[]:!1;for(i=0,l=models.length;l>i;i++){if(attrs=models[i]||{},id=attrs instanceof Model?model=attrs:attrs[targetModel.prototype.idAttribute||"id"],existing=this.get(id))remove&&(modelMap[existing.cid]=!0),merge&&(attrs=attrs===model?model.attributes:attrs,options.parse&&(attrs=existing.parse(attrs,options)),existing.set(attrs,options),sortable&&!sort&&existing.hasChanged(sortAttr)&&(sort=!0)),models[i]=existing;else if(add){if(model=models[i]=this._prepareModel(attrs,options),!model)continue;toAdd.push(model),this._addReference(model,options)}model=existing||model,!order||!model.isNew()&&modelMap[model.id]||order.push(model),modelMap[model.id]=!0}if(remove){for(i=0,l=this.length;l>i;++i)modelMap[(model=this.models[i]).cid]||toRemove.push(model);toRemove.length&&this.remove(toRemove,options)}if(toAdd.length||order&&order.length)if(sortable&&(sort=!0),this.length+=toAdd.length,null!=at)for(i=0,l=toAdd.length;l>i;i++)this.models.splice(at+i,0,toAdd[i]);else{order&&(this.models.length=0);var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;l>i;i++)this.models.push(orderedModels[i])}if(sort&&this.sort({silent:!0}),!options.silent){for(i=0,l=toAdd.length;l>i;i++)(model=toAdd[i]).trigger("add",model,this,options);(sort||order&&order.length)&&this.trigger("sort",this,options)}return singular?models[0]:models},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;l>i;i++)this._removeReference(this.models[i],options);return options.previousModels=this.models,this._reset(),models=this.add(models,_.extend({silent:!0},options)),options.silent||this.trigger("reset",this,options),models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options),model},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);return this.remove(model,options),model},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){return null==obj?void 0:this._byId[obj]||this._byId[obj.id]||this._byId[obj.cid]},at:function(index){return this.models[index]},where:function(attrs,first){return _.isEmpty(attrs)?first?void 0:[]:this[first?"find":"filter"](function(model){for(var key in attrs)if(attrs[key]!==model.get(key))return!1;return!0})},findWhere:function(attrs){return this.where(attrs,!0)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return options||(options={}),_.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),options.silent||this.trigger("sort",this,options),this},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var success=options.success,collection=this;return options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options),success&&success(collection,resp,options),collection.trigger("sync",collection,resp,options)},wrapError(this,options),this.sync("read",this,options)},create:function(model,options){if(options=options?_.clone(options):{},!(model=this._prepareModel(model,options)))return!1;options.wait||this.add(model,options);var collection=this,success=options.success;return options.success=function(model,resp){options.wait&&collection.add(model,options),success&&success(model,resp,options)},model.save(null,options),model},parse:function(resp){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model)return attrs;options=options?_.clone(options):{},options.collection=this;var model=new this.model(attrs,options);return model.validationError?(this.trigger("invalid",this,model.validationError,options),!1):model},_addReference:function(model){this._byId[model.cid]=model,null!=model.id&&(this._byId[model.id]=model),model.collection||(model.collection=this),model.on("all",this._onModelEvent,this)},_removeReference:function(model){this===model.collection&&delete model.collection,model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){("add"!==event&&"remove"!==event||collection===this)&&("destroy"===event&&this.remove(model,options),model&&event==="change:"+model.idAttribute&&(delete this._byId[model.previous(model.idAttribute)],null!=model.id&&(this._byId[model.id]=model)),this.trigger.apply(this,arguments))}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.models),_[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy","indexBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view"),options||(options={}),_.extend(this,_.pick(options,viewOptions)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},delegateEventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(element,delegate){return this.$el&&this.undelegateEvents(),this.$el=element instanceof Backbone.$?element:Backbone.$(element),this.el=this.$el[0],delegate!==!1&&this.delegateEvents(),this},delegateEvents:function(events){if(!events&&!(events=_.result(this,"events")))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(_.isFunction(method)||(method=this[events[key]]),method){var match=key.match(delegateEventSplitter),eventName=match[1],selector=match[2];method=_.bind(method,this),eventName+=".delegateEvents"+this.cid,""===selector?this.$el.on(eventName,method):this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"),!1);else{var attrs=_.extend({},_.result(this,"attributes"));this.id&&(attrs.id=_.result(this,"id")),this.className&&(attrs["class"]=_.result(this,"className"));var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,!1)}}}),Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(options.url||(params.url=_.result(model,"url")||urlError()),null!=options.data||!model||"create"!==method&&"update"!==method&&"patch"!==method||(params.contentType="application/json",params.data=JSON.stringify(options.attrs||model.toJSON(options))),options.emulateJSON&&(params.contentType="application/x-www-form-urlencoded",params.data=params.data?{model:params.data}:{}),options.emulateHTTP&&("PUT"===type||"DELETE"===type||"PATCH"===type)){params.type="POST",options.emulateJSON&&(params.data._method=type);var beforeSend=options.beforeSend;options.beforeSend=function(xhr){return xhr.setRequestHeader("X-HTTP-Method-Override",type),beforeSend?beforeSend.apply(this,arguments):void 0}}"GET"===params.type||options.emulateJSON||(params.processData=!1),"PATCH"===params.type&&noXhrPatch&&(params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var xhr=options.xhr=Backbone.ajax(_.extend(params,options));return model.trigger("request",model,xhr,options),xhr};var noXhrPatch=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={}),options.routes&&(this.routes=options.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){_.isRegExp(route)||(route=this._routeToRegExp(route)),_.isFunction(name)&&(callback=name,name=""),callback||(callback=this[name]);var router=this;return Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);router.execute(callback,args),router.trigger.apply(router,["route:"+name].concat(args)),router.trigger("route",name,args),Backbone.history.trigger("route",router,name,args)}),this},execute:function(callback,args){callback&&callback.apply(this,args)},navigate:function(fragment,options){return Backbone.history.navigate(fragment,options),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var route,routes=_.keys(this.routes);null!=(route=routes.pop());)this.route(route,this.routes[route])}},_routeToRegExp:function(route){return route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/?]+)"}).replace(splatParam,"([^?]*?)"),new RegExp("^"+route+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){return i===params.length-1?param||null:param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,isExplorer=/msie [\w.]+/,trailingSlash=/\/$/,pathStripper=/#.*$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(null==fragment)if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=decodeURI(this.location.pathname+this.location.search);var root=this.root.replace(trailingSlash,"");fragment.indexOf(root)||(fragment=fragment.slice(root.length))}else fragment=this.getHash();return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=!0,this.options=_.extend({root:"/"},this.options,options),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment(),docMode=document.documentMode,oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||7>=docMode);if(this.root=("/"+this.root+"/").replace(rootStripper,"/"),oldIE&&this._wantsHashChange){var frame=Backbone.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=frame.hide().appendTo("body")[0].contentWindow,this.navigate(fragment)}this._hasPushState?Backbone.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!oldIE?Backbone.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=fragment;var loc=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&loc.hash&&(this.fragment=this.getHash().replace(routeStripper,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),History.started=!1},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(){var current=this.getFragment();return current===this.fragment&&this.iframe&&(current=this.getFragment(this.getHash(this.iframe))),current===this.fragment?!1:(this.iframe&&this.navigate(current),void this.loadUrl())},loadUrl:function(fragment){return fragment=this.fragment=this.getFragment(fragment),_.any(this.handlers,function(handler){return handler.route.test(fragment)?(handler.callback(fragment),!0):void 0})},navigate:function(fragment,options){if(!History.started)return!1;options&&options!==!0||(options={trigger:!!options});var url=this.root+(fragment=this.getFragment(fragment||""));if(fragment=fragment.replace(pathStripper,""),this.fragment!==fragment){if(this.fragment=fragment,""===fragment&&"/"!==url&&(url=url.slice(0,-1)),this._hasPushState)this.history[options.replace?"replaceState":"pushState"]({},document.title,url);else{if(!this._wantsHashChange)return this.location.assign(url);this._updateHash(this.location,fragment,options.replace),this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))&&(options.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,fragment,options.replace))}return options.trigger?this.loadUrl(fragment):void 0}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else location.hash="#"+fragment}}),Backbone.history=new History;var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&_.extend(child.prototype,protoProps),child.__super__=parent.prototype,child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(model,options){var error=options.error;options.error=function(resp){error&&error(model,resp,options),model.trigger("error",model,resp,options)}};return Backbone})},{underscore:34}],32:[function(require,module){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.once=noop,process.off=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")}},{}],33:[function(require,module){!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$1").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else data=void 0;return data}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(data_priv.hasData(src)&&(pdataOld=data_priv.access(src),pdataCur=data_priv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}data_user.hasData(src)&&(udataOld=data_user.access(src),udataCur=jQuery.extend({},udataOld),data_user.set(dest,udataCur))}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle?window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name]),computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret
}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=data_priv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),"none"===display&&(display=defaultDisplay(elem.nodeName)),"inline"===display&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=data_priv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,trim="".trim,support={},document=window.document,version="2.1.0",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){return obj-parseFloat(obj)>=0},isPlainObject:function(obj){if("object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":trim.call(text)},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results}var i,support,Expr,getText,isXML,compile,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>",div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")
}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&void 0!==match[4]?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},sibling:function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched}}),jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.unique(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(obj)},jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(owner){if(!Data.accepts(owner))return 0;var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock},Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock,jQuery.extend(owner,descriptor)}}return this.cache[unlock]||(this.cache[unlock]={}),unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if("string"==typeof data)cache[data]=value;else if(jQuery.isEmptyObject(cache))jQuery.extend(this.cache[unlock],data);else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return void 0===key?cache:cache[key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(void 0===key)this.cache[unlock]={};else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){owner[this.expando]&&delete this.cache[owner[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=data_user.get(elem),1===elem.nodeType&&!data_priv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));data_priv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){data_user.set(this,key)}):access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&void 0===value){if(data=data_user.get(elem,key),void 0!==data)return data;if(data=data_user.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data}else this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value),-1!==key.indexOf("-")&&void 0!==data&&data_user.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=data_priv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=data_priv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=data_priv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div"));div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var strundefined="undefined";support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle,!1)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));
origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,data_priv.remove(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!jQuery.acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!==this;cur=cur.parentNode||this)if(cur.disabled!==!0||"click"!==event.type){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;attaches?data_priv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),data_priv.remove(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},buildFragment:function(elems,context,scripts,selection){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment},cleanData:function(elems){for(var data,elem,events,type,key,j,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++){if(jQuery.acceptData(elem)&&(key=elem[data_priv.expando],key&&(data=data_priv.cache[key]))){if(events=Object.keys(data.events||{}),events.length)for(j=0;void 0!==(type=events[j]);j++)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);data_priv.cache[key]&&delete data_priv.cache[key]}delete data_user.cache[elem[data_user.expando]]}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)};!function(){function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal="1%"!==divStyle.top,boxSizingReliableVal="4px"===divStyle.width,docElem.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,divReset="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",container.appendChild(div),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return computePixelPositionAndBoxSizingReliable(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computePixelPositionAndBoxSizingReliable(),boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",docElem.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight),docElem.removeChild(container),div.innerHTML="",ret}})}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]="",style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||data_priv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]
})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed="string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=0===arguments.length||"string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):this.each(jQuery.isFunction(value)?function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}:function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||value===!1?"":data_priv.get(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return this.each(jQuery.isFunction(html)?function(i){jQuery(this).wrapInner(html.call(this,i))}:function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var key in xhrCallbacks)xhrCallbacks[key]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(delete xhrCallbacks[id],callback=xhr.onload=xhr.onerror=null,"abort"===type?xhr.abort():"error"===type?complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"string"==typeof xhr.responseText?{text:xhr.responseText}:void 0,xhr.getAllResponseHeaders()))}},xhr.onload=callback(),xhr.onerror=callback("error"),callback=xhrCallbacks[id]=callback("abort"),xhr.send(options.hasContent&&options.data||null)},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:!0,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?window.pageXOffset:val,top?val:window.pageYOffset):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery})},{}],34:[function(require,module,exports){(function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.6.0";var each=_.each=_.forEach=function(obj,iterator,context){if(null==obj)return obj;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,length=obj.length;length>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;return obj};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,predicate,context){var result;return any(obj,function(value,index,list){return predicate.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(predicate,context):(each(obj,function(value,index,list){predicate.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,function(value,index,list){return!predicate.call(context,value,index,list)},context)},_.every=_.all=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(predicate,context):(each(obj,function(value,index,list){return(result=result&&predicate.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(predicate,context):(each(obj,function(value,index,list){return result||(result=predicate.call(context,value,index,list))?breaker:void 0}),!!result)};_.contains=_.include=function(obj,target){return null==obj?!1:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);var result=-1/0,lastComputed=-1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>lastComputed&&(result=value,lastComputed=computed)}),result},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);var result=1/0,lastComputed=1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;lastComputed>computed&&(result=value,lastComputed=computed)}),result},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return null==value?_.identity:_.isFunction(value)?value:_.property(value)};_.sortBy=function(obj,iterator,context){return iterator=lookupIterator(iterator),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iterator,context){var result={};return iterator=lookupIterator(iterator),each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result}};_.groupBy=group(function(result,key,value){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){iterator=lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))
},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.partition=function(array,predicate){var pass=[],fail=[];return each(array,function(elem){(predicate(elem)?pass:fail).push(elem)}),[pass,fail]},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.contains(other,item)})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(length);length>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),context=args=null))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=new Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=new Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){return function(obj){if(obj===attrs)return!0;for(var key in attrs)if(attrs[key]!==obj[key])return!1;return!0}},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}]},{},[5]);