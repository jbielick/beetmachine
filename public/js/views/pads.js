(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define(["jquery","underscore","backbone","views/pad","collections/group","text!/js/templates/pads.ejs"],function($,_,Backbone,PadView,GroupCollection,PadsTemplate){var PadsView;return PadsView=function(_super){function PadsView(){return PadsView.__super__.constructor.apply(this,arguments)}return __extends(PadsView,_super),PadsView.prototype.el=".pads",PadsView.prototype.template=_.template(PadsTemplate),PadsView.prototype.colorMap={1:"#ADD5FF",2:"#FF8D8D",3:"#BBBBD4",4:"#EBECF2",5:"#FFE97F"},PadsView.prototype.initialize=function(options){return this.app=options.parent,this.groups=new GroupCollection({position:1},{view:this}),this.currentGroup=this.groups.at(0),this.createPads(),this.bootstrapGroupPads(this.currentGroup),this.render(),this.listenTo(this.groups,"reset",function(_this){return function(collection){return collection.each(function(model){return _this.bootstrapGroupPads(model)}),_this.render(1)}}(this)),this.listenTo(this.groups,"add",function(_this){return function(model){return _this.bootstrapGroupPads(model),_this.render(model.get("position"))}}(this))},PadsView.prototype.createPads=function(){var i,options,z,_results;for(this.pads=[],i=1,z=0,_results=[];128>=i;)options={name:"c"+(i-16*z),parent:this},this.pads.push(new PadView(options)),i%16===0&&z++,_results.push(i++);return _results},PadsView.prototype.bootstrapGroupPads=function(group){var pads,pos;return pos=group.get("position")-1||0,pads=this.pads.slice(16*pos,16*pos+16),_.each(pads,function(pad,i){return null!=group.sounds.at(i)?pad.bootstrapWithModel(group.sounds.at(i)):void 0})},PadsView.prototype.record=function(pad){var tick;return this.app.transport._recording&&pad.model?(tick=this.app.transport.getTick(),console.log("recordHit at %s",tick),this.app.transport.pattern||(this.app.transport.pattern={}),this.app.transport.pattern[tick]||(this.app.transport.pattern[tick]=[]),this.app.transport.pattern[tick].push(pad.model.get("pad"))):void 0},PadsView.prototype.toggleGroupSelectButtons=function(group){return $('[data-behavior="selectGroup"]').removeClass("active").filter('[data-meta="'+group+'"]').addClass("active")},PadsView.prototype.render=function(group){var active,zeroedIndex;return null==group&&(group=1),this.$(".pad-container").detach(),this.toggleGroupSelectButtons(group),zeroedIndex=group-1,active=this.groups.findWhere({position:group}),"undefined"===active&&(active=this.groups.create({position:group})),this.currentGroup=active,this.currentPads=this.pads.slice(16*zeroedIndex,16*zeroedIndex+16),this.app.display.model.set("right","Group "+group),this.$el.append(_.pluck(this.currentPads,"el"))},PadsView}(Backbone.View)})}).call(this);